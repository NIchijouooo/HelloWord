import{e,m as l,p as a,D as o,v as t,f as r,F as m,n as d,B as u,y as i,A as s,o as n,q as p,h as c,C as f}from"./element-plus.795748f2.js";import{f as b,Y as g,p as v,o as h,c as w,a as y,S as F,Q as V,u as _,J as x,K as P,P as k,a0 as A,U as B,L as C,M as N,af as j,as as q,at as U,H as R,X as M}from"./@vue.8518410d.js";import{s as S,_ as I,u as T,v as z}from"./index.c4bb92fc.js";import{t as O}from"./vue3-barcode.05e30e68.js";import{I as L}from"./@element-plus.102632fb.js";import"./@vueuse.c0256496.js";import"./dayjs.b9b14681.js";import"./axios.765908e4.js";import"./lodash-es.8ca9079f.js";import"./async-validator.ed4c92a2.js";import"./@ctrl.82a509e0.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.1c4ac15a.js";import"./vue-router.ae8a7199.js";import"./pinia.4a496763.js";import"./vue-demi.b3a9cad9.js";import"./screenfull.258ac312.js";import"./nprogress.aae2b787.js";var D=e=>S.request({url:"/network/mobile",method:"post",data:e}),H=e=>S.request({url:"/network/mobile",method:"put",data:e}),E=e=>S.request({url:"/network/mobile",method:"delete",data:e}),Z=e=>S.request({url:"/network/mobiles",method:"get",data:e});const $=e=>(q("data-v-4ac8168f"),e=e(),U(),e),K={class:"main-container"},J={class:"main"},Q={class:"title",style:{"justify-content":"space-between"}},W=A(" 添加 "),X=A(" 刷新 "),Y=A("编辑"),G=A("删除"),ee=$((()=>y("div",null,"无数据",-1))),le={class:"mobile-tips"},ae=A("注：移动网络配置完成后，必须重启网关，才能生效！"),oe={class:"dialog-content"},te=$((()=>y("div",{class:"form-title"},[y("div",{class:"tName"},"配置参数")],-1))),re=$((()=>y("div",{class:"form-title"},[y("div",{class:"tName"},"通信参数")],-1))),me=A("单位毫秒"),de=A("单位毫秒"),ue=A("单位秒"),ie=$((()=>y("div",{class:"form-title"},[y("div",{class:"tName"},"保活参数")],-1))),se=A("单位秒"),ne=A("单位次"),pe={class:"dialog-footer"},ce=A("取消"),fe=A("保存"),be={style:{display:"flex",width:"100%","justify-content":"center","text-align":"center"}};var ge=I({setup(q){const U=T(),S=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,I=/^(?=^.{3,255}$)(http(s)?:\/\/)?(www\.)?[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+(:\d+)*(\/\w+\.\w+)*$/,$=(e,l,a)=>{console.log("validateIP"),S.test(l)||I.test(l)?a():a(new Error("IP格式错误！"))},ge=(e,l,a)=>{isNaN(Number(l))?a(new Error("只能输入数字！")):a()},ve=b(null),he=g({moduleName:"",headerCellStyle:{background:z.primaryColor,color:z.fontWhiteColor,height:"54px"},cellStyle:{height:"48px"},tableMaxHeight:0,currentPage:1,pagesize:20,moduleTableData:[],showAddBtn:!0,mFlag:!1,mTitle:"添加移动网络",moduleForm:{name:"",model:"",flowAlarm:!1,flowAlarmValue:"",serialNumber:"",baudRate:"",dataBits:"",stopBits:"",parity:"",timeout:"",interval:"",polling:"",ipMaster:"",ipSlave:"",pollPeriod:"",offlineCnt:""},moduleRules:{name:[{required:!0,message:"模块名称不能为空",trigger:"blur"}],model:[{required:!0,message:"模块型号不能为空",trigger:"blur"}],serialNumber:[{required:!0,message:"串口号不能为空",trigger:"blur"}],baudRate:[{required:!0,message:"波特率不能为空",trigger:"blur"}],dataBits:[{required:!0,message:"数据位不能为空",trigger:"blur"}],stopBits:[{required:!0,message:"停止位不能为空",trigger:"blur"}],parity:[{required:!0,message:"校验位不能为空",trigger:"blur"}],flowAlarmValue:[{required:!0,message:"流量报警值不能为空",trigger:"blur"},{trigger:"blur",validator:ge}],timeout:[{required:!0,message:"超时时间不能为空",trigger:"blur"},{trigger:"blur",validator:ge}],interval:[{required:!0,message:"间隔时间不能为空",trigger:"blur"},{trigger:"blur",validator:ge}],polling:[{required:!0,message:"轮询时间不能为空",trigger:"blur"},{trigger:"blur",validator:ge}],ipMaster:[{required:!0,validator:$,trigger:"blur"}],ipSlave:[{validator:$,trigger:"blur"}],pollPeriod:[{required:!0,message:"保活检测周期不能为空",trigger:"blur"},{type:"number",message:"保活检测周期只能输入数字"}],offlineCnt:[{required:!0,message:"离线判断次数不能为空",trigger:"blur"},{type:"number",message:"离线判断次数只能输入数字"}]},baudRateOptions:[{value:"1200",label:"1200"},{value:"2400",label:"2400"},{value:"4800",label:"4800"},{value:"9600",label:"9600"},{value:"14400",label:"14400"},{value:"19200",label:"19200"},{value:"115200",label:"115200"}],dataBitsOptions:[{value:"5",label:"5"},{value:"6",label:"6"},{value:"7",label:"7"},{value:"8",label:"8"}],stopBitsOptions:[{value:"1",label:"1"},{value:"1.5",label:"1.5"},{value:"2",label:"2"}],parityOptions:[{value:"N",label:"无校验"},{value:"O",label:"奇校验"},{value:"E",label:"偶校验"}],sFlag:!1,barcodeVale:0}),we=e=>{const l={token:U.token,data:{}};Z(l).then((async l=>{console.log("getModuleList -> res",l),l&&("0"===l.code?(he.moduleTableData=l.data,he.showAddBtn=0===l.data.length,1===e&&c({type:"success",message:"刷新成功！"})):ke(l),await R((()=>{he.tableMaxHeight=ve.value.clientHeight-34-36-22})))}))};we();const ye=v((()=>he.moduleTableData.filter((e=>!he.moduleName||e.name.toLowerCase().includes(he.moduleName.toLowerCase()))).slice((he.currentPage-1)*he.pagesize,he.currentPage*he.pagesize)));v((()=>he.moduleTableData.filter((e=>!he.moduleName||e.name.toLowerCase().includes(he.moduleName.toLowerCase())))));const Fe=e=>{he.mFlag=!0,he.mTitle="编辑移动网络",he.moduleForm.name=e.name,he.moduleForm.model=e.model,he.moduleForm.flowAlarm=e.configParam.flowAlarm,he.moduleForm.flowAlarmValue=e.configParam.flowAlarmValue,he.moduleForm.serialNumber=e.commParam.name,he.moduleForm.baudRate=e.commParam.baudRate,he.moduleForm.dataBits=e.commParam.dataBits,he.moduleForm.stopBits=e.commParam.stopBits,he.moduleForm.parity=e.commParam.parity,he.moduleForm.timeout=e.commParam.timeout,he.moduleForm.interval=e.commParam.interval,he.moduleForm.polling=e.commParam.pollPeriod,he.moduleForm.ipMaster=e.keepAliveParam.ipMaster,he.moduleForm.ipSlave=e.keepAliveParam.ipSlave,he.moduleForm.pollPeriod=e.keepAliveParam.pollPeriod,he.moduleForm.offlineCnt=e.keepAliveParam.offlineCnt},Ve=b(null),_e=e=>{xe()},xe=()=>{he.mFlag=!1,Ve.value.resetFields(),Pe()},Pe=()=>{he.moduleForm={name:"",model:"",flowAlarm:!1,flowAlarmValue:"",serialNumber:"",baudRate:"",dataBits:"",stopBits:"",parity:"",timeout:"",interval:"",polling:"",ipMaster:"",ipSlave:"",pollPeriod:"",offlineCnt:""}},ke=e=>{c({type:"error",message:e.message})},Ae=(e,l)=>{c({type:"0"===e.code?"success":"error",message:e.message}),"0"===e.code&&l&&l()};return(b,g)=>{const v=e,q=l,R=M("Icon"),S=a,I=o,T=t,z=r,Z=m,$=d,ge=u,Pe=i,ke=s,Be=n,Ce=p;return h(),w("div",K,[y("div",J,[y("div",Q,[F(q,{style:{width:"200px"},placeholder:"请输入模块名称",clearable:"",modelValue:_(he).moduleName,"onUpdate:modelValue":g[0]||(g[0]=e=>_(he).moduleName=e)},{prefix:V((()=>[F(v,{class:"el-input__icon"},{default:V((()=>[F(_(L))])),_:1})])),_:1},8,["modelValue"]),y("div",null,[x(F(S,{type:"primary",bg:"",class:"right-btn",onClick:g[1]||(g[1]=e=>{he.mFlag=!0})},{default:V((()=>[F(v,{class:"btn-icon"},{default:V((()=>[F(R,{name:"local-add",size:"14px",color:"#ffffff"})])),_:1}),W])),_:1},512),[[P,_(he).showAddBtn]]),F(S,{style:{color:"#fff"},color:"#2EA554",class:"right-btn",onClick:g[2]||(g[2]=e=>{we(1)})},{default:V((()=>[F(v,{class:"btn-icon"},{default:V((()=>[F(R,{name:"local-refresh",size:"14px",color:"#ffffff"})])),_:1}),X])),_:1})])]),y("div",{class:"content",ref_key:"contentRef",ref:ve},[F(Z,{data:_(ye),"cell-style":_(he).cellStyle,"header-cell-style":_(he).headerCellStyle,"max-height":_(he).tableMaxHeight,style:{width:"100%"},stripe:"",onRowDblclick:Fe},{empty:V((()=>[ee])),default:V((()=>[F(I,{prop:"name",label:"模块名称",width:"auto","min-width":"120",align:"center"}),F(I,{prop:"model",label:"模块型号",width:"auto","min-width":"120",align:"center"}),F(I,{label:"sim卡号",width:"auto","min-width":"180",align:"center"},{default:V((e=>[""!==e.row.runParam.iccid?(h(),k(z,{key:0,class:"box-item",effect:"dark",content:"单击显示SIM卡条形码",placement:"top-start"},{default:V((()=>[F(T,{style:{cursor:"pointer"},onClick:l=>{return a=e.row.runParam.iccid,he.sFlag=!0,void(he.barcodeVale=a);var a}},{default:V((()=>[A(B(e.row.runParam.iccid),1)])),_:2},1032,["onClick"])])),_:2},1024)):C("",!0)])),_:1}),F(I,{label:"imei",width:"auto","min-width":"150",align:"center"},{default:V((e=>[A(B(e.row.runParam.imei),1)])),_:1}),F(I,{label:"信号强度",width:"auto","min-width":"80",align:"center"},{default:V((e=>[A(B(e.row.runParam.csq),1)])),_:1}),F(I,{label:"流量（KByte）",width:"auto","min-width":"150",align:"center"},{default:V((e=>[A(B(e.row.runParam.flow),1)])),_:1}),F(I,{label:"基站定位Lac",width:"auto","min-width":"110",align:"center"},{default:V((e=>[A(B(e.row.runParam.lac),1)])),_:1}),F(I,{label:"基站定位Ci",width:"auto","min-width":"100",align:"center"},{default:V((e=>[A(B(e.row.runParam.ci),1)])),_:1}),F(I,{label:"sim卡插入状态",width:"auto","min-width":"120",align:"center"},{default:V((e=>[F(T,{type:e.row.runParam.simInsert?"success":"danger"},{default:V((()=>[A(B(e.row.runParam.simInsert?"是":"否"),1)])),_:2},1032,["type"])])),_:1}),F(I,{label:"网络注册状态",width:"auto","min-width":"120",align:"center"},{default:V((e=>[F(T,{type:e.row.runParam.netRegister?"success":"danger"},{default:V((()=>[A(B(e.row.runParam.netRegister?"是":"否"),1)])),_:2},1032,["type"])])),_:1}),F(I,{label:"操作",width:"auto","min-width":"150",align:"center",fixed:"right"},{default:V((e=>[F(S,{onClick:l=>Fe(e.row),text:"",type:"primary"},{default:V((()=>[Y])),_:2},1032,["onClick"]),F(S,{onClick:l=>{return a=e.row,void f.confirm("确定要删除这个移动网络吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e={token:U.token,data:{name:a.name}};E(e).then((e=>{Ae(e,we)}))})).catch((()=>{c({type:"info",message:"取消删除"})}));var a},text:"",type:"danger"},{default:V((()=>[G])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","cell-style","header-cell-style","max-height"]),y("div",le,[F(T,{class:"ml-2",type:"danger"},{default:V((()=>[ae])),_:1})])],512)]),F(Ce,{modelValue:_(he).mFlag,"onUpdate:modelValue":g[21]||(g[21]=e=>_(he).mFlag=e),title:_(he).mTitle,width:"900px","before-close":_e,"close-on-click-modal":!1},{footer:V((()=>[y("span",pe,[F(S,{onClick:g[19]||(g[19]=e=>xe())},{default:V((()=>[ce])),_:1}),F(S,{type:"primary",onClick:g[20]||(g[20]=e=>{Ve.value.validate((e=>{const l={name:he.moduleForm.name,model:he.moduleForm.model,commParam:{},configParam:{}},a={name:he.moduleForm.serialNumber,baudRate:he.moduleForm.baudRate,dataBits:he.moduleForm.dataBits,stopBits:he.moduleForm.stopBits,parity:he.moduleForm.parity,timeout:he.moduleForm.timeout,interval:he.moduleForm.interval,pollPeriod:he.moduleForm.polling},o={flowAlarm:he.moduleForm.flowAlarm,flowAlarmValue:he.moduleForm.flowAlarmValue},t={ipMaster:he.moduleForm.ipMaster,ipSlave:he.moduleForm.ipSlave,pollPeriod:he.moduleForm.pollPeriod,offlineCnt:he.moduleForm.offlineCnt};if(l.commParam=a,l.configParam=o,l.keepAliveParam=t,!e)return!1;{const e={token:U.token,data:l};he.mTitle.includes("添加")?D(e).then((e=>{Ae(e,we),xe()})):H(e).then((e=>{Ae(e,we),xe()}))}}))})},{default:V((()=>[fe])),_:1})])])),default:V((()=>[y("div",oe,[F(Be,{model:_(he).moduleForm,rules:_(he).moduleRules,ref_key:"moduleFormRef",ref:Ve,"status-icon":"","label-position":"right","label-width":"120px",inline:"true"},{default:V((()=>[F($,{label:"模块名称",prop:"name"},{default:V((()=>[F(q,{disabled:_(he).mTitle.includes("编辑"),type:"text",style:{width:"270px"},modelValue:_(he).moduleForm.name,"onUpdate:modelValue":g[3]||(g[3]=e=>_(he).moduleForm.name=e),autocomplete:"off",placeholder:"请输入模块名称"},null,8,["disabled","modelValue"])])),_:1}),F($,{label:"模块型号",prop:"model"},{default:V((()=>[F(q,{type:"text",style:{width:"270px"},modelValue:_(he).moduleForm.model,"onUpdate:modelValue":g[4]||(g[4]=e=>_(he).moduleForm.model=e),autocomplete:"off",placeholder:"请输入模块型号"},null,8,["modelValue"])])),_:1}),te,F($,{label:"启用流量报警",prop:"flowAlarm"},{default:V((()=>[F(ge,{style:{width:"270px"},modelValue:_(he).moduleForm.flowAlarm,"onUpdate:modelValue":g[5]||(g[5]=e=>_(he).moduleForm.flowAlarm=e),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])])),_:1}),F($,{label:"流量报警值",prop:_(he).moduleForm.flowAlarm?"flowAlarmValue":""},{default:V((()=>[F(q,{disabled:!_(he).moduleForm.flowAlarm,type:"text",style:{width:"270px"},modelValue:_(he).moduleForm.flowAlarmValue,"onUpdate:modelValue":g[6]||(g[6]=e=>_(he).moduleForm.flowAlarmValue=e),autocomplete:"off",placeholder:"请输入流量报警值"},null,8,["disabled","modelValue"])])),_:1},8,["prop"]),re,F($,{label:"串口号",prop:"serialNumber"},{default:V((()=>[F(q,{type:"text",style:{width:"270px"},modelValue:_(he).moduleForm.serialNumber,"onUpdate:modelValue":g[7]||(g[7]=e=>_(he).moduleForm.serialNumber=e),autocomplete:"off",placeholder:"请输入串口名称"},null,8,["modelValue"])])),_:1}),F($,{label:"波特率",prop:"baudRate"},{default:V((()=>[F(ke,{modelValue:_(he).moduleForm.baudRate,"onUpdate:modelValue":g[8]||(g[8]=e=>_(he).moduleForm.baudRate=e),style:{width:"270px"},placeholder:"请选择波特率"},{default:V((()=>[(h(!0),w(N,null,j(_(he).baudRateOptions,(e=>(h(),k(Pe,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),F($,{label:"数据位",prop:"dataBits"},{default:V((()=>[F(ke,{modelValue:_(he).moduleForm.dataBits,"onUpdate:modelValue":g[9]||(g[9]=e=>_(he).moduleForm.dataBits=e),style:{width:"270px"},placeholder:"请选择数据位"},{default:V((()=>[(h(!0),w(N,null,j(_(he).dataBitsOptions,(e=>(h(),k(Pe,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),F($,{label:"停止位",prop:"stopBits"},{default:V((()=>[F(ke,{modelValue:_(he).moduleForm.stopBits,"onUpdate:modelValue":g[10]||(g[10]=e=>_(he).moduleForm.stopBits=e),style:{width:"270px"},placeholder:"请选择停止位"},{default:V((()=>[(h(!0),w(N,null,j(_(he).stopBitsOptions,(e=>(h(),k(Pe,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),F($,{label:"校验位",prop:"parity"},{default:V((()=>[F(ke,{modelValue:_(he).moduleForm.parity,"onUpdate:modelValue":g[11]||(g[11]=e=>_(he).moduleForm.parity=e),style:{width:"270px"},placeholder:"请选择校验位"},{default:V((()=>[(h(!0),w(N,null,j(_(he).parityOptions,(e=>(h(),k(Pe,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),F($,{label:"超时时间",prop:"timeout"},{default:V((()=>[F(q,{type:"text",style:{width:"270px"},modelValue:_(he).moduleForm.timeout,"onUpdate:modelValue":g[12]||(g[12]=e=>_(he).moduleForm.timeout=e),autocomplete:"off",placeholder:"请输入超时时间"},{append:V((()=>[me])),_:1},8,["modelValue"])])),_:1}),F($,{label:"间隔时间",prop:"interval"},{default:V((()=>[F(q,{type:"text",style:{width:"270px"},modelValue:_(he).moduleForm.interval,"onUpdate:modelValue":g[13]||(g[13]=e=>_(he).moduleForm.interval=e),autocomplete:"off",placeholder:"请输入间隔时间"},{append:V((()=>[de])),_:1},8,["modelValue"])])),_:1}),F($,{label:"轮询时间",prop:"polling"},{default:V((()=>[F(q,{type:"text",style:{width:"270px"},modelValue:_(he).moduleForm.polling,"onUpdate:modelValue":g[14]||(g[14]=e=>_(he).moduleForm.polling=e),autocomplete:"off",placeholder:"请输入轮询时间"},{append:V((()=>[ue])),_:1},8,["modelValue"])])),_:1}),ie,F($,{label:"保活检测主IP",prop:"ipMaster"},{default:V((()=>[F(q,{type:"text",style:{width:"270px"},modelValue:_(he).moduleForm.ipMaster,"onUpdate:modelValue":g[15]||(g[15]=e=>_(he).moduleForm.ipMaster=e),autocomplete:"off",placeholder:"请输入保活检测主IP"},null,8,["modelValue"])])),_:1}),F($,{label:"保活检测备用IP",prop:"ipSlave"},{default:V((()=>[F(q,{type:"text",style:{width:"270px"},modelValue:_(he).moduleForm.ipSlave,"onUpdate:modelValue":g[16]||(g[16]=e=>_(he).moduleForm.ipSlave=e),autocomplete:"off",placeholder:"请输入保活检测备用IP"},null,8,["modelValue"])])),_:1}),F($,{label:"保活检测周期",prop:"pollPeriod"},{default:V((()=>[F(q,{type:"text",style:{width:"270px"},modelValue:_(he).moduleForm.pollPeriod,"onUpdate:modelValue":g[17]||(g[17]=e=>_(he).moduleForm.pollPeriod=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入保活检测周期"},{append:V((()=>[se])),_:1},8,["modelValue"])])),_:1}),F($,{label:"离线判断次数",prop:"offlineCnt"},{default:V((()=>[F(q,{type:"text",style:{width:"270px"},modelValue:_(he).moduleForm.offlineCnt,"onUpdate:modelValue":g[18]||(g[18]=e=>_(he).moduleForm.offlineCnt=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入离线判断次数"},{append:V((()=>[ne])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["modelValue","title"]),F(Ce,{modelValue:_(he).sFlag,"onUpdate:modelValue":g[22]||(g[22]=e=>_(he).sFlag=e),title:"sim卡号条形码",width:"30%"},{default:V((()=>[y("div",be,[F(_(O),{value:_(he).barcodeVale,height:60},null,8,["value"])])])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-4ac8168f"]]);export{ge as default};
