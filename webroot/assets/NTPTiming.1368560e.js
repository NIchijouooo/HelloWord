import{K as e,n as a,v as l,w as t,m as o,p as r,o as s,u as d,F as u,G as p,g as n}from"./element-plus.3300f756.js";import{_ as m,u as i}from"./index.9b2cfea2.js";import{S as f}from"./sysTool.e93c084d.js";import{K as c,f as b,o as v,c as T,a as U,P as C,S as g,u as h,Q as _,ak as j,W as y,T as V,aw as w,ax as F}from"./@vue.73d14ebc.js";import"./lodash-es.98e49362.js";import"./async-validator.fb49d0f5.js";import"./@vueuse.3d90a471.js";import"./dayjs.2790329b.js";import"./axios.765908e4.js";import"./@ctrl.b082b0c1.js";import"./@popperjs.36402333.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./vue-router.43b9a342.js";import"./pinia.3f4aff4f.js";import"./vue-demi.b3a9cad9.js";import"./@element-plus.0bef5fa5.js";import"./screenfull.7cf96174.js";import"./vue-echarts.7828944a.js";import"./resize-detector.4e96b72b.js";import"./echarts.2b8dcc79.js";import"./zrender.54f191d6.js";import"./tslib.60310f1a.js";import"./nprogress.aae2b787.js";const k={class:"main-container"},x={class:"main",style:{"background-color":"inherit"}},M=(e=>(w("data-v-de6c8034"),e=e(),F(),e))((()=>U("div",{class:"card-header"},[U("span",null,"NTP校时")],-1))),S={class:"item"},Z={style:{"padding-right":"14px",height:"100%",overflow:"auto"}},z={class:"remark"};var P=m({__name:"NTPTiming",setup(m){const w=i(),F=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,P=/^(?=^.{3,255}$)(http(s)?:\/\/)?(www\.)?[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+(:\d+)*(\/\w+\.\w+)*$/,N=(e,a,l)=>{console.log("validateIP"),""!==a?F.test(a)||P.test(a)?l():l(new Error("格式错误！")):l()},A=c({showBtn:!1,timeZoneOptions:[{value:"UTC+8",label:"UTC+8"},{value:"UTC+7",label:"UTC+7"},{value:"UTC+6",label:"UTC+6"},{value:"UTC+5",label:"UTC+5"},{value:"UTC+4",label:"UTC+4"},{value:"UTC+3",label:"UTC+3"},{value:"UTC+2",label:"UTC+2"},{value:"UTC+1",label:"UTC+1"},{value:"UTC+0",label:"UTC+0"},{value:"UTC-1",label:"UTC-1"},{value:"UTC-2",label:"UTC-2"},{value:"UTC-3",label:"UTC-3"},{value:"UTC-4",label:"UTC-4"},{value:"UTC-5",label:"UTC-5"},{value:"UTC-6",label:"UTC-6"},{value:"UTC-7",label:"UTC-7"},{value:"UTC-8",label:"UTC-8"}],ntpForm:{enable:"",timeZone:"",urlMaster:"",portMaster:null,urlSlave:"",portSlave:null},ntpRules:{urlMaster:[{validator:N,trigger:"blur"}],portMaster:[{type:"number",message:"必须是数字",trigger:"blur"}],urlSlave:[{validator:N,trigger:"blur"}],portSlave:[{type:"number",message:"必须是数字",trigger:"blur"}]}}),B=()=>{const e={token:w.token,data:{},mock:!0};f.getNTPInfo(e).then((e=>{"0"===e.code?(A.ntpForm=e.data,n({type:"success",message:"获取NTP服务成功！"}),A.showBtn=!1):$(e)}))};B();const I=b(null),R=(e,a)=>{n({type:"0"===e.code?"success":"error",message:e.message}),"0"===e.code&&a&&a()},$=e=>{n({type:"error",message:e.message})};return(n,m)=>{const i=e,c=a,b=l,F=t,P=o,N=r,$=s,K=d,O=u,E=p;return v(),T("div",k,[U("div",x,[C(E,{gutter:20,style:{height:"100%"}},{default:g((()=>[C(O,{span:12},{default:g((()=>[C(K,{class:"box-card",shadow:"hover"},{header:g((()=>[M])),default:g((()=>[U("div",S,[C(K,{style:{height:"100%"}},{default:g((()=>[U("div",Z,[C($,{model:h(A).ntpForm,rules:h(A).ntpRules,ref_key:"ntpRef",ref:I,"status-icon":"","label-position":"right","label-width":"120px"},{default:g((()=>[C(c,{label:"启用状态"},{default:g((()=>[C(i,{modelValue:h(A).ntpForm.enable,"onUpdate:modelValue":m[0]||(m[0]=e=>h(A).ntpForm.enable=e),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])])),_:1}),C(c,{label:"时区"},{default:g((()=>[C(F,{modelValue:h(A).ntpForm.timeZone,"onUpdate:modelValue":m[1]||(m[1]=e=>h(A).ntpForm.timeZone=e),modelModifiers:{number:!0},style:{width:"100%"},placeholder:"请选时区"},{default:g((()=>[(v(!0),T(_,null,j(h(A).timeZoneOptions,(e=>(v(),V(b,{key:"type_"+e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),C(c,{label:"主服务器地址",prop:"urlMaster"},{default:g((()=>[C(P,{type:"text",modelValue:h(A).ntpForm.urlMaster,"onUpdate:modelValue":m[2]||(m[2]=e=>h(A).ntpForm.urlMaster=e),autocomplete:"off",placeholder:"请输入主服务器地址"},null,8,["modelValue"])])),_:1}),C(c,{label:"主服务器端口",prop:"portMaster"},{default:g((()=>[C(P,{type:"text",modelValue:h(A).ntpForm.portMaster,"onUpdate:modelValue":m[3]||(m[3]=e=>h(A).ntpForm.portMaster=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入主服务器端口"},null,8,["modelValue"])])),_:1}),C(c,{label:"次服务器地址",prop:"urlSlave"},{default:g((()=>[C(P,{type:"text",modelValue:h(A).ntpForm.urlSlave,"onUpdate:modelValue":m[4]||(m[4]=e=>h(A).ntpForm.urlSlave=e),autocomplete:"off",placeholder:"请输入次服务器地址"},null,8,["modelValue"])])),_:1}),C(c,{label:"次服务器端口",prop:"portSlave"},{default:g((()=>[C(P,{type:"text",modelValue:h(A).ntpForm.portSlave,"onUpdate:modelValue":m[5]||(m[5]=e=>h(A).ntpForm.portSlave=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入次服务器端口"},null,8,["modelValue"])])),_:1}),C(c,null,{default:g((()=>[C(N,{disabled:h(A).showBtn,type:"primary",onClick:m[6]||(m[6]=e=>{I.value.validate((e=>{if(!e)return!1;{A.showBtn=!0;const e={token:w.token,data:A.ntpForm,mock:!0};f.updateNTP(e).then((e=>{R(e,B)}))}}))})},{default:g((()=>[y("保存")])),_:1},8,["disabled"]),C(N,{type:"primary",onClick:m[7]||(m[7]=e=>(()=>{const e={token:w.token,data:{}};f.sendTimingCmd(e).then((e=>{R(e,B)}))})())},{default:g((()=>[y("立即校时")])),_:1})])),_:1})])),_:1},8,["model","rules"])])])),_:1}),U("div",z,[C(E,{gutter:16},{default:g((()=>[C(O,{span:3},{default:g((()=>[y("操作步骤:")])),_:1}),C(O,{span:21},{default:g((()=>[y("1、选择时区（默认是UTC+8时区）")])),_:1})])),_:1}),C(E,{gutter:16},{default:g((()=>[C(O,{offset:3,span:21},{default:g((()=>[y("2、输入主服务器地址、端口")])),_:1})])),_:1}),C(E,{gutter:16},{default:g((()=>[C(O,{offset:3,span:21},{default:g((()=>[y("3、输入次服务器地址、端口")])),_:1})])),_:1}),C(E,{gutter:16},{default:g((()=>[C(O,{offset:3,span:21},{default:g((()=>[y("4、保存配置，重启后生肖")])),_:1})])),_:1}),C(E,{gutter:16},{default:g((()=>[C(O,{offset:3,span:21},{default:g((()=>[y("5、立即校时，系统时间立即更新")])),_:1})])),_:1})])])])),_:1})])),_:1})])),_:1})])])}}},[["__scopeId","data-v-de6c8034"]]);export{P as default};
