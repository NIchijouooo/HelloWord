import{e,p as a,A as o,B as l,C as t,v as n,w as i,n as r,K as s,Q as c,y as d,m,o as f,q as g,g as u,L as p}from"./element-plus.64650d13.js";import{s as b,_ as h,u as w,v as y}from"./index.98f42e56.js";import{f as k,Y as F,X as v,o as _,c as E,a as x,S as j,Q as P,a0 as V,U as C,u as I,M as N,af as T,P as q,L as G,at as U,au as z,H as M}from"./@vue.5db09832.js";import"./@vueuse.af8df401.js";import"./dayjs.b9b14681.js";import"./axios.765908e4.js";import"./lodash-es.8ca9079f.js";import"./@element-plus.aa3ef65f.js";import"./async-validator.ed4c92a2.js";import"./@ctrl.82a509e0.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.1c4ac15a.js";import"./vue-router.d969f71f.js";import"./pinia.69c74452.js";import"./vue-demi.b3a9cad9.js";import"./screenfull.258ac312.js";import"./vue-echarts.8f00425b.js";import"./resize-detector.4e96b72b.js";import"./echarts.62a08783.js";import"./zrender.56caf4f2.js";import"./tslib.60310f1a.js";import"./nprogress.aae2b787.js";var H=e=>b.request({url:"/network/params",method:"get",data:e}),S=e=>b.request({url:"/network/param",method:"post",data:e}),D=e=>b.request({url:"/network/param",method:"put",data:e}),R=e=>b.request({url:"/network/param",method:"delete",data:e}),A=e=>b.request({url:"/network/names",method:"get",data:e});const B=e=>(U("data-v-760f2f1c"),e=e(),z(),e),L={class:"main-container"},Q={class:"main"},K={class:"tool-bar"},W=V(" 添加 "),X=V(" 刷新 "),Y=V("偏好设置"),$=V("删除"),J=B((()=>x("div",null,"无数据",-1))),O={class:"mobile-tips"},Z=V("注：网口设置配置完成后，必须重启网关，才能生效！"),ee={class:"dialog-content"},ae=V("自动获取"),oe=V("手动设置"),le={class:"dialog-footer"},te=V("取消"),ne=V("保存");var ie=h({setup(b){const h=w(),U=/^((25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))\.){3}(25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))$/,z=(e,a,o)=>{console.log("validateIP"),U.test(a)?o():o(new Error("格式错误！"))},B=k(null),ie=F({headerCellStyle:{background:y.primaryColor,color:y.fontWhiteColor,height:"54px"},cellStyle:{height:"48px"},tableMaxHeight:0,currentPage:1,pagesize:20,networkTableData:[],nFlag:!1,nTitle:"添加网卡",networkNames:[],configForm:{name:"",configEnable:!1,dhcpEnable:!1,configIP:"",configNetmask:"",configGateway:""},configRules:{name:[{required:!0,message:"网卡名称不能为空",trigger:"blur"}],configEnable:[{required:!0,message:"启用配置不能为空",trigger:"blur"}],dhcpEnable:[{required:!0,message:"获取方式不能为空",trigger:"blur"}],configIP:[{required:!0,message:"IP地址不能为空",trigger:"blur"},{validator:z,trigger:"blur"}],configNetmask:[{required:!0,message:"子网掩码不能为空",trigger:"blur"},{trigger:"blur",validator:z}],configGateway:[{trigger:"blur",validator:z}]}}),re=e=>{const a={token:h.token,data:{}};H(a).then((async a=>{console.log("getNetworkList -> res",a),a&&("0"===a.code?(ie.networkTableData=a.data,1===e&&u({type:"success",message:"刷新成功！"})):me(a),await M((()=>{ie.tableMaxHeight=B.value.clientHeight-34-36-22})))}))};re();(()=>{const e={token:h.token,data:{}};A(e).then((e=>{"0"===e.code?(ie.networkNames=e.data,console.log("ctxData.networkNames -> ",ie.networkNames)):me(e)}))})();const se=k(null),ce=()=>{ie.nFlag=!1,se.value.resetFields(),ie.configForm={name:"",configEnable:!1,dhcpEnable:!1,configIP:"",configNetmask:"",configGateway:""}},de=e=>{ce()},me=e=>{u({type:"error",message:e.message})},fe=(e,a)=>{u({type:"0"===e.code?"success":"error",message:e.message}),"0"===e.code&&a&&a()};return(b,w)=>{const y=v("Icon"),k=e,F=a,U=o,z=l,M=t,H=n,A=i,me=r,ge=s,ue=c,pe=d,be=m,he=f,we=g;return _(),E("div",L,[x("div",Q,[x("div",K,[j(F,{type:"primary",bg:"",class:"right-btn",onClick:w[0]||(w[0]=e=>(ie.nFlag=!0,void(ie.nTitle="添加网卡")))},{default:P((()=>[j(k,{class:"btn-icon"},{default:P((()=>[j(y,{name:"local-add",size:"14px",color:"#ffffff"})])),_:1}),W])),_:1}),j(F,{style:{color:"#fff","margin-right":"20px"},color:"#2EA554",class:"right-btn",onClick:w[1]||(w[1]=e=>{re(1)})},{default:P((()=>[j(k,{class:"btn-icon"},{default:P((()=>[j(y,{name:"local-refresh",size:"14px",color:"#ffffff"})])),_:1}),X])),_:1})]),x("div",{class:"content",ref_key:"contentRef",ref:B},[j(M,{data:I(ie).networkTableData,"cell-style":I(ie).cellStyle,"header-cell-style":I(ie).headerCellStyle,"max-height":I(ie).tableMaxHeight,style:{width:"100%"},stripe:""},{empty:P((()=>[J])),default:P((()=>[j(U,{prop:"name",label:"网卡名称",width:"auto","min-width":"180",align:"center"}),j(U,{label:"配置状态",width:"auto","min-width":"120",align:"center"},{default:P((e=>[j(z,{type:e.row.configParam.configEnable?"success":"warning"},{default:P((()=>[V(C(e.row.configParam.configEnable?"已配置":"未配置"),1)])),_:2},1032,["type"])])),_:1}),j(U,{prop:"mtu",label:"MTU",width:"auto","min-width":"150",align:"center"}),j(U,{prop:"mac",label:"MAC地址",width:"auto","min-width":"200",align:"center"}),j(U,{prop:"flags",label:"网卡标志",width:"auto","min-width":"200",align:"center"}),j(U,{prop:"ip",label:"网络地址",width:"auto","min-width":"150",align:"center"}),j(U,{prop:"netmask",label:"子网掩码",width:"auto","min-width":"150",align:"center"}),j(U,{prop:"gateway",label:"默认网关",width:"auto","min-width":"150",align:"center"}),j(U,{label:"操作",width:"auto","min-width":"250",align:"center",fixed:"right"},{default:P((e=>[j(F,{onClick:a=>{return o=e.row,ie.nFlag=!0,ie.nTitle="编辑网卡",void(ie.configForm={name:o.configParam.name,configEnable:o.configParam.configEnable,dhcpEnable:o.configParam.dhcpEnable,configIP:o.configParam.configIP,configNetmask:o.configParam.configNetmask,configGateway:o.configParam.configGateway});var o},text:"",type:"primary"},{default:P((()=>[Y])),_:2},1032,["onClick"]),j(F,{onClick:a=>{return o=e.row,void p.confirm("确定要删除这个网卡配置吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e={token:h.token,data:{name:o.name}};R(e).then((e=>{fe(e,re)}))})).catch((()=>{u({type:"info",message:"取消删除"})}));var o},text:"",type:"danger"},{default:P((()=>[$])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","cell-style","header-cell-style","max-height"]),x("div",O,[j(z,{class:"ml-2",type:"danger"},{default:P((()=>[Z])),_:1})])],512)]),j(we,{modelValue:I(ie).nFlag,"onUpdate:modelValue":w[10]||(w[10]=e=>I(ie).nFlag=e),title:I(ie).nTitle,width:"600px","before-close":de,"close-on-click-modal":!1},{footer:P((()=>[x("span",le,[j(F,{onClick:w[8]||(w[8]=e=>ce())},{default:P((()=>[te])),_:1}),j(F,{type:"primary",onClick:w[9]||(w[9]=e=>{se.value.validate((e=>{if(!e)return!1;{const e={token:h.token,data:ie.configForm};ie.nTitle.includes("添加")?S(e).then((e=>{fe(e,re),ce()})):D(e).then((e=>{fe(e,re),ce()}))}}))})},{default:P((()=>[ne])),_:1})])])),default:P((()=>[x("div",ee,[j(he,{model:I(ie).configForm,rules:I(ie).configRules,ref_key:"configFormRef",ref:se,"status-icon":"","label-position":"right","label-width":"100px"},{default:P((()=>[j(me,{label:"网卡名称",prop:"name"},{default:P((()=>[j(A,{disabled:I(ie).nTitle.includes("编辑"),modelValue:I(ie).configForm.name,"onUpdate:modelValue":w[2]||(w[2]=e=>I(ie).configForm.name=e),style:{width:"100%"},placeholder:"请选择网卡名称"},{default:P((()=>[(_(!0),E(N,null,T(I(ie).networkNames,((e,a)=>(_(),q(H,{key:"net_"+a,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue"])])),_:1}),j(me,{label:"启用配置",prop:"configEnable"},{default:P((()=>[j(ge,{modelValue:I(ie).configForm.configEnable,"onUpdate:modelValue":w[3]||(w[3]=e=>I(ie).configForm.configEnable=e)},null,8,["modelValue"])])),_:1}),I(ie).configForm.configEnable?(_(),q(me,{key:0,label:"获取方式",prop:"dhcpEnable"},{default:P((()=>[j(pe,{modelValue:I(ie).configForm.dhcpEnable,"onUpdate:modelValue":w[4]||(w[4]=e=>I(ie).configForm.dhcpEnable=e)},{default:P((()=>[j(ue,{label:!0},{default:P((()=>[ae])),_:1}),j(ue,{label:!1},{default:P((()=>[oe])),_:1})])),_:1},8,["modelValue"])])),_:1})):G("",!0),I(ie).configForm.configEnable?(_(),q(me,{key:1,label:"IP地址",prop:I(ie).configForm.dhcpEnable?"":"configIP"},{default:P((()=>[j(be,{disabled:I(ie).configForm.dhcpEnable,type:"text",modelValue:I(ie).configForm.configIP,"onUpdate:modelValue":w[5]||(w[5]=e=>I(ie).configForm.configIP=e),autocomplete:"off",placeholder:"请输入IP地址"},null,8,["disabled","modelValue"])])),_:1},8,["prop"])):G("",!0),I(ie).configForm.configEnable?(_(),q(me,{key:2,label:"子网掩码",prop:I(ie).configForm.dhcpEnable?"":"configNetmask"},{default:P((()=>[j(be,{disabled:I(ie).configForm.dhcpEnable,type:"text",modelValue:I(ie).configForm.configNetmask,"onUpdate:modelValue":w[6]||(w[6]=e=>I(ie).configForm.configNetmask=e),autocomplete:"off",placeholder:"请输入子网掩码"},null,8,["disabled","modelValue"])])),_:1},8,["prop"])):G("",!0),I(ie).configForm.configEnable?(_(),q(me,{key:3,label:"默认网关",prop:I(ie).configForm.dhcpEnable||""===I(ie).configForm.configGateway?"":"configGateway"},{default:P((()=>[j(be,{disabled:I(ie).configForm.dhcpEnable,type:"text",modelValue:I(ie).configForm.configGateway,"onUpdate:modelValue":w[7]||(w[7]=e=>I(ie).configForm.configGateway=e),autocomplete:"off",placeholder:"请输入默认网关"},null,8,["disabled","modelValue"])])),_:1},8,["prop"])):G("",!0)])),_:1},8,["model","rules"])])])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-760f2f1c"]]);export{ie as default};
