import{e,p as a,D as l,v as o,F as t,y as n,A as i,n as r,B as c,N as s,J as d,m,o as f,q as g,h as u,C as p}from"./element-plus.795748f2.js";import{s as b,_ as h,u as w,v as y}from"./index.3a6602e1.js";import{f as k,Y as F,o as v,c as _,a as E,S as x,Q as P,a0 as V,U as j,u as N,M as C,af as I,P as T,L as q,as as G,at as U,H as M,X as D}from"./@vue.8518410d.js";import"./@vueuse.c0256496.js";import"./dayjs.b9b14681.js";import"./axios.765908e4.js";import"./lodash-es.8ca9079f.js";import"./@element-plus.102632fb.js";import"./async-validator.ed4c92a2.js";import"./@ctrl.82a509e0.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.1c4ac15a.js";import"./vue-router.ae8a7199.js";import"./pinia.4a496763.js";import"./vue-demi.b3a9cad9.js";import"./screenfull.258ac312.js";import"./nprogress.aae2b787.js";var H=e=>b.request({url:"/network/params",method:"get",data:e}),S=e=>b.request({url:"/network/param",method:"post",data:e}),z=e=>b.request({url:"/network/param",method:"put",data:e}),R=e=>b.request({url:"/network/param",method:"delete",data:e}),A=e=>b.request({url:"/network/names",method:"get",data:e});const B=e=>(G("data-v-9b1a8e66"),e=e(),U(),e),L={class:"main-container"},J={class:"main"},Q={class:"title"},W=V(" 添加 "),X=V(" 刷新 "),Y=V("偏好设置"),$=V("删除"),K=B((()=>E("div",null,"无数据",-1))),O={class:"mobile-tips"},Z=V("注：网口设置配置完成后，必须重启网关，才能生效！"),ee={class:"dialog-content"},ae=V("自动获取"),le=V("手动设置"),oe={class:"dialog-footer"},te=V("取消"),ne=V("保存");var ie=h({setup(b){const h=w(),G=/^((25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))\.){3}(25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))$/,U=(e,a,l)=>{console.log("validateIP"),G.test(a)?l():l(new Error("格式错误！"))},B=k(null),ie=F({headerCellStyle:{background:y.primaryColor,color:y.fontWhiteColor,height:"54px"},cellStyle:{height:"48px"},tableMaxHeight:0,currentPage:1,pagesize:20,networkTableData:[],nFlag:!1,nTitle:"添加网卡",networkNames:[],configForm:{name:"",configEnable:!1,dhcpEnable:!1,configIP:"",configNetmask:"",configGateway:""},configRules:{name:[{required:!0,message:"网卡名称不能为空",trigger:"blur"}],configEnable:[{required:!0,message:"启用配置不能为空",trigger:"blur"}],dhcpEnable:[{required:!0,message:"获取方式不能为空",trigger:"blur"}],configIP:[{required:!0,message:"IP地址不能为空",trigger:"blur"},{validator:U,trigger:"blur"}],configNetmask:[{required:!0,message:"子网掩码不能为空",trigger:"blur"},{trigger:"blur",validator:U}],configGateway:[{trigger:"blur",validator:U}]}}),re=e=>{const a={token:h.token,data:{}};H(a).then((async a=>{console.log("getNetworkList -> res",a),a&&("0"===a.code?(ie.networkTableData=a.data,1===e&&u({type:"success",message:"刷新成功！"})):me(a),await M((()=>{ie.tableMaxHeight=B.value.clientHeight-34-36-22})))}))};re();(()=>{const e={token:h.token,data:{}};A(e).then((e=>{"0"===e.code?(ie.networkNames=e.data,console.log("ctxData.networkNames -> ",ie.networkNames)):me(e)}))})();const ce=k(null),se=()=>{ie.nFlag=!1,ce.value.resetFields(),ie.configForm={name:"",configEnable:!1,dhcpEnable:!1,configIP:"",configNetmask:"",configGateway:""}},de=e=>{se()},me=e=>{u({type:"error",message:e.message})},fe=(e,a)=>{u({type:"0"===e.code?"success":"error",message:e.message}),"0"===e.code&&a&&a()};return(b,w)=>{const y=D("Icon"),k=e,F=a,G=l,U=o,M=t,H=n,A=i,me=r,ge=c,ue=s,pe=d,be=m,he=f,we=g;return v(),_("div",L,[E("div",J,[E("div",Q,[x(F,{type:"primary",bg:"",class:"right-btn",onClick:w[0]||(w[0]=e=>(ie.nFlag=!0,void(ie.nTitle="添加网卡")))},{default:P((()=>[x(k,{class:"btn-icon"},{default:P((()=>[x(y,{name:"local-add",size:"14px",color:"#ffffff"})])),_:1}),W])),_:1}),x(F,{style:{color:"#fff"},color:"#2EA554",class:"right-btn",onClick:w[1]||(w[1]=e=>{re(1)})},{default:P((()=>[x(k,{class:"btn-icon"},{default:P((()=>[x(y,{name:"local-refresh",size:"14px",color:"#ffffff"})])),_:1}),X])),_:1})]),E("div",{class:"content",ref_key:"contentRef",ref:B},[x(M,{data:N(ie).networkTableData,"cell-style":N(ie).cellStyle,"header-cell-style":N(ie).headerCellStyle,"max-height":N(ie).tableMaxHeight,style:{width:"100%"},stripe:""},{empty:P((()=>[K])),default:P((()=>[x(G,{prop:"name",label:"网卡名称",width:"auto","min-width":"180",align:"center"}),x(G,{label:"配置状态",width:"auto","min-width":"120",align:"center"},{default:P((e=>[x(U,{type:e.row.configParam.configEnable?"success":"warning"},{default:P((()=>[V(j(e.row.configParam.configEnable?"已配置":"未配置"),1)])),_:2},1032,["type"])])),_:1}),x(G,{prop:"mtu",label:"MTU",width:"auto","min-width":"150",align:"center"}),x(G,{prop:"mac",label:"MAC地址",width:"auto","min-width":"200",align:"center"}),x(G,{prop:"flags",label:"网卡标志",width:"auto","min-width":"200",align:"center"}),x(G,{prop:"ip",label:"网络地址",width:"auto","min-width":"150",align:"center"}),x(G,{prop:"netmask",label:"子网掩码",width:"auto","min-width":"150",align:"center"}),x(G,{prop:"gateway",label:"默认网关",width:"auto","min-width":"150",align:"center"}),x(G,{label:"操作",width:"auto","min-width":"250",align:"center",fixed:"right"},{default:P((e=>[x(F,{onClick:a=>{return l=e.row,ie.nFlag=!0,ie.nTitle="编辑网卡",void(ie.configForm={name:l.configParam.name,configEnable:l.configParam.configEnable,dhcpEnable:l.configParam.dhcpEnable,configIP:l.configParam.configIP,configNetmask:l.configParam.configNetmask,configGateway:l.configParam.configGateway});var l},text:"",type:"primary"},{default:P((()=>[Y])),_:2},1032,["onClick"]),x(F,{onClick:a=>{return l=e.row,void p.confirm("确定要删除这个网卡配置吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e={token:h.token,data:{name:l.name}};R(e).then((e=>{fe(e,re)}))})).catch((()=>{u({type:"info",message:"取消删除"})}));var l},text:"",type:"danger"},{default:P((()=>[$])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","cell-style","header-cell-style","max-height"]),E("div",O,[x(U,{class:"ml-2",type:"danger"},{default:P((()=>[Z])),_:1})])],512)]),x(we,{modelValue:N(ie).nFlag,"onUpdate:modelValue":w[10]||(w[10]=e=>N(ie).nFlag=e),title:N(ie).nTitle,width:"600px","before-close":de,"close-on-click-modal":!1},{footer:P((()=>[E("span",oe,[x(F,{onClick:w[8]||(w[8]=e=>se())},{default:P((()=>[te])),_:1}),x(F,{type:"primary",onClick:w[9]||(w[9]=e=>{ce.value.validate((e=>{if(!e)return!1;{const e={token:h.token,data:ie.configForm};ie.nTitle.includes("添加")?S(e).then((e=>{fe(e,re),se()})):z(e).then((e=>{fe(e,re),se()}))}}))})},{default:P((()=>[ne])),_:1})])])),default:P((()=>[E("div",ee,[x(he,{model:N(ie).configForm,rules:N(ie).configRules,ref_key:"configFormRef",ref:ce,"status-icon":"","label-position":"right","label-width":"100px"},{default:P((()=>[x(me,{label:"网卡名称",prop:"name"},{default:P((()=>[x(A,{disabled:N(ie).nTitle.includes("编辑"),modelValue:N(ie).configForm.name,"onUpdate:modelValue":w[2]||(w[2]=e=>N(ie).configForm.name=e),style:{width:"100%"},placeholder:"请选择网卡名称"},{default:P((()=>[(v(!0),_(C,null,I(N(ie).networkNames,((e,a)=>(v(),T(H,{key:"net_"+a,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue"])])),_:1}),x(me,{label:"启用配置",prop:"configEnable"},{default:P((()=>[x(ge,{modelValue:N(ie).configForm.configEnable,"onUpdate:modelValue":w[3]||(w[3]=e=>N(ie).configForm.configEnable=e)},null,8,["modelValue"])])),_:1}),N(ie).configForm.configEnable?(v(),T(me,{key:0,label:"获取方式",prop:"dhcpEnable"},{default:P((()=>[x(pe,{modelValue:N(ie).configForm.dhcpEnable,"onUpdate:modelValue":w[4]||(w[4]=e=>N(ie).configForm.dhcpEnable=e)},{default:P((()=>[x(ue,{label:!0},{default:P((()=>[ae])),_:1}),x(ue,{label:!1},{default:P((()=>[le])),_:1})])),_:1},8,["modelValue"])])),_:1})):q("",!0),N(ie).configForm.configEnable?(v(),T(me,{key:1,label:"IP地址",prop:N(ie).configForm.dhcpEnable?"":"configIP"},{default:P((()=>[x(be,{disabled:N(ie).configForm.dhcpEnable,type:"text",modelValue:N(ie).configForm.configIP,"onUpdate:modelValue":w[5]||(w[5]=e=>N(ie).configForm.configIP=e),autocomplete:"off",placeholder:"请输入IP地址"},null,8,["disabled","modelValue"])])),_:1},8,["prop"])):q("",!0),N(ie).configForm.configEnable?(v(),T(me,{key:2,label:"子网掩码",prop:N(ie).configForm.dhcpEnable?"":"configNetmask"},{default:P((()=>[x(be,{disabled:N(ie).configForm.dhcpEnable,type:"text",modelValue:N(ie).configForm.configNetmask,"onUpdate:modelValue":w[6]||(w[6]=e=>N(ie).configForm.configNetmask=e),autocomplete:"off",placeholder:"请输入子网掩码"},null,8,["disabled","modelValue"])])),_:1},8,["prop"])):q("",!0),N(ie).configForm.configEnable?(v(),T(me,{key:3,label:"默认网关",prop:N(ie).configForm.dhcpEnable||""===N(ie).configForm.configGateway?"":"configGateway"},{default:P((()=>[x(be,{disabled:N(ie).configForm.dhcpEnable,type:"text",modelValue:N(ie).configForm.configGateway,"onUpdate:modelValue":w[7]||(w[7]=e=>N(ie).configForm.configGateway=e),autocomplete:"off",placeholder:"请输入默认网关"},null,8,["disabled","modelValue"])])),_:1},8,["prop"])):q("",!0)])),_:1},8,["model","rules"])])])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-9b1a8e66"]]);export{ie as default};
