import{e,p as a,A as o,B as l,C as t,v as n,w as r,n as i,K as s,Q as c,y as d,m,o as f,q as g,g as p,L as u}from"./element-plus.3300f756.js";import{s as b,_ as h,u as w,v as y}from"./index.9b2cfea2.js";import{f as k,K as F,af as v,o as _,c as E,a as j,P as x,S as P,u as V,n as N,W as C,X as I,Q as T,ak as q,T as G,Y as U,aw as z,ax as M}from"./@vue.73d14ebc.js";import"./lodash-es.98e49362.js";import"./async-validator.fb49d0f5.js";import"./@vueuse.3d90a471.js";import"./dayjs.2790329b.js";import"./axios.765908e4.js";import"./@ctrl.b082b0c1.js";import"./@popperjs.36402333.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./vue-router.43b9a342.js";import"./pinia.3f4aff4f.js";import"./vue-demi.b3a9cad9.js";import"./@element-plus.0bef5fa5.js";import"./screenfull.7cf96174.js";import"./vue-echarts.7828944a.js";import"./resize-detector.4e96b72b.js";import"./echarts.2b8dcc79.js";import"./zrender.54f191d6.js";import"./tslib.60310f1a.js";import"./nprogress.aae2b787.js";var S=e=>b.request({url:"/network/params",method:"get",data:e}),D=e=>b.request({url:"/network/param",method:"post",data:e}),H=e=>b.request({url:"/network/param",method:"put",data:e}),R=e=>b.request({url:"/network/param",method:"delete",data:e}),A=e=>b.request({url:"/network/names",method:"get",data:e});const B={class:"main-container"},K={class:"main"},L={class:"tool-bar"},Q=(e=>(z("data-v-41f3ca6d"),e=e(),M(),e))((()=>j("div",null,"无数据",-1))),W={class:"mobile-tips"},X={class:"dialog-content"},Y={class:"dialog-footer"};var $=h({__name:"Network",setup(b){const h=w(),z=/^((25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))\.){3}(25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))$/,M=(e,a,o)=>{console.log("validateIP"),z.test(a)?o():o(new Error("格式错误！"))},$=k(null),J=F({headerCellStyle:{background:y.primaryColor,color:y.fontWhiteColor,height:"54px"},cellStyle:{height:"48px"},tableMaxHeight:0,currentPage:1,pagesize:20,networkTableData:[],nFlag:!1,nTitle:"添加网卡",networkNames:[],configForm:{name:"",configEnable:!1,dhcpEnable:!1,configIP:"",configNetmask:"",configGateway:""},configRules:{name:[{required:!0,message:"网卡名称不能为空",trigger:"blur"}],configEnable:[{required:!0,message:"启用配置不能为空",trigger:"blur"}],dhcpEnable:[{required:!0,message:"获取方式不能为空",trigger:"blur"}],configIP:[{required:!0,message:"IP地址不能为空",trigger:"blur"},{validator:M,trigger:"blur"}],configNetmask:[{required:!0,message:"子网掩码不能为空",trigger:"blur"},{trigger:"blur",validator:M}],configGateway:[{trigger:"blur",validator:M}]}}),O=e=>{const a={token:h.token,data:{}};S(a).then((async a=>{console.log("getNetworkList -> res",a),a&&("0"===a.code?(J.networkTableData=a.data,1===e&&p({type:"success",message:"刷新成功！"})):oe(a),await N((()=>{J.tableMaxHeight=$.value.clientHeight-34-36-22})))}))};O();(()=>{const e={token:h.token,data:{}};A(e).then((e=>{"0"===e.code?(J.networkNames=e.data,console.log("ctxData.networkNames -> ",J.networkNames)):oe(e)}))})();const Z=k(null),ee=()=>{J.nFlag=!1,Z.value.resetFields(),J.configForm={name:"",configEnable:!1,dhcpEnable:!1,configIP:"",configNetmask:"",configGateway:""}},ae=e=>{ee()},oe=e=>{p({type:"error",message:e.message})},le=(e,a)=>{p({type:"0"===e.code?"success":"error",message:e.message}),"0"===e.code&&a&&a()};return(b,w)=>{const y=v("Icon"),k=e,F=a,N=o,z=l,M=t,S=n,A=r,oe=i,te=s,ne=c,re=d,ie=m,se=f,ce=g;return _(),E("div",B,[j("div",K,[j("div",L,[x(F,{type:"primary",bg:"",class:"right-btn",onClick:w[0]||(w[0]=e=>(J.nFlag=!0,void(J.nTitle="添加网卡")))},{default:P((()=>[x(k,{class:"btn-icon"},{default:P((()=>[x(y,{name:"local-add",size:"14px",color:"#ffffff"})])),_:1}),C(" 添加 ")])),_:1}),x(F,{style:{color:"#fff","margin-right":"20px"},color:"#2EA554",class:"right-btn",onClick:w[1]||(w[1]=e=>{O(1)})},{default:P((()=>[x(k,{class:"btn-icon"},{default:P((()=>[x(y,{name:"local-refresh",size:"14px",color:"#ffffff"})])),_:1}),C(" 刷新 ")])),_:1})]),j("div",{class:"content",ref_key:"contentRef",ref:$},[x(M,{data:V(J).networkTableData,"cell-style":V(J).cellStyle,"header-cell-style":V(J).headerCellStyle,"max-height":V(J).tableMaxHeight,style:{width:"100%"},stripe:""},{empty:P((()=>[Q])),default:P((()=>[x(N,{sortable:"",prop:"name",label:"网卡名称",width:"auto","min-width":"180",align:"center"}),x(N,{sortable:"",label:"配置状态",width:"auto","min-width":"120",align:"center"},{default:P((e=>[x(z,{type:e.row.configParam.configEnable?"success":"warning"},{default:P((()=>[C(I(e.row.configParam.configEnable?"已配置":"未配置"),1)])),_:2},1032,["type"])])),_:1}),x(N,{sortable:"",prop:"mtu",label:"MTU",width:"auto","min-width":"150",align:"center"}),x(N,{sortable:"",prop:"mac",label:"MAC地址",width:"auto","min-width":"200",align:"center"}),x(N,{sortable:"",prop:"flags",label:"网卡标志",width:"auto","min-width":"200",align:"center"}),x(N,{sortable:"",prop:"ip",label:"网络地址",width:"auto","min-width":"150",align:"center"}),x(N,{sortable:"",prop:"netmask",label:"子网掩码",width:"auto","min-width":"150",align:"center"}),x(N,{sortable:"",prop:"gateway",label:"默认网关",width:"auto","min-width":"150",align:"center"}),x(N,{label:"操作",width:"auto","min-width":"250",align:"center",fixed:"right"},{default:P((e=>[x(F,{onClick:a=>{return o=e.row,J.nFlag=!0,J.nTitle="编辑网卡",void(J.configForm={name:o.configParam.name,configEnable:o.configParam.configEnable,dhcpEnable:o.configParam.dhcpEnable,configIP:o.configParam.configIP,configNetmask:o.configParam.configNetmask,configGateway:o.configParam.configGateway});var o},text:"",type:"primary"},{default:P((()=>[C("偏好设置")])),_:2},1032,["onClick"]),x(F,{onClick:a=>{return o=e.row,void u.confirm("确定要删除这个网卡配置吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e={token:h.token,data:{name:o.name}};R(e).then((e=>{le(e,O)}))})).catch((()=>{p({type:"info",message:"取消删除"})}));var o},text:"",type:"danger"},{default:P((()=>[C("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","cell-style","header-cell-style","max-height"]),j("div",W,[x(z,{class:"ml-2",type:"danger"},{default:P((()=>[C("注：网口设置配置完成后，必须重启网关，才能生效！")])),_:1})])],512)]),x(ce,{modelValue:V(J).nFlag,"onUpdate:modelValue":w[10]||(w[10]=e=>V(J).nFlag=e),title:V(J).nTitle,width:"600px","before-close":ae,"close-on-click-modal":!1},{footer:P((()=>[j("span",Y,[x(F,{onClick:w[8]||(w[8]=e=>ee())},{default:P((()=>[C("取消")])),_:1}),x(F,{type:"primary",onClick:w[9]||(w[9]=e=>{Z.value.validate((e=>{if(!e)return!1;{const e={token:h.token,data:J.configForm};J.nTitle.includes("添加")?D(e).then((e=>{le(e,O),ee()})):H(e).then((e=>{le(e,O),ee()}))}}))})},{default:P((()=>[C("保存")])),_:1})])])),default:P((()=>[j("div",X,[x(se,{model:V(J).configForm,rules:V(J).configRules,ref_key:"configFormRef",ref:Z,"status-icon":"","label-position":"right","label-width":"100px"},{default:P((()=>[x(oe,{label:"网卡名称",prop:"name"},{default:P((()=>[x(A,{disabled:V(J).nTitle.includes("编辑"),modelValue:V(J).configForm.name,"onUpdate:modelValue":w[2]||(w[2]=e=>V(J).configForm.name=e),style:{width:"100%"},placeholder:"请选择网卡名称"},{default:P((()=>[(_(!0),E(T,null,q(V(J).networkNames,((e,a)=>(_(),G(S,{key:"net_"+a,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue"])])),_:1}),x(oe,{label:"启用配置",prop:"configEnable"},{default:P((()=>[x(te,{modelValue:V(J).configForm.configEnable,"onUpdate:modelValue":w[3]||(w[3]=e=>V(J).configForm.configEnable=e)},null,8,["modelValue"])])),_:1}),V(J).configForm.configEnable?(_(),G(oe,{key:0,label:"获取方式",prop:"dhcpEnable"},{default:P((()=>[x(re,{modelValue:V(J).configForm.dhcpEnable,"onUpdate:modelValue":w[4]||(w[4]=e=>V(J).configForm.dhcpEnable=e)},{default:P((()=>[x(ne,{label:!0},{default:P((()=>[C("自动获取")])),_:1}),x(ne,{label:!1},{default:P((()=>[C("手动设置")])),_:1})])),_:1},8,["modelValue"])])),_:1})):U("",!0),V(J).configForm.configEnable?(_(),G(oe,{key:1,label:"IP地址",prop:V(J).configForm.dhcpEnable?"":"configIP"},{default:P((()=>[x(ie,{disabled:V(J).configForm.dhcpEnable,type:"text",modelValue:V(J).configForm.configIP,"onUpdate:modelValue":w[5]||(w[5]=e=>V(J).configForm.configIP=e),autocomplete:"off",placeholder:"请输入IP地址"},null,8,["disabled","modelValue"])])),_:1},8,["prop"])):U("",!0),V(J).configForm.configEnable?(_(),G(oe,{key:2,label:"子网掩码",prop:V(J).configForm.dhcpEnable?"":"configNetmask"},{default:P((()=>[x(ie,{disabled:V(J).configForm.dhcpEnable,type:"text",modelValue:V(J).configForm.configNetmask,"onUpdate:modelValue":w[6]||(w[6]=e=>V(J).configForm.configNetmask=e),autocomplete:"off",placeholder:"请输入子网掩码"},null,8,["disabled","modelValue"])])),_:1},8,["prop"])):U("",!0),V(J).configForm.configEnable?(_(),G(oe,{key:3,label:"默认网关",prop:V(J).configForm.dhcpEnable||""===V(J).configForm.configGateway?"":"configGateway"},{default:P((()=>[x(ie,{disabled:V(J).configForm.dhcpEnable,type:"text",modelValue:V(J).configForm.configGateway,"onUpdate:modelValue":w[7]||(w[7]=e=>V(J).configForm.configGateway=e),autocomplete:"off",placeholder:"请输入默认网关"},null,8,["disabled","modelValue"])])),_:1},8,["prop"])):U("",!0)])),_:1},8,["model","rules"])])])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-41f3ca6d"]]);export{$ as default};
