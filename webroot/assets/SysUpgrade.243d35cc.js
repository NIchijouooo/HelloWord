import{e as a,p as e,u as s,M as l,q as t,g as o}from"./element-plus.3300f756.js";import{_ as r,u as i,D as n,S as d}from"./index.559546be.js";import{r as u,i as p}from"./@element-plus.0bef5fa5.js";import{K as c,f as m,o as f,c as b,a as y,P as v,S as g,u as j,X as _,W as h,aw as x,ax as k}from"./@vue.73d14ebc.js";import"./lodash-es.98e49362.js";import"./async-validator.fb49d0f5.js";import"./@vueuse.3d90a471.js";import"./dayjs.2790329b.js";import"./axios.765908e4.js";import"./@ctrl.b082b0c1.js";import"./@popperjs.36402333.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./vue-router.43b9a342.js";import"./pinia.3f4aff4f.js";import"./vue-demi.b3a9cad9.js";import"./screenfull.7cf96174.js";import"./vue-echarts.7828944a.js";import"./resize-detector.4e96b72b.js";import"./echarts.2b8dcc79.js";import"./zrender.54f191d6.js";import"./tslib.60310f1a.js";import"./nprogress.aae2b787.js";const P=a=>(x("data-v-56ad595b"),a=a(),k(),a),F={class:"main-container"},S={class:"main",style:{"background-color":"inherit"}},w=P((()=>y("div",{class:"card-header"},[y("span",null,"在线升级")],-1))),C={class:"item"},V=P((()=>y("br",null,null,-1))),z=P((()=>y("br",null,null,-1))),D=P((()=>y("br",null,null,-1))),U=P((()=>y("br",null,null,-1))),q={style:{"text-align":"center"}},I=P((()=>y("div",{class:"card-header"},[y("span",null,"本地升级")],-1))),K={class:"item"},M=P((()=>y("div",null,"请选择您要升级的系统文件。",-1))),R=P((()=>y("br",null,null,-1))),T=P((()=>y("br",null,null,-1))),W=P((()=>y("br",null,null,-1))),X={style:{"text-align":"center"}},A=P((()=>y("div",{class:"el-upload__tip"},"只能上传一个文件，只支持zip格式文件！",-1))),B={class:"dialog-footer"};var E=r({__name:"SysUpgrade",setup(r){const x=i(),k=c({uFlag:!1,sysParams:{}});(()=>{const a={token:x.token,data:{}};n.getSysParams(a).then((a=>{console.log("getSysParams -> res",a),"0"===a.code&&(k.sysParams=a.data,console.log("getSysParams -> ctxData.sysParams",k.sysParams))}))})();const P=()=>{G.value&&G.value.submit()},E=a=>{},G=m(null),H=a=>{G.value.clearFiles();const e=a[0];G.value.handleStart(e)},J=a=>{console.log("beforeUpload -> file",a);const e=["application/x-tar"].includes(a.type);if(e){if(e){let e=new FormData;e.append("file",a);const s={token:x.token,contentType:"multipart/form-data",data:e};d.updateSystem(s).then((a=>{"0"===a.code?(o.success(a.message),k.uFlag=!1):O(a)}))}}else o({type:"error",message:"文件格式不正确,必须是tar文件！"})},L=()=>{k.uFlag=!1,G.value.clearFiles()},N=()=>{L()},O=a=>{o({type:"error",message:a.message})};return(r,i)=>{const n=a,d=e,c=s,m=l,x=t;return f(),b("div",F,[y("div",S,[v(c,{class:"box-card",shadow:"hover"},{header:g((()=>[w])),default:g((()=>[y("div",C,[y("div",null,"当前系统版本："+_(j(k).sysParams.softVer)+" 。",1),V,y("div",null,"最新系统版本："+_(j(k).sysParams.softVer)+" 。",1),z,D,U,y("div",q,[v(d,{type:"primary",onClick:i[0]||(i[0]=a=>{o.info("功能升级中...")})},{default:g((()=>[v(n,{class:"el-input__icon"},{default:g((()=>[v(j(u))])),_:1}),h(" 在线升级系统到最新版本 ")])),_:1})])])])),_:1}),v(c,{class:"box-card",shadow:"hover"},{header:g((()=>[I])),default:g((()=>[y("div",K,[M,R,T,W,y("div",X,[v(d,{type:"primary",onClick:i[1]||(i[1]=a=>(console.log("importSysConfig"),void(k.uFlag=!0)))},{default:g((()=>[v(n,{class:"el-input__icon"},{default:g((()=>[v(j(p))])),_:1}),h(" 导入系统升级文件 ")])),_:1})])])])),_:1})]),v(x,{modelValue:j(k).uFlag,"onUpdate:modelValue":i[2]||(i[2]=a=>j(k).uFlag=a),title:"上传系统升级文件",width:"600px","before-close":N,"close-on-click-modal":!1},{footer:g((()=>[y("span",B,[v(d,{onClick:L},{default:g((()=>[h("取消")])),_:1}),v(d,{type:"primary",onClick:P},{default:g((()=>[h("上传")])),_:1})])])),default:g((()=>[v(m,{ref_key:"uploadRef",ref:G,action:"","auto-upload":!1,"http-request":E,limit:1,"on-exceed":H,"before-upload":J},{tip:g((()=>[A])),default:g((()=>[v(d,{type:"primary"},{default:g((()=>[h("选择文件")])),_:1})])),_:1},512)])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-56ad595b"]]);export{E as default};
