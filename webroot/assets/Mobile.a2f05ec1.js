import{e,m as l,n as a,p as o,o as t,A as r,B as m,l as d,C as i,K as u,v as s,w as n,q as p,g as c,L as f}from"./element-plus.64650d13.js";import{s as b,_ as g,u as h,v}from"./index.98f42e56.js";import{t as w}from"./vue3-barcode.ec0ee5c1.js";import{J as y}from"./@element-plus.aa3ef65f.js";import{f as F,Y as V,p as _,X as x,o as P,c as k,a as A,S as B,Q as C,u as j,P as N,a0 as q,U as R,L as U,M,af as S,at as z,au as I,H as T}from"./@vue.5db09832.js";import"./@vueuse.af8df401.js";import"./dayjs.b9b14681.js";import"./axios.765908e4.js";import"./lodash-es.8ca9079f.js";import"./async-validator.ed4c92a2.js";import"./@ctrl.82a509e0.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.1c4ac15a.js";import"./vue-router.d969f71f.js";import"./pinia.69c74452.js";import"./vue-demi.b3a9cad9.js";import"./screenfull.258ac312.js";import"./vue-echarts.8f00425b.js";import"./resize-detector.4e96b72b.js";import"./echarts.62a08783.js";import"./zrender.56caf4f2.js";import"./tslib.60310f1a.js";import"./nprogress.aae2b787.js";var O=e=>b.request({url:"/network/mobile",method:"post",data:e}),L=e=>b.request({url:"/network/mobile",method:"put",data:e}),D=e=>b.request({url:"/network/mobile",method:"delete",data:e}),H=e=>b.request({url:"/network/mobiles",method:"get",data:e});const E=e=>(z("data-v-6c2c2cc7"),e=e(),I(),e),Z={class:"main-container"},$={class:"main"},K={class:"search-bar"},J=q(" 刷新 "),Q={class:"tool-bar"},W=q(" 添加 "),X=q("编辑"),Y=q("删除"),G=E((()=>A("div",null,"无数据",-1))),ee={class:"mobile-tips"},le=q("注：移动网络配置完成后，必须重启网关，才能生效！"),ae={class:"dialog-content"},oe=E((()=>A("div",{class:"form-title"},[A("div",{class:"tName"},"配置参数")],-1))),te=E((()=>A("div",{class:"form-title"},[A("div",{class:"tName"},"通信参数")],-1))),re=q("单位毫秒"),me=q("单位毫秒"),de=q("单位秒"),ie=E((()=>A("div",{class:"form-title"},[A("div",{class:"tName"},"保活参数")],-1))),ue=q("单位秒"),se=q("单位次"),ne={class:"dialog-footer"},pe=q("取消"),ce=q("保存"),fe={style:{display:"flex",width:"100%","justify-content":"center","text-align":"center"}};var be=g({setup(b){const g=h(),z=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,I=/^(?=^.{3,255}$)(http(s)?:\/\/)?(www\.)?[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+(:\d+)*(\/\w+\.\w+)*$/,E=(e,l,a)=>{console.log("validateIP"),z.test(l)||I.test(l)?a():a(new Error("IP格式错误！"))},be=(e,l,a)=>{isNaN(Number(l))?a(new Error("只能输入数字！")):a()},ge=F(null),he=V({moduleName:"",headerCellStyle:{background:v.primaryColor,color:v.fontWhiteColor,height:"54px"},cellStyle:{height:"48px"},tableMaxHeight:0,currentPage:1,pagesize:20,moduleTableData:[],showAddBtn:!0,mFlag:!1,mTitle:"添加移动网络",moduleForm:{name:"",model:"",flowAlarm:!1,flowAlarmValue:"",serialNumber:"",baudRate:"",dataBits:"",stopBits:"",parity:"",timeout:"",interval:"",polling:"",ipMaster:"",ipSlave:"",pollPeriod:"",offlineCnt:""},moduleRules:{name:[{required:!0,message:"模块名称不能为空",trigger:"blur"}],model:[{required:!0,message:"模块型号不能为空",trigger:"blur"}],serialNumber:[{required:!0,message:"串口号不能为空",trigger:"blur"}],baudRate:[{required:!0,message:"波特率不能为空",trigger:"blur"}],dataBits:[{required:!0,message:"数据位不能为空",trigger:"blur"}],stopBits:[{required:!0,message:"停止位不能为空",trigger:"blur"}],parity:[{required:!0,message:"校验位不能为空",trigger:"blur"}],flowAlarmValue:[{required:!0,message:"流量报警值不能为空",trigger:"blur"},{trigger:"blur",validator:be}],timeout:[{required:!0,message:"超时时间不能为空",trigger:"blur"},{trigger:"blur",validator:be}],interval:[{required:!0,message:"间隔时间不能为空",trigger:"blur"},{trigger:"blur",validator:be}],polling:[{required:!0,message:"轮询时间不能为空",trigger:"blur"},{trigger:"blur",validator:be}],ipMaster:[{required:!0,validator:E,trigger:"blur"}],ipSlave:[{validator:E,trigger:"blur"}],pollPeriod:[{required:!0,message:"保活检测周期不能为空",trigger:"blur"},{type:"number",message:"保活检测周期只能输入数字"}],offlineCnt:[{required:!0,message:"离线判断次数不能为空",trigger:"blur"},{type:"number",message:"离线判断次数只能输入数字"}]},baudRateOptions:[{value:"1200",label:"1200"},{value:"2400",label:"2400"},{value:"4800",label:"4800"},{value:"9600",label:"9600"},{value:"14400",label:"14400"},{value:"19200",label:"19200"},{value:"115200",label:"115200"}],dataBitsOptions:[{value:"5",label:"5"},{value:"6",label:"6"},{value:"7",label:"7"},{value:"8",label:"8"}],stopBitsOptions:[{value:"1",label:"1"},{value:"1.5",label:"1.5"},{value:"2",label:"2"}],parityOptions:[{value:"N",label:"无校验"},{value:"O",label:"奇校验"},{value:"E",label:"偶校验"}],sFlag:!1,barcodeVale:0}),ve=e=>{const l={token:g.token,data:{}};H(l).then((async l=>{console.log("getModuleList -> res",l),l&&("0"===l.code?(he.moduleTableData=l.data,he.showAddBtn=0===l.data.length,1===e&&c({type:"success",message:"刷新成功！"})):Pe(l),await T((()=>{he.tableMaxHeight=ge.value.clientHeight-34-36-22})))}))};ve();const we=_((()=>he.moduleTableData.filter((e=>!he.moduleName||e.name.toLowerCase().includes(he.moduleName.toLowerCase()))).slice((he.currentPage-1)*he.pagesize,he.currentPage*he.pagesize)));_((()=>he.moduleTableData.filter((e=>!he.moduleName||e.name.toLowerCase().includes(he.moduleName.toLowerCase())))));const ye=e=>{he.mFlag=!0,he.mTitle="编辑移动网络",he.moduleForm.name=e.name,he.moduleForm.model=e.model,he.moduleForm.flowAlarm=e.configParam.flowAlarm,he.moduleForm.flowAlarmValue=e.configParam.flowAlarmValue,he.moduleForm.serialNumber=e.commParam.name,he.moduleForm.baudRate=e.commParam.baudRate,he.moduleForm.dataBits=e.commParam.dataBits,he.moduleForm.stopBits=e.commParam.stopBits,he.moduleForm.parity=e.commParam.parity,he.moduleForm.timeout=e.commParam.timeout,he.moduleForm.interval=e.commParam.interval,he.moduleForm.polling=e.commParam.pollPeriod,he.moduleForm.ipMaster=e.keepAliveParam.ipMaster,he.moduleForm.ipSlave=e.keepAliveParam.ipSlave,he.moduleForm.pollPeriod=e.keepAliveParam.pollPeriod,he.moduleForm.offlineCnt=e.keepAliveParam.offlineCnt},Fe=F(null),Ve=e=>{_e()},_e=()=>{he.mFlag=!1,Fe.value.resetFields(),xe()},xe=()=>{he.moduleForm={name:"",model:"",flowAlarm:!1,flowAlarmValue:"",serialNumber:"",baudRate:"",dataBits:"",stopBits:"",parity:"",timeout:"",interval:"",polling:"",ipMaster:"",ipSlave:"",pollPeriod:"",offlineCnt:""}},Pe=e=>{c({type:"error",message:e.message})},ke=(e,l)=>{c({type:"0"===e.code?"success":"error",message:e.message}),"0"===e.code&&l&&l()};return(b,h)=>{const v=e,F=l,V=a,_=x("Icon"),z=o,I=t,T=r,H=m,E=d,be=i,xe=u,Pe=s,Ae=n,Be=p;return P(),k("div",Z,[A("div",$,[A("div",K,[B(I,{inline:!0,ref:"searchFormRef","status-icon":"","label-width":"90px"},{default:C((()=>[B(V,{label:"模块名称"},{default:C((()=>[B(F,{style:{width:"200px"},placeholder:"请输入模块名称",clearable:"",modelValue:j(he).moduleName,"onUpdate:modelValue":h[0]||(h[0]=e=>j(he).moduleName=e)},{prefix:C((()=>[B(v,{class:"el-input__icon"},{default:C((()=>[B(j(y))])),_:1})])),_:1},8,["modelValue"])])),_:1}),B(V,null,{default:C((()=>[B(z,{style:{color:"#fff","margin-left":"20px"},color:"#2EA554",class:"right-btn",onClick:h[1]||(h[1]=e=>{ve(1)})},{default:C((()=>[B(v,{class:"btn-icon"},{default:C((()=>[B(_,{name:"local-refresh",size:"14px",color:"#ffffff"})])),_:1}),J])),_:1})])),_:1})])),_:1},512)]),A("div",Q,[B(z,{type:"primary",bg:"",class:"right-btn",onClick:h[2]||(h[2]=e=>{he.mFlag=!0})},{default:C((()=>[B(v,{class:"btn-icon"},{default:C((()=>[B(_,{name:"local-add",size:"14px",color:"#ffffff"})])),_:1}),W])),_:1})]),A("div",{class:"content",ref_key:"contentRef",ref:ge},[B(be,{data:j(we),"cell-style":j(he).cellStyle,"header-cell-style":j(he).headerCellStyle,style:{width:"100%"},"max-height":j(he).tableMaxHeight,stripe:"",onRowDblclick:ye},{empty:C((()=>[G])),default:C((()=>[B(T,{prop:"name",label:"模块名称",width:"auto","min-width":"120",align:"center"}),B(T,{prop:"model",label:"模块型号",width:"auto","min-width":"120",align:"center"}),B(T,{label:"sim卡号",width:"auto","min-width":"180",align:"center"},{default:C((e=>[""!==e.row.runParam.iccid?(P(),N(E,{key:0,class:"box-item",effect:"dark",content:"单击显示SIM卡条形码",placement:"top-start"},{default:C((()=>[B(H,{style:{cursor:"pointer"},onClick:l=>{return a=e.row.runParam.iccid,he.sFlag=!0,void(he.barcodeVale=a);var a}},{default:C((()=>[q(R(e.row.runParam.iccid),1)])),_:2},1032,["onClick"])])),_:2},1024)):U("",!0)])),_:1}),B(T,{label:"imei",width:"auto","min-width":"150",align:"center"},{default:C((e=>[q(R(e.row.runParam.imei),1)])),_:1}),B(T,{label:"信号强度",width:"auto","min-width":"80",align:"center"},{default:C((e=>[q(R(e.row.runParam.csq),1)])),_:1}),B(T,{label:"流量（KByte）",width:"auto","min-width":"150",align:"center"},{default:C((e=>[q(R(e.row.runParam.flow),1)])),_:1}),B(T,{label:"基站定位Lac",width:"auto","min-width":"110",align:"center"},{default:C((e=>[q(R(e.row.runParam.lac),1)])),_:1}),B(T,{label:"基站定位Ci",width:"auto","min-width":"100",align:"center"},{default:C((e=>[q(R(e.row.runParam.ci),1)])),_:1}),B(T,{label:"sim卡插入状态",width:"auto","min-width":"120",align:"center"},{default:C((e=>[B(H,{type:e.row.runParam.simInsert?"success":"danger"},{default:C((()=>[q(R(e.row.runParam.simInsert?"是":"否"),1)])),_:2},1032,["type"])])),_:1}),B(T,{label:"网络注册状态",width:"auto","min-width":"120",align:"center"},{default:C((e=>[B(H,{type:e.row.runParam.netRegister?"success":"danger"},{default:C((()=>[q(R(e.row.runParam.netRegister?"是":"否"),1)])),_:2},1032,["type"])])),_:1}),B(T,{label:"操作",width:"auto","min-width":"150",align:"center",fixed:"right"},{default:C((e=>[B(z,{onClick:l=>ye(e.row),text:"",type:"primary"},{default:C((()=>[X])),_:2},1032,["onClick"]),B(z,{onClick:l=>{return a=e.row,void f.confirm("确定要删除这个移动网络吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e={token:g.token,data:{name:a.name}};D(e).then((e=>{ke(e,ve)}))})).catch((()=>{c({type:"info",message:"取消删除"})}));var a},text:"",type:"danger"},{default:C((()=>[Y])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","cell-style","header-cell-style","max-height"]),A("div",ee,[B(H,{class:"ml-2",type:"danger"},{default:C((()=>[le])),_:1})])],512)]),B(Be,{modelValue:j(he).mFlag,"onUpdate:modelValue":h[21]||(h[21]=e=>j(he).mFlag=e),title:j(he).mTitle,width:"900px","before-close":Ve,"close-on-click-modal":!1},{footer:C((()=>[A("span",ne,[B(z,{onClick:h[19]||(h[19]=e=>_e())},{default:C((()=>[pe])),_:1}),B(z,{type:"primary",onClick:h[20]||(h[20]=e=>{Fe.value.validate((e=>{const l={name:he.moduleForm.name,model:he.moduleForm.model,commParam:{},configParam:{}},a={name:he.moduleForm.serialNumber,baudRate:he.moduleForm.baudRate,dataBits:he.moduleForm.dataBits,stopBits:he.moduleForm.stopBits,parity:he.moduleForm.parity,timeout:he.moduleForm.timeout,interval:he.moduleForm.interval,pollPeriod:he.moduleForm.polling},o={flowAlarm:he.moduleForm.flowAlarm,flowAlarmValue:he.moduleForm.flowAlarmValue},t={ipMaster:he.moduleForm.ipMaster,ipSlave:he.moduleForm.ipSlave,pollPeriod:he.moduleForm.pollPeriod,offlineCnt:he.moduleForm.offlineCnt};if(l.commParam=a,l.configParam=o,l.keepAliveParam=t,!e)return!1;{const e={token:g.token,data:l};he.mTitle.includes("添加")?O(e).then((e=>{ke(e,ve),_e()})):L(e).then((e=>{ke(e,ve),_e()}))}}))})},{default:C((()=>[ce])),_:1})])])),default:C((()=>[A("div",ae,[B(I,{model:j(he).moduleForm,rules:j(he).moduleRules,ref_key:"moduleFormRef",ref:Fe,"status-icon":"","label-position":"right","label-width":"120px",inline:"true"},{default:C((()=>[B(V,{label:"模块名称",prop:"name"},{default:C((()=>[B(F,{disabled:j(he).mTitle.includes("编辑"),type:"text",style:{width:"270px"},modelValue:j(he).moduleForm.name,"onUpdate:modelValue":h[3]||(h[3]=e=>j(he).moduleForm.name=e),autocomplete:"off",placeholder:"请输入模块名称"},null,8,["disabled","modelValue"])])),_:1}),B(V,{label:"模块型号",prop:"model"},{default:C((()=>[B(F,{type:"text",style:{width:"270px"},modelValue:j(he).moduleForm.model,"onUpdate:modelValue":h[4]||(h[4]=e=>j(he).moduleForm.model=e),autocomplete:"off",placeholder:"请输入模块型号"},null,8,["modelValue"])])),_:1}),oe,B(V,{label:"启用流量报警",prop:"flowAlarm"},{default:C((()=>[B(xe,{style:{width:"270px"},modelValue:j(he).moduleForm.flowAlarm,"onUpdate:modelValue":h[5]||(h[5]=e=>j(he).moduleForm.flowAlarm=e),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])])),_:1}),B(V,{label:"流量报警值",prop:j(he).moduleForm.flowAlarm?"flowAlarmValue":""},{default:C((()=>[B(F,{disabled:!j(he).moduleForm.flowAlarm,type:"text",style:{width:"270px"},modelValue:j(he).moduleForm.flowAlarmValue,"onUpdate:modelValue":h[6]||(h[6]=e=>j(he).moduleForm.flowAlarmValue=e),autocomplete:"off",placeholder:"请输入流量报警值"},null,8,["disabled","modelValue"])])),_:1},8,["prop"]),te,B(V,{label:"串口号",prop:"serialNumber"},{default:C((()=>[B(F,{type:"text",style:{width:"270px"},modelValue:j(he).moduleForm.serialNumber,"onUpdate:modelValue":h[7]||(h[7]=e=>j(he).moduleForm.serialNumber=e),autocomplete:"off",placeholder:"请输入串口名称"},null,8,["modelValue"])])),_:1}),B(V,{label:"波特率",prop:"baudRate"},{default:C((()=>[B(Ae,{modelValue:j(he).moduleForm.baudRate,"onUpdate:modelValue":h[8]||(h[8]=e=>j(he).moduleForm.baudRate=e),style:{width:"270px"},placeholder:"请选择波特率"},{default:C((()=>[(P(!0),k(M,null,S(j(he).baudRateOptions,(e=>(P(),N(Pe,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),B(V,{label:"数据位",prop:"dataBits"},{default:C((()=>[B(Ae,{modelValue:j(he).moduleForm.dataBits,"onUpdate:modelValue":h[9]||(h[9]=e=>j(he).moduleForm.dataBits=e),style:{width:"270px"},placeholder:"请选择数据位"},{default:C((()=>[(P(!0),k(M,null,S(j(he).dataBitsOptions,(e=>(P(),N(Pe,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),B(V,{label:"停止位",prop:"stopBits"},{default:C((()=>[B(Ae,{modelValue:j(he).moduleForm.stopBits,"onUpdate:modelValue":h[10]||(h[10]=e=>j(he).moduleForm.stopBits=e),style:{width:"270px"},placeholder:"请选择停止位"},{default:C((()=>[(P(!0),k(M,null,S(j(he).stopBitsOptions,(e=>(P(),N(Pe,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),B(V,{label:"校验位",prop:"parity"},{default:C((()=>[B(Ae,{modelValue:j(he).moduleForm.parity,"onUpdate:modelValue":h[11]||(h[11]=e=>j(he).moduleForm.parity=e),style:{width:"270px"},placeholder:"请选择校验位"},{default:C((()=>[(P(!0),k(M,null,S(j(he).parityOptions,(e=>(P(),N(Pe,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),B(V,{label:"超时时间",prop:"timeout"},{default:C((()=>[B(F,{type:"text",style:{width:"270px"},modelValue:j(he).moduleForm.timeout,"onUpdate:modelValue":h[12]||(h[12]=e=>j(he).moduleForm.timeout=e),autocomplete:"off",placeholder:"请输入超时时间"},{append:C((()=>[re])),_:1},8,["modelValue"])])),_:1}),B(V,{label:"间隔时间",prop:"interval"},{default:C((()=>[B(F,{type:"text",style:{width:"270px"},modelValue:j(he).moduleForm.interval,"onUpdate:modelValue":h[13]||(h[13]=e=>j(he).moduleForm.interval=e),autocomplete:"off",placeholder:"请输入间隔时间"},{append:C((()=>[me])),_:1},8,["modelValue"])])),_:1}),B(V,{label:"轮询时间",prop:"polling"},{default:C((()=>[B(F,{type:"text",style:{width:"270px"},modelValue:j(he).moduleForm.polling,"onUpdate:modelValue":h[14]||(h[14]=e=>j(he).moduleForm.polling=e),autocomplete:"off",placeholder:"请输入轮询时间"},{append:C((()=>[de])),_:1},8,["modelValue"])])),_:1}),ie,B(V,{label:"保活检测主IP",prop:"ipMaster"},{default:C((()=>[B(F,{type:"text",style:{width:"270px"},modelValue:j(he).moduleForm.ipMaster,"onUpdate:modelValue":h[15]||(h[15]=e=>j(he).moduleForm.ipMaster=e),autocomplete:"off",placeholder:"请输入保活检测主IP"},null,8,["modelValue"])])),_:1}),B(V,{label:"保活检测备用IP",prop:"ipSlave"},{default:C((()=>[B(F,{type:"text",style:{width:"270px"},modelValue:j(he).moduleForm.ipSlave,"onUpdate:modelValue":h[16]||(h[16]=e=>j(he).moduleForm.ipSlave=e),autocomplete:"off",placeholder:"请输入保活检测备用IP"},null,8,["modelValue"])])),_:1}),B(V,{label:"保活检测周期",prop:"pollPeriod"},{default:C((()=>[B(F,{type:"text",style:{width:"270px"},modelValue:j(he).moduleForm.pollPeriod,"onUpdate:modelValue":h[17]||(h[17]=e=>j(he).moduleForm.pollPeriod=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入保活检测周期"},{append:C((()=>[ue])),_:1},8,["modelValue"])])),_:1}),B(V,{label:"离线判断次数",prop:"offlineCnt"},{default:C((()=>[B(F,{type:"text",style:{width:"270px"},modelValue:j(he).moduleForm.offlineCnt,"onUpdate:modelValue":h[18]||(h[18]=e=>j(he).moduleForm.offlineCnt=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入离线判断次数"},{append:C((()=>[se])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["modelValue","title"]),B(Be,{modelValue:j(he).sFlag,"onUpdate:modelValue":h[22]||(h[22]=e=>j(he).sFlag=e),title:"sim卡号条形码",width:"30%"},{default:C((()=>[A("div",fe,[B(j(w),{value:j(he).barcodeVale,height:60},null,8,["value"])])])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-6c2c2cc7"]]);export{be as default};
