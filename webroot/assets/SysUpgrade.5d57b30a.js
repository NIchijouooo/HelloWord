import{e as a,p as e,u as s,M as l,q as t,g as o}from"./element-plus.64650d13.js";import{_ as r,u as i,D as n,S as d}from"./index.98f42e56.js";import{N as u,M as c}from"./@element-plus.aa3ef65f.js";import{Y as p,f as m,o as f,c as v,a as y,S as b,Q as g,U as j,u as _,at as h,au as k,a0 as x}from"./@vue.5db09832.js";import"./@vueuse.af8df401.js";import"./dayjs.b9b14681.js";import"./axios.765908e4.js";import"./lodash-es.8ca9079f.js";import"./async-validator.ed4c92a2.js";import"./@ctrl.82a509e0.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.1c4ac15a.js";import"./vue-router.d969f71f.js";import"./pinia.69c74452.js";import"./vue-demi.b3a9cad9.js";import"./screenfull.258ac312.js";import"./vue-echarts.8f00425b.js";import"./resize-detector.4e96b72b.js";import"./echarts.62a08783.js";import"./zrender.56caf4f2.js";import"./tslib.60310f1a.js";import"./nprogress.aae2b787.js";const F=a=>(h("data-v-56ad595b"),a=a(),k(),a),P={class:"main-container"},S={class:"main",style:{"background-color":"inherit"}},w=F((()=>y("div",{class:"card-header"},[y("span",null,"在线升级")],-1))),C={class:"item"},V=F((()=>y("br",null,null,-1))),z=F((()=>y("br",null,null,-1))),D=F((()=>y("br",null,null,-1))),U=F((()=>y("br",null,null,-1))),q={style:{"text-align":"center"}},M=x(" 在线升级系统到最新版本 "),I=F((()=>y("div",{class:"card-header"},[y("span",null,"本地升级")],-1))),N={class:"item"},Q=F((()=>y("div",null,"请选择您要升级的系统文件。",-1))),R=F((()=>y("br",null,null,-1))),T=F((()=>y("br",null,null,-1))),Y=F((()=>y("br",null,null,-1))),A={style:{"text-align":"center"}},B=x(" 导入系统升级文件 "),E=x("选择文件"),G=F((()=>y("div",{class:"el-upload__tip"},"只能上传一个文件，只支持zip格式文件！",-1))),H={class:"dialog-footer"},J=x("取消"),K=x("上传");var L=r({setup(r){const h=i(),k=p({uFlag:!1,sysParams:{}});(()=>{const a={token:h.token,data:{}};n.getSysParams(a).then((a=>{console.log("getSysParams -> res",a),"0"===a.code&&(k.sysParams=a.data,console.log("getSysParams -> ctxData.sysParams",k.sysParams))}))})();const x=()=>{L.value&&L.value.submit()},F=a=>{},L=m(null),O=a=>{L.value.clearFiles();const e=a[0];L.value.handleStart(e)},W=a=>{console.log("beforeUpload -> file",a);const e=["application/x-tar"].includes(a.type);if(e){if(e){let e=new FormData;e.append("file",a);const s={token:h.token,contentType:"multipart/form-data",data:e};d.updateSystem(s).then((a=>{"0"===a.code?(o.success(a.message),k.uFlag=!1):$(a)}))}}else o({type:"error",message:"文件格式不正确,必须是tar文件！"})},X=()=>{k.uFlag=!1,L.value.clearFiles()},Z=()=>{X()},$=a=>{o({type:"error",message:a.message})};return(r,i)=>{const n=a,d=e,p=s,m=l,h=t;return f(),v("div",P,[y("div",S,[b(p,{class:"box-card",shadow:"hover"},{header:g((()=>[w])),default:g((()=>[y("div",C,[y("div",null,"当前系统版本："+j(_(k).sysParams.softVer)+" 。",1),V,y("div",null,"最新系统版本："+j(_(k).sysParams.softVer)+" 。",1),z,D,U,y("div",q,[b(d,{type:"primary",onClick:i[0]||(i[0]=a=>{o.info("功能升级中...")})},{default:g((()=>[b(n,{class:"el-input__icon"},{default:g((()=>[b(_(u))])),_:1}),M])),_:1})])])])),_:1}),b(p,{class:"box-card",shadow:"hover"},{header:g((()=>[I])),default:g((()=>[y("div",N,[Q,R,T,Y,y("div",A,[b(d,{type:"primary",onClick:i[1]||(i[1]=a=>(console.log("importSysConfig"),void(k.uFlag=!0)))},{default:g((()=>[b(n,{class:"el-input__icon"},{default:g((()=>[b(_(c))])),_:1}),B])),_:1})])])])),_:1})]),b(h,{modelValue:_(k).uFlag,"onUpdate:modelValue":i[2]||(i[2]=a=>_(k).uFlag=a),title:"上传系统升级文件",width:"600px","before-close":Z,"close-on-click-modal":!1},{footer:g((()=>[y("span",H,[b(d,{onClick:X},{default:g((()=>[J])),_:1}),b(d,{type:"primary",onClick:x},{default:g((()=>[K])),_:1})])])),default:g((()=>[b(m,{ref_key:"uploadRef",ref:L,action:"","auto-upload":!1,"http-request":F,limit:1,"on-exceed":O,"before-upload":W},{tip:g((()=>[G])),default:g((()=>[b(d,{type:"primary"},{default:g((()=>[E])),_:1})])),_:1},512)])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-56ad595b"]]);export{L as default};
