import{g as e,O as a,L as l,e as t,p as o,n as r,o as p,m as n,A as s,C as i,D as d,v as m,w as c,K as u,q as f,M as y}from"./element-plus.64650d13.js";import{_ as g,u as h,v as b}from"./index.98f42e56.js";import{T as x}from"./transferModel.d21ca768.js";import{D as F}from"./deviceModel.a85a7758.js";import{I as _,J as v}from"./@element-plus.aa3ef65f.js";import{Y as w,f as C,p as k,X as V,o as P,c as M,a as L,S as A,Q as T,u as N,U as z,M as j,af as U,a0 as D,P as S,L as R,V as I,at as q,au as H,H as O}from"./@vue.5db09832.js";import"./@vueuse.af8df401.js";import"./dayjs.b9b14681.js";import"./axios.765908e4.js";import"./lodash-es.8ca9079f.js";import"./async-validator.ed4c92a2.js";import"./@ctrl.82a509e0.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.1c4ac15a.js";import"./vue-router.d969f71f.js";import"./pinia.69c74452.js";import"./vue-demi.b3a9cad9.js";import"./screenfull.258ac312.js";import"./vue-echarts.8f00425b.js";import"./resize-detector.4e96b72b.js";import"./echarts.62a08783.js";import"./zrender.56caf4f2.js";import"./tslib.60310f1a.js";import"./nprogress.aae2b787.js";const B=e=>(q("data-v-194ab7a4"),e=e(),H(),e),E={class:"main-container"},W={class:"main"},J={class:"search-bar"},K=D(" 返回上报模型 "),Q={class:"search-bar",style:{display:"flex"}},X={class:"title",style:{position:"relative","margin-right":"40px",height:"40px",padding:"0px 0","justify-content":"flex-start"}},Y={class:"tName"},G=D(" 手动添加 "),Z=D(" 同步 "),$=D(" 删除 "),ee=D(" 刷新 "),ae={class:"param-content"},le={class:"pc-title"},te={class:"pct-info"},oe=D(" "+z("参数详情")),re={class:"pc-content"},pe={class:"param-value"},ne={class:"param-name"},se=D("编辑"),ie=B((()=>L("div",null,"无数据",-1))),de={class:"pagination"},me={class:"dialog-content"},ce={class:"dialog-footer"},ue=D("取消"),fe=D("保存"),ye=D("选择文件"),ge=B((()=>L("div",{class:"el-upload__tip"},"只能上传一个文件，只支持xlsx格式文件！",-1))),he={class:"dialog-footer"},be=D("取消"),xe=D("上传"),Fe={class:"dialog-content",style:{"min-height":"408px",overflow:"unset",padding:"0"}},_e={class:"dialog-content-head"},ve={class:"dialog-content-content"},we={class:"pagination dialog-pagination"},Ce={class:"dialog-footer"},ke=D("取消"),Ve=D("保存");var Pe=g({props:{curTransferModel:{type:Object,default:{}}},emits:["changeTmFlag"],setup(g,{emit:q}){const H=g,B=h();console.log("id -> props",H);const Pe=w({headerCellStyle:{background:b.primaryColor,color:b.fontWhiteColor,height:"54px"},cellStyle:{height:"48px"},tableMaxHeight:0,currentPage:1,pagesize:20,PropertyTableData:[],pFlag:!1,pTitle:"添加属性",PropertyInfo:"",propertyForm:{name:"",label:"",uploadName:"",type:0,min:"",max:"",minMaxAlarm:!1,step:"",stepAlarm:!1,unit:"",decimals:0,dataLength:"",dataLengthAlarm:!1},typeOptions:[{label:"uint32",value:0},{label:"int32",value:1},{label:"double",value:2},{label:"string",value:3}],typeNames:{t0:"uint32",t1:"int32",t2:"double",t3:"string"},paramName:{name:"属性名称",label:"属性标签",uploadName:"上报属性名称",type:"数据类型",min:"最小值",max:"最大值",minMaxAlarm:"范围报警",step:"布长",stepAlarm:"布长报警",unit:"单位",decimals:"小数位数",dataLength:"字符串长度",dataLengthAlarm:"字符串长度报警"},propertyRules:{name:[{required:!0,message:"属性名称不能为空",trigger:"blur"}],label:[{required:!0,message:"属性标签不能为空",trigger:"blur"}],uploadName:[{required:!0,message:"上报属性名称不能为空",trigger:"blur"}],type:[{required:!0,message:"数据类型不能为空",trigger:"blur"}],decimals:[{type:"number",message:"小数位数只能输入数字"}]},psFlag:!1,selectedProperties:[],collDeviceModelList:[],curCollName:"",selectList:[],AllPropertyNameList:[],pName:"",pTableData:[],pHeadStyle:{color:b.headerTextColor,borderColor:"#C0C4CC",height:"48px"},pCellStyle:{borderColor:"#C0C4CC",height:"48px"},pCurrentPage:1,pPagesize:5}),Me=C(null),Le=a=>{const l={token:B.token,data:{name:H.curTransferModel.name}};x.getPropertiesByModelIdList(l).then((async l=>{console.log("getPropertiesByModelIdList -> res",l),l&&("0"===l.code?(Pe.PropertyTableData=l.data,Pe.AllPropertyNameList=[],Pe.PropertyTableData.forEach((e=>{Pe.AllPropertyNameList.push(e.name)})),console.log("AllPropertyNameList ->",Pe.AllPropertyNameList),1===a&&e({type:"success",message:"刷新成功！"})):Ye(l),await O((()=>{Pe.tableMaxHeight=Me.value.clientHeight-34-36-132})))}))};Le();const Ae=k((()=>{let e=Pe.PropertyInfo;return Pe.PropertyTableData.filter((a=>!e||a.name.toLowerCase().includes(e.toLowerCase())||a.label.toLowerCase().includes(e.toLowerCase()))).slice((Pe.currentPage-1)*Pe.pagesize,Pe.currentPage*Pe.pagesize)})),Te=k((()=>{let e=Pe.PropertyInfo;return Pe.PropertyTableData.filter((a=>!e||a.name.toLowerCase().includes(e.toLowerCase())||a.label.toLowerCase().includes(e.toLowerCase())))})),Ne=e=>{Pe.currentPage=e},ze=e=>{Pe.pagesize=e},je=()=>{const e={token:B.token,data:{name:Pe.curCollName}};F.getDeviceModelProperty(e).then((e=>{console.log("getDeviceModelProperty -> res",e),"0"===e.code?Pe.pTableData=e.data:(Pe.pTableData=[],Ye(e))}))},Ue=e=>{Pe.selectList=e},De=()=>{Pe.plFlag=!0,(()=>{const e={token:B.token,data:{}};F.getDeviceModelList(e).then((e=>{console.log("getDeviceModelList -> res = ",e),"0"===e.code?(Pe.collDeviceModelList=e.data,e.data.length>0&&(Pe.curCollName=e.data[0].name),je()):Ye(e)}))})()},Se=()=>{je()},Re=e=>{Pe.pCurrentPage=e},Ie=e=>{Pe.pPagesize=e},qe=e=>!Pe.AllPropertyNameList.includes(e.name),He=async()=>{const l=a.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});if(console.log("saveProperties"),Pe.selectList.length>0){let a=[];Pe.selectList.map((e=>{let l={};l.name=e.name,l.label=e.label,l.uploadName=e.name,l.type=e.type,l.decimals=e.decimals,l.unit=e.unit;let t={};3!==e.type?(t.min="",t.max="",t.minMaxAlarm=!1,t.step="",t.stepAlarm=!1):(t.dataLength="",t.dataLengthAlarm=!1),l.params=t,a.push(l)})),console.log("saveProperties -> properties",a);const t={token:B.token,data:{name:H.curTransferModel.name,property:a}},o=await x.addProperties(t),r=a.length;if(o.data==r)l.close(),Ge(o,Le),Oe();else if(o.data){l.close();let a=o.data+"个添加成功，"+(r-o.data)+"个添加失败";e({type:"error",message:a}),Se()}else{l.close(),e({type:"error",message:"添加失败"}),Se()}}},Oe=()=>{Pe.plFlag=!1},Be=e=>{Oe()},Ee=e=>{Pe.pFlag=!0,Pe.pTitle="编辑属性",Pe.propertyForm.name=e.name,Pe.propertyForm.label=e.label,Pe.propertyForm.uploadName=e.uploadName,console.log("editProperty -> row ",e),Pe.propertyForm.type=e.type,Pe.propertyForm.decimals=e.decimals,Pe.propertyForm.unit=e.unit,3!==e.type?(Pe.propertyForm.min=e.params.min,Pe.propertyForm.max=e.params.max,Pe.propertyForm.minMaxAlarm=e.params.minMaxAlarm,Pe.propertyForm.step=e.params.step,Pe.propertyForm.stepAlarm=e.params.stepAlarm):(Pe.propertyForm.dataLength=e.params.dataLength,Pe.propertyForm.dataLengthAlarm=e.params.dataLengthAlarm),console.log("ctxData.propertyForm",Pe.propertyForm)},We=C(null),Je=()=>{Pe.pFlag=!1,We.value.resetFields(),Xe()},Ke=e=>{Je()},Qe=e=>{Pe.selectedProperties=e,console.log("handleSelectionChange -> val =",e)},Xe=()=>{Pe.propertyForm={name:"",label:"",type:0,min:"",max:"",minMaxAlarm:!1,step:"",stepAlarm:!1,unit:"",decimals:0,dataLength:"",dataLengthAlarm:!1}},Ye=a=>{e({type:"error",message:a.message})},Ge=(a,l)=>{e({type:"0"===a.code?"success":"error",message:a.message}),"0"===a.code&&l&&l()};return(a,g)=>{const h=t,F=o,w=r,C=p,k=n,O=V("Icon"),je=s,Xe=i,Ye=d,Ze=m,$e=c,ea=u,aa=f,la=y;return P(),M("div",E,[L("div",W,[L("div",J,[A(C,{inline:!0,ref:"searchFormRef","status-icon":"","label-width":"120px"},{default:T((()=>[A(w,{style:{"margin-left":"20px"}},{default:T((()=>[A(F,{type:"primary",plain:"",onClick:g[0]||(g[0]=e=>{q("changeTmFlag")}),style:{"margin-right":"20px"}},{default:T((()=>[A(h,{class:"el-input__icon"},{default:T((()=>[A(N(_))])),_:1}),K])),_:1})])),_:1})])),_:1},512)]),L("div",Q,[L("div",X,[L("div",Y,z(H.curTransferModel.label),1)]),A(C,{inline:!0,ref:"searchFormRef2","status-icon":"","label-width":"90px"},{default:T((()=>[A(w,{label:""},{default:T((()=>[A(k,{style:{width:"200px"},placeholder:"请输入属性名称或者标签",clearable:"",modelValue:N(Pe).PropertyInfo,"onUpdate:modelValue":g[1]||(g[1]=e=>N(Pe).PropertyInfo=e)},{prefix:T((()=>[A(h,{class:"el-input__icon"},{default:T((()=>[A(N(v))])),_:1})])),_:1},8,["modelValue"])])),_:1}),A(w,null,{default:T((()=>[A(F,{type:"primary",bg:"",class:"right-btn",onClick:g[2]||(g[2]=e=>(console.log("addDeviceModelProperty"),Pe.pFlag=!0,void(Pe.pTitle="添加属性")))},{default:T((()=>[A(h,{class:"btn-icon"},{default:T((()=>[A(O,{name:"local-add",size:"14px",color:"#ffffff"})])),_:1}),G])),_:1})])),_:1}),A(w,null,{default:T((()=>[A(F,{type:"primary",bg:"",class:"right-btn",onClick:g[3]||(g[3]=e=>De())},{default:T((()=>[A(h,{class:"btn-icon"},{default:T((()=>[A(O,{name:"local-tongbu",size:"14px",color:"#ffffff"})])),_:1}),Z])),_:1})])),_:1}),A(w,null,{default:T((()=>[A(F,{type:"danger",bg:"",class:"right-btn",onClick:g[4]||(g[4]=a=>(()=>{let a=[];0!==Pe.selectedProperties.length?(Pe.selectedProperties.forEach((e=>{a.push(e.name)})),console.log("pList",a),l.confirm("确认要删除这些属性吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e={token:B.token,data:{name:H.curTransferModel.name,properties:a}};x.deleteProperty(e).then((e=>{Ge(e,Le)}))})).catch((()=>{e({type:"info",message:"取消删除"})}))):e.info("请至少选择一个属性！")})())},{default:T((()=>[A(h,{class:"btn-icon"},{default:T((()=>[A(O,{name:"local-delete",size:"14px",color:"#ffffff"})])),_:1}),$])),_:1})])),_:1}),A(w,null,{default:T((()=>[A(F,{style:{color:"#fff"},color:"#2EA554",class:"right-btn",onClick:g[5]||(g[5]=e=>{Le(1)})},{default:T((()=>[A(h,{class:"btn-icon"},{default:T((()=>[A(O,{name:"local-refresh",size:"14px",color:"#ffffff"})])),_:1}),ee])),_:1})])),_:1})])),_:1},512)]),L("div",{class:"content",ref_key:"contentRef",ref:Me,style:{top:"136px"}},[A(Xe,{data:N(Ae),"cell-style":N(Pe).cellStyle,"header-cell-style":N(Pe).headerCellStyle,"max-height":N(Pe).tableMaxHeight,style:{width:"100%"},stripe:"",onSelectionChange:Qe,onRowDblclick:Ee},{empty:T((()=>[ie])),default:T((()=>[A(je,{type:"selection",width:"55"}),A(je,{type:"expand"},{default:T((e=>[L("div",ae,[L("div",le,[L("div",te,[L("b",null,z(e.row.name),1),oe])]),L("div",re,[(P(!0),M(j,null,U(e.row.params,((e,a,l)=>(P(),M("div",{class:"param-item",key:l},[L("div",pe,z(N(Pe).paramName[a])+"：",1),L("div",ne,z("boolean"==typeof e?e?"是":"否":e||"-"),1)])))),128))])])])),_:1}),A(je,{prop:"name",label:"属性名称",width:"auto","min-width":"180",align:"center"}),A(je,{prop:"label",label:"属性标签",width:"auto","min-width":"180",align:"center"}),A(je,{prop:"uploadName",label:"上报属性名称",width:"auto","min-width":"180",align:"center"}),A(je,{label:"数据类型",width:"auto","min-width":"100",align:"center"},{default:T((e=>[D(z(N(Pe).typeNames["t"+e.row.type]),1)])),_:1}),A(je,{label:"小数位数",width:"auto","min-width":"80",align:"center"},{default:T((e=>[D(z(void 0===e.row.decimals||""===e.row.decimals?0:e.row.decimals),1)])),_:1}),A(je,{prop:"unit",label:"单位",width:"auto","min-width":"80",align:"center"}),A(je,{label:"操作",width:"auto","min-width":"150",align:"center",fixed:"right"},{default:T((e=>[A(F,{onClick:a=>Ee(e.row),text:"",type:"primary"},{default:T((()=>[se])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","cell-style","header-cell-style","max-height"]),L("div",de,[A(Ye,{"current-page":N(Pe).currentPage,"page-size":N(Pe).pagesize,"page-sizes":[20,50,200,500],total:N(Te).length,onCurrentChange:Ne,onSizeChange:ze,background:"",layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"46px"}},null,8,["current-page","page-size","total"])])],512),A(aa,{modelValue:N(Pe).pFlag,"onUpdate:modelValue":g[21]||(g[21]=e=>N(Pe).pFlag=e),title:N(Pe).pTitle,width:"600px","before-close":Ke,"close-on-click-modal":!1},{footer:T((()=>[L("span",ce,[A(F,{onClick:g[19]||(g[19]=e=>Je())},{default:T((()=>[ue])),_:1}),A(F,{type:"primary",onClick:g[20]||(g[20]=e=>{We.value.validate((e=>{if(console.log("valid",e),!e)return!1;{let e={};e.name=Pe.propertyForm.name,e.label=Pe.propertyForm.label,e.uploadName=Pe.propertyForm.uploadName,e.type=Pe.propertyForm.type,e.decimals=Pe.propertyForm.decimals,e.unit=Pe.propertyForm.unit;let a={};3!==Pe.propertyForm.type?(a.min=Pe.propertyForm.min,a.max=Pe.propertyForm.max,a.minMaxAlarm=Pe.propertyForm.minMaxAlarm,a.step=Pe.propertyForm.step,a.stepAlarm=Pe.propertyForm.stepAlarm):(a.dataLength=Pe.propertyForm.dataLength,a.dataLengthAlarm=Pe.propertyForm.dataLengthAlarm),e.params=a,console.log("submitPorpertyForm -> property",e);const l={token:B.token,data:{name:H.curTransferModel.name,property:e}};Pe.pTitle.includes("添加")?(console.log("添加属性"),x.addProperty(l).then((e=>{Ge(e,Le),Je()}))):(console.log("编辑属性"),x.editProperty(l).then((e=>{Ge(e,Le),Je()})))}}))})},{default:T((()=>[fe])),_:1})])])),default:T((()=>[L("div",me,[A(C,{model:N(Pe).propertyForm,rules:N(Pe).propertyRules,ref_key:"propertyFormRef",ref:We,"status-icon":"","label-position":"right","label-width":"120px"},{default:T((()=>[A(w,{label:"属性名称",prop:"name"},{default:T((()=>[A(k,{disabled:N(Pe).pTitle.includes("编辑"),type:"text",modelValue:N(Pe).propertyForm.name,"onUpdate:modelValue":g[6]||(g[6]=e=>N(Pe).propertyForm.name=e),autocomplete:"off",placeholder:"请输入属性名称"},null,8,["disabled","modelValue"])])),_:1}),A(w,{label:"属性标签",prop:"label"},{default:T((()=>[A(k,{type:"text",modelValue:N(Pe).propertyForm.label,"onUpdate:modelValue":g[7]||(g[7]=e=>N(Pe).propertyForm.label=e),autocomplete:"off",placeholder:"请输入属性标签"},null,8,["modelValue"])])),_:1}),A(w,{label:"上报属性名称",prop:"uploadName"},{default:T((()=>[A(k,{type:"text",modelValue:N(Pe).propertyForm.uploadName,"onUpdate:modelValue":g[8]||(g[8]=e=>N(Pe).propertyForm.uploadName=e),autocomplete:"off",placeholder:"请输入上报属性名称"},null,8,["modelValue"])])),_:1}),A(w,{label:"数据类型",prop:"type"},{default:T((()=>[A($e,{modelValue:N(Pe).propertyForm.type,"onUpdate:modelValue":g[9]||(g[9]=e=>N(Pe).propertyForm.type=e),modelModifiers:{number:!0},style:{width:"100%"},placeholder:"请选择数据类型"},{default:T((()=>[(P(!0),M(j,null,U(N(Pe).typeOptions,(e=>(P(),S(Ze,{key:"type_"+e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),3!==N(Pe).propertyForm.type?(P(),S(w,{key:0,label:"范围报警",prop:"minMaxAlarm"},{default:T((()=>[A(ea,{modelValue:N(Pe).propertyForm.minMaxAlarm,"onUpdate:modelValue":g[10]||(g[10]=e=>N(Pe).propertyForm.minMaxAlarm=e),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])])),_:1})):R("",!0),3!==N(Pe).propertyForm.type&&N(Pe).propertyForm.minMaxAlarm?(P(),S(w,{key:1,label:"最小值",prop:"min"},{default:T((()=>[A(k,{type:"text",modelValue:N(Pe).propertyForm.min,"onUpdate:modelValue":g[11]||(g[11]=e=>N(Pe).propertyForm.min=e),autocomplete:"off",placeholder:"请输入最小值"},null,8,["modelValue"])])),_:1})):R("",!0),3!==N(Pe).propertyForm.type&&N(Pe).propertyForm.minMaxAlarm?(P(),S(w,{key:2,label:"最大值",prop:"max"},{default:T((()=>[A(k,{type:"text",modelValue:N(Pe).propertyForm.max,"onUpdate:modelValue":g[12]||(g[12]=e=>N(Pe).propertyForm.max=e),autocomplete:"off",placeholder:"请输入最大值"},null,8,["modelValue"])])),_:1})):R("",!0),3!==N(Pe).propertyForm.type?(P(),S(w,{key:3,label:"布长报警",prop:"stepAlarm"},{default:T((()=>[A(ea,{modelValue:N(Pe).propertyForm.stepAlarm,"onUpdate:modelValue":g[13]||(g[13]=e=>N(Pe).propertyForm.stepAlarm=e),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])])),_:1})):R("",!0),3!==N(Pe).propertyForm.type&&N(Pe).propertyForm.stepAlarm?(P(),S(w,{key:4,label:"布长",prop:"step"},{default:T((()=>[A(k,{type:"text",modelValue:N(Pe).propertyForm.step,"onUpdate:modelValue":g[14]||(g[14]=e=>N(Pe).propertyForm.step=e),autocomplete:"off",placeholder:"请输入布长"},null,8,["modelValue"])])),_:1})):R("",!0),2===N(Pe).propertyForm.type?(P(),S(w,{key:5,label:"小数位数",prop:"decimals"},{default:T((()=>[A(k,{type:"text",modelValue:N(Pe).propertyForm.decimals,"onUpdate:modelValue":g[15]||(g[15]=e=>N(Pe).propertyForm.decimals=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入小数位数"},null,8,["modelValue"])])),_:1})):R("",!0),3!==N(Pe).propertyForm.type?(P(),S(w,{key:6,label:"单位",prop:"unit"},{default:T((()=>[A(k,{type:"text",modelValue:N(Pe).propertyForm.unit,"onUpdate:modelValue":g[16]||(g[16]=e=>N(Pe).propertyForm.unit=e),autocomplete:"off",placeholder:"请输入单位"},null,8,["modelValue"])])),_:1})):R("",!0),3===N(Pe).propertyForm.type?(P(),S(w,{key:7,label:"字符串长度报警",prop:"dataLengthAlarm"},{default:T((()=>[A(ea,{modelValue:N(Pe).propertyForm.dataLengthAlarm,"onUpdate:modelValue":g[17]||(g[17]=e=>N(Pe).propertyForm.dataLengthAlarm=e),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])])),_:1})):R("",!0),3===N(Pe).propertyForm.type&&N(Pe).propertyForm.dataLengthAlarm?(P(),S(w,{key:8,label:"字符串长度",prop:"dataLength"},{default:T((()=>[A(k,{type:"text",modelValue:N(Pe).propertyForm.dataLength,"onUpdate:modelValue":g[18]||(g[18]=e=>N(Pe).propertyForm.dataLength=e),autocomplete:"off",placeholder:"请输入字符串长度"},null,8,["modelValue"])])),_:1})):R("",!0)])),_:1},8,["model","rules"])])])),_:1},8,["modelValue","title"]),A(aa,{modelValue:N(Pe).psFlag,"onUpdate:modelValue":g[22]||(g[22]=e=>N(Pe).psFlag=e),title:"导入属性",width:"600px","before-close":a.beforeCloseUploadProperty,"close-on-click-modal":!1},{footer:T((()=>[L("span",he,[A(F,{onClick:a.cancelUploadProperty},{default:T((()=>[be])),_:1},8,["onClick"]),A(F,{type:"primary",onClick:a.submitUploadProperty},{default:T((()=>[xe])),_:1},8,["onClick"])])])),default:T((()=>[A(la,{ref:"uploadPropertyRef",action:"","auto-upload":!1,"http-request":a.myRequestProperty,limit:1,"on-exceed":a.handleExceedProperty,"before-upload":a.beforeUploadProperty},{tip:T((()=>[ge])),default:T((()=>[A(F,{type:"primary"},{default:T((()=>[ye])),_:1})])),_:1},8,["http-request","on-exceed","before-upload"])])),_:1},8,["modelValue","before-close"]),A(aa,{title:"同步采集属性",modelValue:N(Pe).plFlag,"onUpdate:modelValue":g[26]||(g[26]=e=>N(Pe).plFlag=e),width:"1000px","before-close":Be,"close-on-click-modal":!1},{footer:T((()=>[L("span",Ce,[A(F,{onClick:Oe},{default:T((()=>[ke])),_:1}),A(F,{type:"primary",onClick:He},{default:T((()=>[Ve])),_:1})])])),default:T((()=>[L("div",Fe,[L("div",_e,[A($e,{modelValue:N(Pe).curCollName,"onUpdate:modelValue":g[23]||(g[23]=e=>N(Pe).curCollName=e),placeholder:"请选择采集模型",onChange:g[24]||(g[24]=e=>Se())},{default:T((()=>[(P(!0),M(j,null,U(N(Pe).collDeviceModelList,(e=>(P(),S(Ze,{key:e.name,label:e.label,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),A(k,{placeholder:"请输入属性名称或者标签",style:{width:"200px"},clearable:"",modelValue:N(Pe).pName,"onUpdate:modelValue":g[25]||(g[25]=e=>N(Pe).pName=e)},{prefix:T((()=>[A(h,{class:"el-input__icon"},{default:T((()=>[A(N(v))])),_:1})])),_:1},8,["modelValue"])]),L("div",ve,[A(Xe,{data:N(Pe).pTableData.filter((e=>!N(Pe).pName||e.name.includes(N(Pe).pName)||e.label.includes(N(Pe).pName))).slice((N(Pe).pCurrentPage-1)*N(Pe).pPagesize,N(Pe).pCurrentPage*N(Pe).pPagesize),"header-cell-style":N(Pe).pHeadStyle,"cell-style":N(Pe).pCellStyle,style:{border:"1px solid #c0c4cc"},"max-height":"290",onSelectionChange:Ue,stripe:""},{default:T((()=>[A(je,{type:"selection",width:"60",selectable:qe}),A(je,{prop:"name",label:"属性名称","min-width":"200",width:"auto",align:"center"}),A(je,{prop:"label",label:"属性标签","min-width":"200",width:"auto",align:"center"}),A(je,{label:"状态","min-width":"120",width:"auto",align:"center"},{default:T((e=>[L("span",{style:I({color:N(Pe).AllPropertyNameList.includes(e.row.name)?N(b).successColor:N(b).dangerColor})},z(N(Pe).AllPropertyNameList.includes(e.row.name)?"已选择":"未选择"),5)])),_:1})])),_:1},8,["data","header-cell-style","cell-style"]),L("div",we,[A(Ye,{"current-page":N(Pe).pCurrentPage,"page-size":N(Pe).pPagesize,"page-sizes":[5,20,50,200],total:N(Pe).pTableData.length,onCurrentChange:Re,onSizeChange:Ie,background:"",layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"22px"}},null,8,["current-page","page-size","total"])])])])])),_:1},8,["modelValue"])])])}}},[["__scopeId","data-v-194ab7a4"]]);const Me=e=>(q("data-v-4dc3b08a"),e=e(),H(),e),Le={class:"main-container"},Ae={key:0,class:"main"},Te={class:"search-bar"},Ne=D(" 刷新 "),ze={class:"tool-bar"},je=D(" 添加 "),Ue=D("变量详情"),De=D("编辑"),Se=D("删除"),Re=Me((()=>L("div",null,"无数据",-1))),Ie={class:"pagination"},qe={class:"dialog-content"},He={class:"dialog-footer"},Oe=D("取消"),Be=D("保存");var Ee=g({setup(a){const u=h(),y=C(null),g=w({headerCellStyle:{background:b.primaryColor,color:b.fontWhiteColor,height:"54px"},cellStyle:{height:"48px"},tableMaxHeight:0,currentPage:1,pagesize:10,transferName:"",transferTableData:[{name:"测试01",label:"测试01"}],isModel:!0,curTransferModel:null,tFlag:!1,tTitle:"添加上报模型",transferForm:{name:"",label:"",code:""},transferRules:{name:[{required:!0,message:"上报模型名称不能为空",trigger:"blur"}],label:[{required:!0,message:"上报模型标签不能为空",trigger:"blur"}],code:[{required:!0,message:"上报模型编号不能为空",trigger:"blur"}]},collectOptions:[]}),_=a=>{const l={token:u.token,data:{}};x.getModelList(l).then((async l=>{console.log("getModelList -> res",l),l&&("0"===l.code?(g.transferTableData=l.data,1===a&&e({type:"success",message:"刷新成功！"})):J(l),await O((()=>{g.tableMaxHeight=y.value.clientHeight-34-36-22})))}))};_();(()=>{const e={token:u.token,data:{}};F.getDeviceModelList(e).then((e=>{e&&("0"===e.code?g.collectOptions=e.data:J(e))}))})();const z=e=>{g.currentPage=e},D=e=>{g.pagesize=e},R=k((()=>g.transferTableData.filter((e=>!g.transferModelName||e.name.toLowerCase().includes(g.transferModelName.toLowerCase()))).slice((g.currentPage-1)*g.pagesize,g.currentPage*g.pagesize))),I=k((()=>g.transferTableData.filter((e=>!g.transferModelName||e.name.toLowerCase().includes(g.transferModelName.toLowerCase()))))),q=()=>{g.transferForm={name:"",label:"",code:""},g.tTitle="添加上报模型",g.tFlag=!0},H=e=>{g.tTitle="编辑上报模型",g.tFlag=!0,g.transferForm.name=e.name,g.transferForm.label=e.label,g.transferForm.code=e.code},B=C(null),E=()=>{g.tFlag=!1},W=()=>{E()},J=a=>{e({type:"error",message:a.message})},K=(a,l)=>{e({type:"0"===a.code?"success":"error",message:a.message}),"0"===a.code&&l&&l()};return(a,h)=>{const b=t,F=n,w=r,C=V("Icon"),k=o,O=p,J=s,Q=i,X=d,Y=m,G=c,Z=f;return P(),M("div",Le,[N(g).isModel?(P(),M("div",Ae,[L("div",Te,[A(O,{inline:!0,ref:"searchFormRef","status-icon":"","label-width":"120px"},{default:T((()=>[A(w,{label:"上报模型名称"},{default:T((()=>[A(F,{style:{width:"200px"},placeholder:"请输入上报模型名称",clearable:"",modelValue:N(g).transferModelName,"onUpdate:modelValue":h[0]||(h[0]=e=>N(g).transferModelName=e)},{prefix:T((()=>[A(b,{class:"el-input__icon"},{default:T((()=>[A(N(v))])),_:1})])),_:1},8,["modelValue"])])),_:1}),A(w,null,{default:T((()=>[A(k,{style:{color:"#fff","margin-left":"20px"},color:"#2EA554",class:"right-btn",onClick:h[1]||(h[1]=e=>{_(1)})},{default:T((()=>[A(b,{class:"btn-icon"},{default:T((()=>[A(C,{name:"local-refresh",size:"14px",color:"#ffffff"})])),_:1}),Ne])),_:1})])),_:1})])),_:1},512)]),L("div",ze,[A(k,{type:"primary",bg:"",class:"right-btn",onClick:h[2]||(h[2]=e=>q())},{default:T((()=>[A(b,{class:"btn-icon"},{default:T((()=>[A(C,{name:"local-add",size:"14px",color:"#ffffff"})])),_:1}),je])),_:1})]),L("div",{class:"content",ref_key:"contentRef",ref:y},[A(Q,{data:N(R),"cell-style":N(g).cellStyle,"header-cell-style":N(g).headerCellStyle,"max-height":N(g).tableMaxHeight,style:{width:"100%"},stripe:"",onRowDblclick:H},{empty:T((()=>[Re])),default:T((()=>[A(J,{prop:"name",label:"上报模型名称",width:"auto","min-width":"200",align:"center"}),A(J,{prop:"label",label:"上报模型标签",width:"auto","min-width":"200",align:"center"}),A(J,{prop:"code",label:"上报模型编号",width:"auto","min-width":"200",align:"center"}),A(J,{label:"操作",width:"auto","min-width":"200",align:"center",fixed:"right"},{default:T((a=>[A(k,{onClick:e=>{return l=a.row,g.curTransferModel=l,void(g.isModel=!1);var l},text:"",type:"success"},{default:T((()=>[Ue])),_:2},1032,["onClick"]),A(k,{onClick:e=>H(a.row),text:"",type:"primary"},{default:T((()=>[De])),_:2},1032,["onClick"]),A(k,{onClick:t=>{return o=a.row,void l.confirm("确定要删除这个上报模型吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e={token:u.token,data:{name:o.name}};x.deleteModel(e).then((e=>{K(e,_)}))})).catch((()=>{e({type:"info",message:"取消删除"})}));var o},text:"",type:"danger"},{default:T((()=>[Se])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","cell-style","header-cell-style","max-height"]),L("div",Ie,[A(X,{"current-page":N(g).currentPage,"page-size":N(g).pagesize,"page-sizes":[5,10,20,50],total:N(I).length,onCurrentChange:z,onSizeChange:D,background:"",layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"46px"}},null,8,["current-page","page-size","total"])])],512)])):(P(),S(Pe,{key:1,curTransferModel:N(g).curTransferModel,onChangeTmFlag:h[3]||(h[3]=e=>{g.isModel=!0}),style:{width:"100%",height:"100%",overflow:"hidden"}},null,8,["curTransferModel"])),A(Z,{modelValue:N(g).tFlag,"onUpdate:modelValue":h[9]||(h[9]=e=>N(g).tFlag=e),title:N(g).tTitle,width:"600px","before-close":W,"close-on-click-modal":!1},{footer:T((()=>[L("span",He,[A(k,{onClick:h[7]||(h[7]=e=>E())},{default:T((()=>[Oe])),_:1}),A(k,{type:"primary",onClick:h[8]||(h[8]=e=>{B.value.validate((e=>{if(!e)return!1;{const e={token:u.token,data:g.transferForm};g.tTitle.includes("添加")?x.addModel(e).then((e=>{K(e,_),E()})):x.editModel(e).then((e=>{K(e,_),E()}))}}))})},{default:T((()=>[Be])),_:1})])])),default:T((()=>[L("div",qe,[A(O,{model:N(g).transferForm,rules:N(g).transferRules,ref_key:"transferFormRef",ref:B,"status-icon":"","label-position":"right","label-width":"120px"},{default:T((()=>[A(w,{label:"上报模型名称",prop:"name"},{default:T((()=>[A(G,{modelValue:N(g).transferForm.name,"onUpdate:modelValue":h[4]||(h[4]=e=>N(g).transferForm.name=e),filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择或者输入上报模型名称",style:{width:"100%"}},{default:T((()=>[(P(!0),M(j,null,U(N(g).collectOptions,(e=>(P(),S(Y,{key:e.name,label:e.name,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),A(w,{label:"上报模型标签",prop:"label"},{default:T((()=>[A(G,{modelValue:N(g).transferForm.label,"onUpdate:modelValue":h[5]||(h[5]=e=>N(g).transferForm.label=e),filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择或者输入上报模型标签",style:{width:"100%"}},{default:T((()=>[(P(!0),M(j,null,U(N(g).collectOptions,(e=>(P(),S(Y,{key:e.label,label:e.label,value:e.label},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),A(w,{label:"上报模型编号",prop:"code"},{default:T((()=>[A(F,{type:"text",modelValue:N(g).transferForm.code,"onUpdate:modelValue":h[6]||(h[6]=e=>N(g).transferForm.code=e),autocomplete:"off",placeholder:"请输入上报模型编号"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-4dc3b08a"]]);export{Ee as default};
