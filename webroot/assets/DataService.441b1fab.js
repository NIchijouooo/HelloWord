import{P as e,g as a,L as l,e as t,p as o,n as r,o as d,m as i,A as n,C as c,D as s,u as p,x as u,y as m,q as g,v as f,w as y,M as v,K as b,N as h}from"./element-plus.64650d13.js";import{Y as w,f as F,p as _,h as C,X as N,o as k,c as V,a as T,S,Q as x,u as D,U as R,a0 as M,M as I,af as L,O as A,P as U,L as P,at as B,au as j,H as z,J as q,K as G}from"./@vue.5db09832.js";import{_ as K,u as O,v as E}from"./index.98f42e56.js";import{S as Q}from"./service.19c72ecc.js";import{u as H}from"./vue-router.d969f71f.js";import{I as J}from"./interface.c4e57716.js";import{T as Y}from"./transferModel.d21ca768.js";import{I as $,L as X,M as Z,J as W}from"./@element-plus.aa3ef65f.js";import{D as ee}from"./deviceModel.a85a7758.js";import{P as ae}from"./product.c02b75e9.js";import"./@vueuse.af8df401.js";import"./dayjs.b9b14681.js";import"./axios.765908e4.js";import"./lodash-es.8ca9079f.js";import"./async-validator.ed4c92a2.js";import"./@ctrl.82a509e0.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.1c4ac15a.js";import"./pinia.69c74452.js";import"./vue-demi.b3a9cad9.js";import"./screenfull.258ac312.js";import"./vue-echarts.8f00425b.js";import"./resize-detector.4e96b72b.js";import"./echarts.62a08783.js";import"./zrender.56caf4f2.js";import"./tslib.60310f1a.js";import"./nprogress.aae2b787.js";const le=e=>(B("data-v-745ebf78"),e=e(),j(),e),te={class:"main-container"},oe={class:"main"},re={class:"search-bar"},de=M(" 返回上报服务 "),ie=M(" 导入设备 "),ne=M(" 导出设备 "),ce={class:"search-bar",style:{display:"flex"}},se={class:"title",style:{position:"relative","margin-right":"40px",height:"40px",padding:"0px 0","justify-content":"flex-start"}},pe={class:"tName"},ue=M(" 主动上报 "),me=M(" 添加 "),ge=M(" 删除 "),fe=M(" 刷新 "),ye=M("编辑"),ve=le((()=>T("div",null,"无数据",-1))),be={class:"pagination"},he={class:"dialog-content"},we={class:"dialog-cLeft"},Fe=le((()=>T("div",{class:"card-header"},[T("span",null,"请选择采集设备")],-1))),_e={class:"card-main"},Ce={class:"dialog-cRight"},Ne=le((()=>T("div",{class:"card-header"},[T("span",null,"请选择一个上报模型")],-1))),ke={class:"card-main"},Ve={class:"upload-item-text"},Te={class:"dialog-footer"},Se=M("取消"),xe=M("添加"),De={class:"dialog-content"},Re={class:"dialog-footer"},Me=M("取消"),Ie=M("保存"),Le=M("选择文件"),Ae=le((()=>T("div",{class:"el-upload__tip"},"只能上传一个文件，只支持xlsx格式文件！",-1))),Ue={class:"dialog-footer"},Pe=M("取消"),Be=M("上传");var je=K({props:{curGateway:{type:Object,default:{}},pageInfo:String},emits:["changeDnFlag","update:pageInfo"],setup(b,{expose:h,emit:B}){const j=b,q=O();console.log("id -> props",j);const G=w({isBackBtn:"",headerCellStyle:{background:E.primaryColor,color:E.fontWhiteColor,height:"54px"},cellStyle:{height:"48px"},tableMaxHeight:0,currentPage:1,pagesize:20,nodeTableData:[],dFlag:!1,dTitle:"添加设备",nodeInfo:"",nodeForm:{serviceName:"",collInterfaceName:"",deviceName:"",uploadModel:"",deviceAddr:"",protocol:"",deviceCode:"",productKey:"",deviceID:"",deviceSecret:""},nodeRules:{serviceName:[{required:!0,trigger:"blur"}],collInterfaceName:[{required:!0,trigger:"blur"}],deviceName:[{required:!0,trigger:"blur"}],deviceAddr:[{required:!0,trigger:"blur"}],protocol:[{required:!0,trigger:"blur"}],uploadModel:[{required:!0,message:"上报模型不能为空",trigger:"blur"}],deviceCode:[{required:!0,message:"通讯编码不能为空",trigger:"blur"}],productKey:[{required:!0,message:"产品密钥不能为空",trigger:"blur"}],deviceID:[{required:!0,message:"产品密钥不能为空",trigger:"blur"}],deviceSecret:[{required:!0,message:"产品密钥不能为空",trigger:"blur"}]},nodeModelList:[],selectedNodes:[],dpFlag:!0,interfaceList:[],nFlag:!1,treeProps:{children:"children",label:"label",isLeaf:"leaf"},deviceList:[],interfaceNames:[],uFlag:!1,filterText:"",transferModelList:[],curModelName:""}),K=e=>{const l={token:q.token,data:{serviceName:j.curGateway.serviceName}};Q.getDeviceByServiceIdList(l).then((async l=>{console.log("getDeviceByServiceIdList -> res ",l),l&&("0"===l.code?(G.nodeTableData=l.data,1===e&&a({type:"success",message:"刷新成功！"})):ta(l),await z((()=>{G.tableMaxHeight=H.value.clientHeight-34-36-132})))}))};K();const H=F(null);(()=>{const e={token:q.token,data:{}};J.getInterfaceList(e).then((e=>{console.log("getInterfaceList -> res",e),"0"===e.code?(G.interfaceList=[],G.interfaceNames=[],e.data.forEach((e=>{const a={label:e.collInterfaceName,name:e.collInterfaceName,hasChildren:!0};G.interfaceList.push(a),G.interfaceNames.push(e.collInterfaceName)}))):ta(e)}))})();const ee=e=>{G.selectedNodes=e},ae=e=>{G.currentPage=e},le=_((()=>{let e=G.nodeInfo;return G.nodeTableData.filter((a=>!e||a.deviceName.toLowerCase().includes(e.toLowerCase())||a.deviceAddr.toLowerCase().includes(e.toLowerCase()))).slice((G.currentPage-1)*G.pagesize,G.currentPage*G.pagesize)})),je=_((()=>{let e=G.nodeInfo;return G.nodeTableData.filter((a=>!e||a.deviceName.toLowerCase().includes(e.toLowerCase())||a.deviceAddr.toLowerCase().includes(e.toLowerCase())))})),ze=e=>{G.pagesize=e},qe=(e,a)=>(console.log("loadNode-> node === ",e),0===e.level?a(G.interfaceList):1!==e.level?a([]):(console.log("node->",e),void Ge(e.data.name).then((async l=>(console.log("getCollDevices -> res",l),"0"===l.code?(G.deviceList=[],l.data.deviceNodeMap&&l.data.deviceNodeMap.forEach((a=>{const l={label:a.label,name:a.name,addr:a.addr,collName:e.data.name,hasChildren:!1};G.deviceList.push(l)})),console.log("node->ctxData.deviceList",G.deviceList),a(G.deviceList)):(ta(l),a([]))))))),Ge=e=>{const a={token:q.token,data:{name:e}};return J.getCollDevices(a)};(e=>{const a={token:q.token,data:{}};Y.getModelList(a).then((e=>{console.log("getModelList -> res",e),"0"===e.code?G.transferModelList=e.data:ta(e)}))})();const Ke=F(null);C((()=>G.filterText),(e=>{Ke.value&&Ke.value.filter(e)}));const Oe=(e,a)=>(console.log("filterNode value",e),!e||a.label.includes(e)),Ee=()=>{G.nFlag=!1},Qe=e=>{G.dFlag=!0,G.dTitle="编辑设备",G.nodeForm={serviceName:e.serviceName,collInterfaceName:e.collInterfaceName,deviceName:e.deviceName,deviceLabel:e.deviceLabel,uploadModel:e.uploadModel,deviceAddr:e.deviceAddr,protocol:e.protocol,deviceCode:""===e.param.deviceCode?e.deviceAddr:e.param.deviceCode},G.nodeForm.productKey=e.param.ProductKey,G.nodeForm.deviceID=e.param.DeviceID,G.nodeForm.deviceSecret=e.param.DeviceSecret},He=F(null),Je=()=>{G.dFlag=!1,He.value.resetFields()},Ye=e=>{Je()},$e=()=>{Ze.value&&Ze.value.submit()},Xe=e=>{},Ze=F(null),We=e=>{Ze.value.clearFiles();const a=e[0];Ze.value.handleStart(a)},ea=e=>{console.log("beforeUpload -> file",e);let l=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type)||""!=e.name&&e.name.indexOf("xlsx")>-1;if(l){if(l){let l=new FormData;l.append("file",e);const t={token:q.token,contentType:"multipart/form-data",data:l};Q.addDeviceFromCSV(t).then((e=>{"0"===e.code?(a.success(e.message),G.uFlag=!1,K()):ta(e)}))}}else a({type:"error",message:"文件格式不正确,必须是xlsx文件！"})},aa=()=>{G.uFlag=!1,Ze.value.clearFiles()},la=()=>{aa()},ta=e=>{a({type:"error",message:e.message})},oa=()=>{const e={token:q.token,responseType:"blob",data:{serviceName:j.curGateway.serviceName}};Q.exportDevice(e).then((e=>{if(console.log("exportDevice -> res",e),e&&"1"===e.code)return void ta(e);const a=new Blob([e.blob]),l=e.fileName,t=document.createElement("a");t.download=l,t.style.display="none",t.href=URL.createObjectURL(a),document.body.appendChild(t),t.click(),URL.revokeObjectURL(t.href),document.body.removeChild(t)}))},ra=(e,l)=>{a({type:"0"===e.code?"success":"error",message:e.message}),"0"===e.code&&l&&l()};return h({ctxData:G}),(b,h)=>{const w=t,F=o,_=r,C=d,z=i,O=N("Icon"),E=n,J=c,Ge=s,da=e,ia=p,na=u,ca=m,sa=g,pa=f,ua=y,ma=v;return k(),V("div",te,[T("div",oe,[T("div",re,[S(C,{inline:!0,ref:"searchFormRef","status-icon":"","label-width":"120px"},{default:x((()=>[S(_,{style:{"margin-left":"20px"}},{default:x((()=>[S(F,{type:"primary",plain:"",onClick:h[0]||(h[0]=e=>(B("changeDnFlag"),void(G.isBackBtn="back"))),style:{"margin-right":"20px"}},{default:x((()=>[S(w,{class:"el-input__icon"},{default:x((()=>[S(D($))])),_:1}),de])),_:1})])),_:1}),S(_,null,{default:x((()=>[S(F,{type:"primary",plain:"",class:"right-btn",onClick:h[1]||(h[1]=e=>{G.uFlag=!0})},{default:x((()=>[S(w,{class:"el-input__icon"},{default:x((()=>[S(D(X))])),_:1}),ie])),_:1})])),_:1}),S(_,null,{default:x((()=>[S(F,{type:"primary",plain:"",class:"right-btn",onClick:oa},{default:x((()=>[S(w,{class:"el-input__icon"},{default:x((()=>[S(D(Z))])),_:1}),ne])),_:1})])),_:1})])),_:1},512)]),T("div",ce,[T("div",se,[T("div",pe,R(j.curGateway.serviceName),1)]),S(C,{inline:!0,ref:"searchFormRef2","status-icon":"","label-width":"90px"},{default:x((()=>[S(_,{label:""},{default:x((()=>[S(z,{style:{width:"200px"},placeholder:"请输入 地址/名称 过滤",clearable:"",modelValue:D(G).nodeInfo,"onUpdate:modelValue":h[2]||(h[2]=e=>D(G).nodeInfo=e)},{prefix:x((()=>[S(w,{class:"el-input__icon"},{default:x((()=>[S(D(W))])),_:1})])),_:1},8,["modelValue"])])),_:1}),S(_,null,{default:x((()=>[S(F,{type:"primary",bg:"",class:"right-btn",onClick:h[3]||(h[3]=e=>(()=>{let e=[];if(0===G.selectedNodes.length)return void a.info("请至少选择一个设备！");G.selectedNodes.forEach((a=>{e.push(a.deviceName)}));const l={token:q.token,data:{serviceName:j.curGateway.serviceName,deviceNames:e}};Y.reportNodes(l).then((e=>{"0"===e.code?a.success(e.message):ta(e)}))})())},{default:x((()=>[S(w,{class:"btn-icon"},{default:x((()=>[S(O,{name:"local-report",size:"14px",color:"#ffffff"})])),_:1}),ue])),_:1})])),_:1}),S(_,null,{default:x((()=>[S(F,{type:"primary",bg:"",class:"right-btn",onClick:h[4]||(h[4]=e=>{G.nFlag=!0})},{default:x((()=>[S(w,{class:"btn-icon"},{default:x((()=>[S(O,{name:"local-add",size:"14px",color:"#ffffff"})])),_:1}),me])),_:1})])),_:1}),S(_,null,{default:x((()=>[S(F,{type:"danger",bg:"",class:"right-btn",onClick:h[5]||(h[5]=e=>(()=>{let e=[];0!==G.selectedNodes.length?(G.selectedNodes.forEach((a=>{e.push(a.deviceName)})),console.log("dList",e),l.confirm("确定要删除这些吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const a={token:q.token,data:{serviceName:j.curGateway.serviceName,deviceNames:e}};Q.deleteDevice(a).then((e=>{ra(e,K)}))})).catch((()=>{a({type:"info",message:"取消删除"})}))):a.info("请至少选择一个设备！")})())},{default:x((()=>[S(w,{class:"btn-icon"},{default:x((()=>[S(O,{name:"local-delete",size:"14px",color:"#ffffff"})])),_:1}),ge])),_:1})])),_:1}),S(_,null,{default:x((()=>[S(F,{style:{color:"#fff"},color:"#2EA554",class:"right-btn",onClick:h[6]||(h[6]=e=>{K(1)})},{default:x((()=>[S(w,{class:"btn-icon"},{default:x((()=>[S(O,{name:"local-refresh",size:"14px",color:"#ffffff"})])),_:1}),fe])),_:1})])),_:1})])),_:1},512)]),T("div",{class:"content",ref_key:"contentRef",ref:H,style:{top:"136px"}},[S(J,{data:D(le),"cell-style":D(G).cellStyle,"header-cell-style":D(G).headerCellStyle,"max-height":D(G).tableMaxHeight,style:{width:"100%"},stripe:"",onSelectionChange:ee,onRowDblclick:Qe},{empty:x((()=>[ve])),default:x((()=>[S(E,{type:"selection",width:"55"}),S(E,{prop:"deviceName",label:"设备名称",width:"auto","min-width":"180",align:"center"}),S(E,{prop:"deviceLabel",label:"设备标签",width:"auto","min-width":"180",align:"center"}),S(E,{prop:"deviceAddr",label:"通讯地址",width:"auto","min-width":"150",align:"center"}),S(E,{prop:"uploadModel",label:"上报模型",width:"auto","min-width":"150",align:"center"}),S(E,{prop:"collInterfaceName",label:"采集接口名称",width:"auto","min-width":"150",align:"center"}),S(E,{label:"上报状态",width:"auto","min-width":"100",align:"center"},{default:x((e=>[M(R("onLine"===e.row.reportStatus?"在线":"离线"),1)])),_:1}),S(E,{label:"上报参数",width:"auto","min-width":"180",align:"center"},{default:x((e=>[M(R(e.row.param),1)])),_:1}),S(E,{label:"操作",width:"auto","min-width":"120",align:"center",fixed:"right"},{default:x((e=>[S(F,{onClick:a=>Qe(e.row),text:"",type:"primary"},{default:x((()=>[ye])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","cell-style","header-cell-style","max-height"]),T("div",be,[S(Ge,{"current-page":D(G).currentPage,"page-size":D(G).pagesize,"page-sizes":[20,50,200,500],total:D(je).length,onCurrentChange:ae,onSizeChange:ze,background:"",layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"46px"}},null,8,["current-page","page-size","total"])])],512)]),S(sa,{modelValue:D(G).nFlag,"onUpdate:modelValue":h[11]||(h[11]=e=>D(G).nFlag=e),title:"添加设备",width:"1000px"},{footer:x((()=>[T("span",Te,[S(F,{onClick:h[9]||(h[9]=e=>Ee())},{default:x((()=>[Se])),_:1}),S(F,{type:"primary",onClick:h[10]||(h[10]=e=>(()=>{var e=Ke.value.getCheckedNodes();if(e=e.filter((e=>!e.hasChildren)),console.log("checkedNodes => ",e),console.log("props.curGateway => ",j.curGateway),0!==e.length){let l=0,t=0;e.forEach((o=>{if(o.collName){const r={token:q.token,data:{serviceName:j.curGateway.serviceName,collInterfaceName:o.collName,deviceName:o.name,deviceLabel:o.label,deviceAddr:o.addr,protocol:j.curGateway.protocol,uploadModel:G.curModelName,param:{}}};console.log("pData item -> ",o),console.log("pData",r),Q.addDevice(r).then((o=>{l++,console.log("addDevice -> res ",o),"0"!==o.code?ta(o):t++,l===e.length&&(a.success("添加"+l+"个设备，成功"+t+"个，失败"+(l-t)+"个。"),K())}))}})),Ee()}else a.info("请至少选择一个节点！")})())},{default:x((()=>[xe])),_:1})])])),default:x((()=>[T("div",he,[T("div",we,[S(ia,{class:"card-box",shadow:"hover"},{header:x((()=>[Fe])),default:x((()=>[T("div",_e,[T("div",null,[S(z,{modelValue:D(G).filterText,"onUpdate:modelValue":h[7]||(h[7]=e=>D(G).filterText=e),placeholder:"节点名称过滤"},null,8,["modelValue"])]),S(da,{ref_key:"nodeTreeRef",ref:Ke,props:D(G).treeProps,load:qe,"filter-node-method":Oe,lazy:"","show-checkbox":""},null,8,["props"])])])),_:1})]),T("div",Ce,[S(ia,{class:"card-box",shadow:"hover"},{header:x((()=>[Ne])),default:x((()=>[T("div",ke,[S(ca,{modelValue:D(G).curModelName,"onUpdate:modelValue":h[8]||(h[8]=e=>D(G).curModelName=e),style:{width:"100%"}},{default:x((()=>[(k(!0),V(I,null,L(D(G).transferModelList,(e=>(k(),V("div",{class:A(["upload-item",{isClicked:e.isClicked}]),key:"tml"+e.name},[T("div",Ve,[S(na,{label:e.name},{default:x((()=>[M(R(e.label+" ("+e.name+")"),1)])),_:2},1032,["label"])])],2)))),128))])),_:1},8,["modelValue"])])])),_:1})])])])),_:1},8,["modelValue"]),S(sa,{modelValue:D(G).dFlag,"onUpdate:modelValue":h[24]||(h[24]=e=>D(G).dFlag=e),title:"编辑设备",width:"600px","before-close":Ye,"close-on-click-modal":!1},{footer:x((()=>[T("span",Re,[S(F,{onClick:h[22]||(h[22]=e=>Je())},{default:x((()=>[Me])),_:1}),S(F,{type:"primary",onClick:h[23]||(h[23]=e=>{He.value.validate((e=>{if(console.log("ctxData.nodeForm",G.nodeForm),!e)return!1;{const e={serviceName:G.nodeForm.serviceName,collInterfaceName:G.nodeForm.collInterfaceName,uploadModel:G.nodeForm.uploadModel,deviceName:G.nodeForm.deviceName,deviceLabel:G.nodeForm.deviceLabel,deviceAddr:G.nodeForm.deviceAddr,protocol:G.nodeForm.protocol,param:{deviceCode:G.nodeForm.deviceCode,productKey:G.nodeForm.productKey,deviceID:G.nodeForm.deviceID,deviceSecret:G.nodeForm.deviceSecret}},a={token:q.token,data:e};Q.editDevice(a).then((e=>{ra(e,K),Je()}))}}))})},{default:x((()=>[Ie])),_:1})])])),default:x((()=>[T("div",De,[S(C,{model:D(G).nodeForm,rules:D(G).nodeRules,ref_key:"nodeFormRef",ref:He,"status-icon":"","label-position":"right","label-width":"120px"},{default:x((()=>[S(_,{label:"服务名称",prop:"serviceName"},{default:x((()=>[S(z,{disabled:"",type:"text",modelValue:D(G).nodeForm.serviceName,"onUpdate:modelValue":h[12]||(h[12]=e=>D(G).nodeForm.serviceName=e),autocomplete:"off",placeholder:"请输入服务名称"},null,8,["modelValue"])])),_:1}),S(_,{label:"采集接口名称",prop:"collInterfaceName"},{default:x((()=>[S(z,{disabled:"",type:"text",modelValue:D(G).nodeForm.collInterfaceName,"onUpdate:modelValue":h[13]||(h[13]=e=>D(G).nodeForm.collInterfaceName=e),autocomplete:"off",placeholder:"请输入采集接口名称"},null,8,["modelValue"])])),_:1}),S(_,{label:"设备名称",prop:"deviceName"},{default:x((()=>[S(z,{disabled:"",type:"text",modelValue:D(G).nodeForm.deviceName,"onUpdate:modelValue":h[14]||(h[14]=e=>D(G).nodeForm.deviceName=e),autocomplete:"off",placeholder:"请输入设备名称"},null,8,["modelValue"])])),_:1}),S(_,{label:"设备地址",prop:"deviceAddr"},{default:x((()=>[S(z,{disabled:"",type:"text",modelValue:D(G).nodeForm.deviceAddr,"onUpdate:modelValue":h[15]||(h[15]=e=>D(G).nodeForm.deviceAddr=e),autocomplete:"off",placeholder:"请输入设备地址"},null,8,["modelValue"])])),_:1}),S(_,{label:"协议名称",prop:"protocol"},{default:x((()=>[S(z,{disabled:"",type:"text",modelValue:D(G).nodeForm.protocol,"onUpdate:modelValue":h[16]||(h[16]=e=>D(G).nodeForm.protocol=e),autocomplete:"off",placeholder:"请输入协议名称"},null,8,["modelValue"])])),_:1}),S(_,{label:"上报模型",prop:"uploadModel"},{default:x((()=>[S(ua,{modelValue:D(G).nodeForm.uploadModel,"onUpdate:modelValue":h[17]||(h[17]=e=>D(G).nodeForm.uploadModel=e),style:{width:"100%"},placeholder:"请选择上报模型"},{default:x((()=>[(k(!0),V(I,null,L(D(G).transferModelList,(e=>(k(),U(pa,{key:"model_"+e.name,label:e.label,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),"FSJY.MQTT"!=D(G).nodeForm.protocol?(k(),U(_,{key:0,label:"通讯编码",prop:"deviceCode"},{default:x((()=>[S(z,{type:"text",modelValue:D(G).nodeForm.deviceCode,"onUpdate:modelValue":h[18]||(h[18]=e=>D(G).nodeForm.deviceCode=e),autocomplete:"off",placeholder:"请输入通讯编码"},null,8,["modelValue"])])),_:1})):P("",!0),"FSJY.MQTT"==D(G).nodeForm.protocol?(k(),U(_,{key:1,label:"产品密钥",prop:"productKey"},{default:x((()=>[S(z,{type:"text",modelValue:D(G).nodeForm.productKey,"onUpdate:modelValue":h[19]||(h[19]=e=>D(G).nodeForm.productKey=e),autocomplete:"off",placeholder:"请输入网关产品密钥"},null,8,["modelValue"])])),_:1})):P("",!0),"FSJY.MQTT"==D(G).nodeForm.protocol?(k(),U(_,{key:2,label:"通讯地址",prop:"deviceID"},{default:x((()=>[S(z,{type:"text",modelValue:D(G).nodeForm.deviceID,"onUpdate:modelValue":h[20]||(h[20]=e=>D(G).nodeForm.deviceID=e),autocomplete:"off",placeholder:"请输入网关通讯地址"},null,8,["modelValue"])])),_:1})):P("",!0),"FSJY.MQTT"==D(G).nodeForm.protocol?(k(),U(_,{key:3,label:"设备密钥",prop:"deviceSecret"},{default:x((()=>[S(z,{type:"text",modelValue:D(G).nodeForm.deviceSecret,"onUpdate:modelValue":h[21]||(h[21]=e=>D(G).nodeForm.deviceSecret=e),autocomplete:"off",placeholder:"请输入网关设备密钥"},null,8,["modelValue"])])),_:1})):P("",!0)])),_:1},8,["model","rules"])])])),_:1},8,["modelValue"]),S(sa,{modelValue:D(G).uFlag,"onUpdate:modelValue":h[25]||(h[25]=e=>D(G).uFlag=e),title:"上传设备xlsx文件",width:"600px","before-close":la,"close-on-click-modal":!1},{footer:x((()=>[T("span",Ue,[S(F,{onClick:aa},{default:x((()=>[Pe])),_:1}),S(F,{type:"primary",onClick:$e},{default:x((()=>[Be])),_:1})])])),default:x((()=>[S(ma,{ref_key:"uploadRef",ref:Ze,action:"","auto-upload":!1,"http-request":Xe,limit:1,"on-exceed":We,"before-upload":ea},{tip:x((()=>[Ae])),default:x((()=>[S(F,{type:"primary"},{default:x((()=>[Le])),_:1})])),_:1},512)])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-745ebf78"]]);const ze=e=>(B("data-v-3312b1a3"),e=e(),j(),e),qe={class:"main-container"},Ge={class:"main"},Ke={class:"search-bar"},Oe=M(" 返回上报服务 "),Ee=M(" 导入寄存器 "),Qe=M(" 导出寄存器 "),He={class:"search-bar",style:{display:"flex"}},Je={class:"title",style:{position:"relative","margin-right":"40px","justify-content":"flex-start",padding:"0px 0px",height:"40px"}},Ye={class:"tName"},$e=M(" 主动上报 "),Xe=M(" 添加 "),Ze=M(" 删除 "),We=M(" 刷新 "),ea=M("编辑"),aa=ze((()=>T("div",null,"无数据",-1))),la={class:"pagination"},ta={class:"dialog-content"},oa={class:"dialog-footer"},ra=M("取消"),da=M("保存"),ia=M("选择文件"),na=ze((()=>T("div",{class:"el-upload__tip"},"只能上传一个文件，只支持xlsx格式文件！",-1))),ca={class:"dialog-footer"},sa=M("取消"),pa=M("上传");var ua=K({props:{curGateway:{type:Object,default:{}}},emits:["changeDnFlag"],setup(e,{emit:p}){const u=e,m=O();console.log("id -> props",u);const b=/^[0-9]*[1-9][0-9]*$/,h=(e,a,l)=>{0===a||b.test(a)?l():l(new Error("只能输入自然数！"))},C=w({headerCellStyle:{background:E.primaryColor,color:E.fontWhiteColor,height:"54px"},cellStyle:{height:"48px"},tableMaxHeight:0,currentPage:1,pagesize:20,regTableData:[],rFlag:!1,rTitle:"添加寄存器",regInfo:"",regForm:{serviceName:"",regName:"",label:"",propertyType:0,collName:"",nodeName:"",propertyName:"",regType:0,regAddr:0,regCnt:1,rule:"Int_AB"},regRules:{regName:[{required:!0,message:"寄存器名称不能为空！",trigger:"blur"}],label:[{required:!0,message:"寄存器标签不能为空！",trigger:"blur"}],collName:[{required:!0,message:"采集接口名称不能为空！",trigger:"blur"}],nodeName:[{required:!0,message:"设备名称不能为空！",trigger:"blur"}],propertyName:[{required:!0,message:"设备属性名称不能为空！",trigger:"blur"}],regAddr:[{required:!0,message:"寄存器地址不能为空！",trigger:"blur"},{validator:h,trigger:"blur"}],regCnt:[{required:!0,message:"寄存器数量不能为空！",trigger:"blur"},{validator:h,trigger:"blur"}],rule:[{required:!0,message:"解析规则不能为空！",trigger:"blur"}]},collOptions:[],nodeOptions:[],propertyOptions:[],nameTotsl:{},typeOptions:[{name:0,label:"设备属性"},{name:1,label:"系统属性"}],regTypeOptions:[{name:0,label:"线圈状态寄存器"},{name:1,label:"离散输入状态寄存器"},{name:2,label:"保持寄存器"},{name:3,label:"输入寄存器"}],regCntOptions:[{label:1,value:1},{label:2,value:2},{label:4,value:4}],ruleTypeOptions:{rt1:[{label:"Int_AB",value:"Int_AB"},{label:"Int_BA",value:"Int_BA"}],rt2:[{label:"Long_ABCD",value:"Long_ABCD"},{label:"Long_BADC",value:"Long_BADC"},{label:"Long_DCBA",value:"Long_DCBA"},{label:"Long_CDAB",value:"Long_CDAB"},{label:"Float_ABCD",value:"Float_ABCD"},{label:"Float_BADC",value:"Float_BADC"},{label:"Float_DCBA",value:"Float_DCBA"},{label:"Float_CDAB",value:"Float_CDAB"}],rt4:[{label:"Double_ABCDEFGH",value:"Double_ABCDEFGH"},{label:"Double_GHEFCDAB",value:"Double_GHEFCDAB"},{label:"Double_BADCFEHG",value:"Double_BADCFEHG"},{label:"Double_HGFEDCBA",value:"Double_HGFEDCBA"}]},selectedNodes:[],uFlag:!1}),M=e=>{const l={token:m.token,data:{serviceName:u.curGateway.serviceName}};Q.getRegByServiceIdList(l).then((async l=>{console.log("getRegByServiceIdList -> res ",l),l&&("0"===l.code?(C.regTableData=l.data,1===e&&a({type:"success",message:"刷新成功！"})):fe(l),await z((()=>{C.tableMaxHeight=A.value.clientHeight-34-36-132})))}))};M();const A=F(null);(()=>{const e={token:m.token,data:{}};J.getInterfaceList(e).then((e=>{console.log("getInterfaceList -> res",e),"0"===e.code?(C.collOptions=[],e.data.forEach((e=>{const a={label:e.collInterfaceName,name:e.collInterfaceName};C.collOptions.push(a)}))):fe(e)}))})();const P=e=>{j(e).then((e=>{B(e)})),C.propertyOptions=[]},B=e=>{"0"===e.code?(C.nodeOptions=[],C.nameTotsl={},e.data.deviceNodeMap.forEach((e=>{const a={label:e.label,name:e.name,tsl:e.tsl};C.nameTotsl[""+e.name]=e.tsl,C.nodeOptions.push(a)}))):fe(e)},j=e=>{const a={token:m.token,data:{name:e}};return J.getCollDevices(a)},q=e=>{G(e)},G=e=>{const a={token:m.token,data:{name:C.nameTotsl[e]}};ee.getDeviceModelProperty(a).then((e=>{console.log("getDeviceModelProperty -> res ",e),"0"===e.code?(C.propertyOptions=[],e.data.forEach((e=>{const a={label:e.label,name:e.name};C.propertyOptions.push(a)}))):fe(e)}))},K=e=>{C.selectedNodes=e},H=e=>{C.currentPage=e},ae=_((()=>{let e=C.regInfo;return C.regTableData.filter((a=>!e||a.deviceName.toLowerCase().includes(e.toLowerCase())||a.deviceAddr.toLowerCase().includes(e.toLowerCase()))).slice((C.currentPage-1)*C.pagesize,C.currentPage*C.pagesize)})),le=_((()=>{let e=C.regInfo;return C.regTableData.filter((a=>!e||a.deviceName.toLowerCase().includes(e.toLowerCase())||a.deviceAddr.toLowerCase().includes(e.toLowerCase())))})),te=e=>{C.pagesize=e},oe=e=>{C.rFlag=!0,C.rTitle="编辑寄存器",C.regForm={regName:e.regName,label:e.label,propertyType:e.propertyType,collName:e.collName,nodeName:e.nodeName,propertyName:e.propertyName,regType:e.regType,regAddr:e.regAddr,regCnt:e.regCnt,rule:e.rule},j(C.regForm.collName).then((e=>{B(e),G(C.regForm.nodeName)}))},re=()=>{C.regForm={regName:"",label:"",propertyType:0,collName:"",nodeName:"",propertyName:"",regType:0,regAddr:0,regCnt:1,rule:"Int_AB"}},de=F(null),ie=()=>{C.rFlag=!1,re()},ne=()=>{se.value&&se.value.submit()},ce=e=>{},se=F(null),pe=e=>{se.value.clearFiles();const a=e[0];se.value.handleStart(a)},ue=e=>{console.log("beforeUpload -> file",e);let l=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type);if(l){if(l){let l=new FormData;l.append("serviceName",u.curGateway.serviceName),l.append("fileName",e);const t={token:m.token,contentType:"multipart/form-data",data:l};Q.importReg(t).then((e=>{"0"===e.code?(a.success(e.message),C.uFlag=!1,M()):fe(e)}))}}else a({type:"error",message:"文件格式不正确,必须是xlsx文件！"})},me=()=>{C.uFlag=!1,se.value.clearFiles()},ge=()=>{me()},fe=e=>{a({type:"error",message:e.message})},ye=(e,l)=>{a({type:"0"===e.code?"success":"error",message:e.message}),"0"===e.code&&l&&l()};return(e,b)=>{const h=t,w=o,F=r,_=d,B=i,j=N("Icon"),z=n,G=c,O=s,E=f,J=y,ee=g,ve=v;return k(),V("div",qe,[T("div",Ge,[T("div",Ke,[S(_,{inline:!0,ref:"searchFormRef","status-icon":"","label-width":"90px"},{default:x((()=>[S(F,{style:{"margin-left":"20px"}},{default:x((()=>[S(w,{type:"primary",plain:"",onClick:b[0]||(b[0]=e=>{p("changeDnFlag")}),style:{"margin-right":"20px"}},{default:x((()=>[S(h,{class:"el-input__icon"},{default:x((()=>[S(D($))])),_:1}),Oe])),_:1})])),_:1}),S(F,null,{default:x((()=>[S(w,{type:"primary",plain:"",class:"right-btn",onClick:b[1]||(b[1]=e=>{C.uFlag=!0})},{default:x((()=>[S(h,{class:"el-input__icon"},{default:x((()=>[S(D(X))])),_:1}),Ee])),_:1})])),_:1}),S(F,null,{default:x((()=>[S(w,{type:"primary",plain:"",class:"right-btn",onClick:b[2]||(b[2]=e=>(()=>{const e={token:m.token,responseType:"blob",data:{serviceName:u.curGateway.serviceName}};Q.exportReg(e).then((e=>{if(console.log("exportReg -> res",e),e&&"1"===e.code)return void fe(e);const a=new Blob([e.blob]),l=e.fileName,t=document.createElement("a");t.download=l,t.style.display="none",t.href=URL.createObjectURL(a),document.body.appendChild(t),t.click(),URL.revokeObjectURL(t.href),document.body.removeChild(t)}))})())},{default:x((()=>[S(h,{class:"el-input__icon"},{default:x((()=>[S(D(Z))])),_:1}),Qe])),_:1})])),_:1})])),_:1},512)]),T("div",He,[T("div",Je,[T("div",Ye,R(u.curGateway.serviceName),1)]),S(_,{inline:!0,ref:"searchFormRef2","status-icon":"","label-width":"90px"},{default:x((()=>[S(F,{label:""},{default:x((()=>[S(B,{style:{width:"200px"},placeholder:"请输入 地址/名称 过滤",clearable:"",modelValue:D(C).regInfo,"onUpdate:modelValue":b[3]||(b[3]=e=>D(C).regInfo=e)},{prefix:x((()=>[S(h,{class:"el-input__icon"},{default:x((()=>[S(D(W))])),_:1})])),_:1},8,["modelValue"])])),_:1}),S(F,null,{default:x((()=>[S(w,{type:"primary",bg:"",class:"right-btn",onClick:b[4]||(b[4]=e=>(()=>{let e=[];if(0===C.selectedNodes.length)return void a.info("请至少选择一个设备！");C.selectedNodes.forEach((a=>{e.push(a.deviceName)}));const l={token:m.token,data:{serviceName:u.curGateway.serviceName,deviceNames:e}};Y.reportNodes(l).then((e=>{"0"===e.code?a.success(e.message):fe(e)}))})())},{default:x((()=>[S(h,{class:"btn-icon"},{default:x((()=>[S(j,{name:"local-report",size:"14px",color:"#ffffff"})])),_:1}),$e])),_:1})])),_:1}),S(F,null,{default:x((()=>[S(w,{type:"primary",bg:"",class:"right-btn",onClick:b[5]||(b[5]=e=>(C.rFlag=!0,C.rTitle="添加寄存器",void re()))},{default:x((()=>[S(h,{class:"btn-icon"},{default:x((()=>[S(j,{name:"local-add",size:"14px",color:"#ffffff"})])),_:1}),Xe])),_:1})])),_:1}),S(F,null,{default:x((()=>[S(w,{type:"danger",bg:"",class:"right-btn",onClick:b[6]||(b[6]=e=>(()=>{let e=[];0!==C.selectedNodes.length?(C.selectedNodes.forEach((a=>{e.push(a.regName)})),console.log("dList",e),l.confirm("确定要删除这些吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const a={token:m.token,data:{serviceName:u.curGateway.serviceName,registers:e}};Q.deleteReg(a).then((e=>{ye(e,M)}))})).catch((()=>{a({type:"info",message:"取消删除"})}))):a.info("请至少选择一个寄存器！")})())},{default:x((()=>[S(h,{class:"btn-icon"},{default:x((()=>[S(j,{name:"local-delete",size:"14px",color:"#ffffff"})])),_:1}),Ze])),_:1})])),_:1}),S(F,null,{default:x((()=>[S(w,{style:{color:"#fff"},color:"#2EA554",class:"right-btn",onClick:b[7]||(b[7]=e=>{M(1)})},{default:x((()=>[S(h,{class:"btn-icon"},{default:x((()=>[S(j,{name:"local-refresh",size:"14px",color:"#ffffff"})])),_:1}),We])),_:1})])),_:1})])),_:1},512)]),T("div",{class:"content",ref_key:"contentRef",ref:A,style:{top:"136px"}},[S(G,{data:D(ae),"cell-style":D(C).cellStyle,"header-cell-style":D(C).headerCellStyle,"max-height":D(C).tableMaxHeight,style:{width:"100%"},stripe:"",onSelectionChange:K,onRowDblclick:oe},{empty:x((()=>[aa])),default:x((()=>[S(z,{type:"selection",width:"55"}),S(z,{prop:"regName",label:"寄存器名称",width:"auto","min-width":"180",align:"center"}),S(z,{prop:"label",label:"寄存器标签",width:"auto","min-width":"180",align:"center"}),S(z,{prop:"propertyType",label:"属性类型",width:"auto","min-width":"120",align:"center"}),S(z,{prop:"collName",label:"采集接口名称",width:"auto","min-width":"180",align:"center"}),S(z,{prop:"nodeName",label:"设备名称",width:"auto","min-width":"180",align:"center"}),S(z,{prop:"propertyName",label:"设备属性名称",width:"auto","min-width":"150",align:"center"}),S(z,{prop:"regType",label:"寄存器类型",width:"auto","min-width":"100",align:"center"}),S(z,{prop:"regAddr",label:"寄存器地址",width:"auto","min-width":"100",align:"center"}),S(z,{prop:"regCnt",label:"寄存器数量",width:"auto","min-width":"100",align:"center"}),S(z,{prop:"rule",label:"解析规则",width:"auto","min-width":"100",align:"center"}),S(z,{label:"操作",width:"auto","min-width":"120",align:"center",fixed:"right"},{default:x((e=>[S(w,{onClick:a=>oe(e.row),text:"",type:"primary"},{default:x((()=>[ea])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","cell-style","header-cell-style","max-height"]),T("div",la,[S(O,{"current-page":D(C).currentPage,"page-size":D(C).pagesize,"page-sizes":[20,50,200,500],total:D(le).length,onCurrentChange:H,onSizeChange:te,background:"",layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"46px"}},null,8,["current-page","page-size","total"])])],512)]),S(ee,{modelValue:D(C).rFlag,"onUpdate:modelValue":b[21]||(b[21]=e=>D(C).rFlag=e),title:D(C).rTitle,width:"600px"},{footer:x((()=>[T("span",oa,[S(w,{onClick:b[19]||(b[19]=e=>ie())},{default:x((()=>[ra])),_:1}),S(w,{type:"primary",onClick:b[20]||(b[20]=e=>{de.value.validate((e=>{if(!e)return!1;{const e={token:m.token,data:{serviceName:u.curGateway.serviceName,register:C.regForm}};C.rTitle.includes("添加")?Q.addReg(e).then((e=>{ye(e,M),ie()})):Q.editReg(e).then((e=>{ye(e,M),ie()}))}}))})},{default:x((()=>[da])),_:1})])])),default:x((()=>[T("div",ta,[S(_,{model:D(C).regForm,rules:D(C).regRules,ref_key:"regFormRef",ref:de,"status-icon":"","label-position":"right","label-width":"120px"},{default:x((()=>[S(F,{label:"采集接口名称",prop:"collName"},{default:x((()=>[S(J,{modelValue:D(C).regForm.collName,"onUpdate:modelValue":b[8]||(b[8]=e=>D(C).regForm.collName=e),style:{width:"100%"},placeholder:"请选择采集接口名称",onChange:P,clearable:"",filterable:""},{default:x((()=>[(k(!0),V(I,null,L(D(C).collOptions,(e=>(k(),U(E,{key:e.name,label:e.label,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),S(F,{label:"设备名称",prop:"nodeName"},{default:x((()=>[S(J,{modelValue:D(C).regForm.nodeName,"onUpdate:modelValue":b[9]||(b[9]=e=>D(C).regForm.nodeName=e),style:{width:"100%"},placeholder:"请选择设备名称",onChange:q,clearable:"",filterable:""},{default:x((()=>[(k(!0),V(I,null,L(D(C).nodeOptions,(e=>(k(),U(E,{key:e.name,label:e.label,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),S(F,{label:"设备属性名称",prop:"propertyName"},{default:x((()=>[S(J,{modelValue:D(C).regForm.propertyName,"onUpdate:modelValue":b[10]||(b[10]=e=>D(C).regForm.propertyName=e),style:{width:"100%"},placeholder:"请选择设备属性名称",clearable:"",filterable:""},{default:x((()=>[(k(!0),V(I,null,L(D(C).propertyOptions,(e=>(k(),U(E,{key:e.name,label:e.label,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),S(F,{label:"寄存器名称",prop:"regName"},{default:x((()=>[S(B,{type:"text",modelValue:D(C).regForm.regName,"onUpdate:modelValue":b[11]||(b[11]=e=>D(C).regForm.regName=e),autocomplete:"off",placeholder:"请输入寄存器名称"},null,8,["modelValue"])])),_:1}),S(F,{label:"寄存器标签",prop:"label"},{default:x((()=>[S(B,{type:"text",modelValue:D(C).regForm.label,"onUpdate:modelValue":b[12]||(b[12]=e=>D(C).regForm.label=e),autocomplete:"off",placeholder:"请输入寄存器标签"},null,8,["modelValue"])])),_:1}),S(F,{label:"属性类型",prop:"propertyType"},{default:x((()=>[S(J,{modelValue:D(C).regForm.propertyType,"onUpdate:modelValue":b[13]||(b[13]=e=>D(C).regForm.propertyType=e),style:{width:"100%"},placeholder:"请选择属性类型",clearable:"",filterable:""},{default:x((()=>[(k(!0),V(I,null,L(D(C).typeOptions,(e=>(k(),U(E,{key:e.name,label:e.label,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),S(F,{label:"寄存器类型",prop:"regType"},{default:x((()=>[S(J,{modelValue:D(C).regForm.regType,"onUpdate:modelValue":b[14]||(b[14]=e=>D(C).regForm.regType=e),style:{width:"100%"},placeholder:"请选择寄存器类型",clearable:"",filterable:""},{default:x((()=>[(k(!0),V(I,null,L(D(C).regTypeOptions,(e=>(k(),U(E,{key:e.name,label:e.label,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),S(F,{label:"寄存器地址",prop:"regAddr"},{default:x((()=>[S(B,{type:"text",modelValue:D(C).regForm.regAddr,"onUpdate:modelValue":b[15]||(b[15]=e=>D(C).regForm.regAddr=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入寄存器地址"},null,8,["modelValue"])])),_:1}),S(F,{label:"寄存器数量",prop:"regCnt"},{default:x((()=>[S(J,{modelValue:D(C).regForm.regCnt,"onUpdate:modelValue":b[16]||(b[16]=e=>D(C).regForm.regCnt=e),modelModifiers:{number:!0},style:{width:"100%"},onChange:b[17]||(b[17]=e=>(()=>{const e=C.regForm.regCnt;1===e&&(C.regForm.rule="Int_AB"),2===e&&(C.regForm.rule="Long_ABCD"),4===e&&(C.regForm.rule="Double_ABCDEFGH")})()),placeholder:"请选择寄存器数量"},{default:x((()=>[(k(!0),V(I,null,L(D(C).regCntOptions,(e=>(k(),U(E,{key:"regCount_"+e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),S(F,{label:"解析规则",prop:"rule"},{default:x((()=>[S(J,{modelValue:D(C).regForm.rule,"onUpdate:modelValue":b[18]||(b[18]=e=>D(C).regForm.rule=e),modelModifiers:{number:!0},style:{width:"100%"},placeholder:"请选择解析规则"},{default:x((()=>[(k(!0),V(I,null,L(D(C).ruleTypeOptions["rt"+D(C).regForm.regCnt],(e=>(k(),U(E,{key:"type_"+e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["modelValue","title"]),S(ee,{modelValue:D(C).uFlag,"onUpdate:modelValue":b[22]||(b[22]=e=>D(C).uFlag=e),title:"上传寄存器xlsx文件",width:"600px","before-close":ge,"close-on-click-modal":!1},{footer:x((()=>[T("span",ca,[S(w,{onClick:me},{default:x((()=>[sa])),_:1}),S(w,{type:"primary",onClick:ne},{default:x((()=>[pa])),_:1})])])),default:x((()=>[S(ve,{ref_key:"uploadRef",ref:se,action:"","auto-upload":!1,"http-request":ce,limit:1,"on-exceed":pe,"before-upload":ue},{tip:x((()=>[na])),default:x((()=>[S(w,{type:"primary"},{default:x((()=>[ia])),_:1})])),_:1},512)])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-3312b1a3"]]);const ma=e=>(B("data-v-983cca34"),e=e(),j(),e),ga={class:"main-container"},fa={key:0,class:"main"},ya={class:"search-bar"},va=M(" 刷新 "),ba={class:"tool-bar"},ha=M(" 添加 "),wa={class:"param-content"},Fa={class:"pc-title"},_a={class:"pct-info"},Ca=M(" 参数详情 "),Na={class:"pc-content"},ka={class:"param-value"},Va={class:"param-name"},Ta=M(" 上报节点 "),Sa=M(" 寄存器详情 "),xa=M("编辑"),Da=M("删除"),Ra=ma((()=>T("div",null,"无数据",-1))),Ma={class:"pagination"},Ia={class:"dialog-content"},La=M("单位秒"),Aa=M("同步SN"),Ua=M("单位秒"),Pa=M(" 线圈状态寄存器 "),Ba=M(" 离散输入状态寄存器 "),ja=M(" 保持寄存器 "),za=M(" 输入寄存器 "),qa={class:"dialog-footer"},Ga=M("取消"),Ka=M("保存");var Oa=K({setup(e){const p=O();console.log("window.location",window.location);const u=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,m=/^(?=^.{3,255}$)(http(s)?:\/\/)?(www\.)?[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+(:\d+)*(\/\w+\.\w+)*$/,v=/^[0-9]*[1-9][0-9]*$/,C=(e,a,l)=>{0===a||v.test(a)?l():l(new Error("只能输入自然数！"))},A=F(null),B=F(null),j=w({headerCellStyle:{background:E.primaryColor,color:E.fontWhiteColor,height:"54px"},cellStyle:{height:"48px"},tableMaxHeight:0,currentPage:1,pagesize:20,dataServiceName:"",gatewayTableData:[],dFlag:!1,dTitle:"添加上报服务",networkNames:[],gatewayForm:{serviceName:"",ip:"",port:"",reportTime:0,protocol:"",userName:"",password:"",clientID:"",keepAlive:"",cleanSession:!1,deviceName:"",projectCode:"",token:"",slaveID:0,coilStatusRegStart:0,coilStatusRegCnt:0,inputStatusRegStart:0,inputStatusRegCnt:0,holdingRegStart:0,holdingRegCnt:0,inputRegStart:0,inputRegCnt:0,appKey:"",productKey:"",deviceID:"",deviceSecret:""},paramName:{serviceName:"服务名称",ip:"服务名称",port:"服务名称",reportTime:"上报时间",protocol:"协议名称",UserName:"用户名",Password:"密码",ClientID:"客户端名称",keepAlive:"保活时间",cleanSession:"是否清除会话",deviceName:"通信编码",projectCode:"项目编码",token:"密钥",AppKey:"appKey",ProductKey:"产品密钥",DeviceID:"通讯地址",DeviceSecret:"设备密钥"},gatewayRules:{serviceName:[{required:!0,message:"服务名称不能为空",trigger:"blur"}],ip:[{required:!0,validator:(e,a,l)=>{console.log("validateIP"),u.test(a)||m.test(a)?l():l(new Error("格式错误！"))},trigger:"blur"}],port:[{required:!0,message:"端口不能为空",trigger:"blur"}],reportTime:[{required:!0,message:"上报时间不能为空",trigger:"blur"},{type:"number",message:"上报时间只能输入数字"}],protocol:[{required:!0,message:"协议名称不能为空",trigger:"blur"}],ModbusTCP:[{required:!0,message:"上报地址不能为空",trigger:"blur"}],userName:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}],clientID:[{required:!0,message:"客户端名称不能为空",trigger:"blur"}],keepAlive:[{required:!0,message:"保活时间不能为空",trigger:"blur"}],deviceName:[{required:!0,message:"通讯编码不能为空",trigger:"blur"}],projectCode:[{required:!0,message:"项目编码不能为空",trigger:"blur"}],token:[{required:!0,message:"密钥不能为空",trigger:"blur"}],cleanSession:[{required:!0,message:"清除会话不能为空",trigger:"blur"}],slaveID:[{required:!0,message:"从机ID不能为空",trigger:"blur"},{validator:C,trigger:"blur"}],coilStatusRegStart:[{validator:C,trigger:"blur"}],coilStatusRegCnt:[{validator:C,trigger:"blur"}],inputStatusRegStart:[{validator:C,trigger:"blur"}],inputStatusRegCnt:[{validator:C,trigger:"blur"}],holdingRegStart:[{validator:C,trigger:"blur"}],holdingRegCnt:[{validator:C,trigger:"blur"}],inputRegStart:[{validator:C,trigger:"blur"}],inputRegCnt:[{validator:C,trigger:"blur"}],appKey:[{required:!0,message:"appKey不能为空",trigger:"blur"}],productKey:[{required:!0,message:"产品密钥不能为空",trigger:"blur"}],deviceID:[{required:!0,message:"产品密钥不能为空",trigger:"blur"}],deviceSecret:[{required:!0,message:"产品密钥不能为空",trigger:"blur"}]},protocolOptions:[{name:"EMQX.MQTT",label:"EMQX.MQTT"},{name:"RT.STLV1",label:"RT.STLV1"},{name:"RT.STLV2",label:"RT.STLV2"},{name:"RT.MQTT",label:"RT.MQTT"},{name:"ModbusTCP",label:"ModbusTCP"},{name:"FSJY.MQTT",label:"FSJY.MQTT"}],dnList:["RT.STLV1","RT.STLV2"],kaList:["EMQX.MQTT","RT.MQTT","RT.STLV2","FSJY.MQTT"],dnFlag:1,serviceName:""}),K=H();j.serviceName=K.query.serviceName;const J=e=>{const l={token:p.token,data:{}};Q.getGatewayList(l).then((async l=>{if(console.log("getGatewayList -> res",l),l){if("0"===l.code){if(j.gatewayTableData=l.data,j.serviceName&&!B.value.ctxData.isBackBtn){const e=j.gatewayTableData.find((e=>e.serviceName===j.serviceName));le(e)}1===e&&a({type:"success",message:"刷新成功！"})}else ie(l);await z((()=>{j.tableMaxHeight=A.value.clientHeight-34-36-22}))}}))};J();(()=>{const e={token:p.token,data:{}};Q.getReportProtocolList(e).then((e=>{e&&(console.log("getReportProtocolList -> res",e),"0"===e.code?j.protocolOptions=e.data:ie(e))}))})();const Y=_((()=>j.gatewayTableData.filter((e=>!j.dataServiceName||e.serviceName.toLowerCase().includes(j.dataServiceName.toLowerCase()))).slice((j.currentPage-1)*j.pagesize,j.currentPage*j.pagesize))),$=_((()=>j.gatewayTableData.filter((e=>!j.dataServiceName||e.serviceName.toLowerCase().includes(j.dataServiceName.toLowerCase()))))),X=e=>{j.currentPage=e},Z=e=>{j.pagesize=e},ee=e=>{j.dFlag=!0,j.dTitle="编辑上报服务",j.gatewayForm={serviceName:e.serviceName,ip:e.ip,port:e.port,reportTime:e.reportTime,protocol:e.protocol},e.protocol.includes("FSJY.MQTT")?(j.gatewayForm.userName=e.param.UserName,j.gatewayForm.password=e.param.Password,j.gatewayForm.clientID=e.param.ClientID,j.gatewayForm.keepAlive=e.param.KeepAlive,j.gatewayForm.cleanSession=e.param.CleanSession,j.gatewayForm.appKey=e.param.AppKey,j.gatewayForm.productKey=e.param.ProductKey,j.gatewayForm.deviceID=e.param.DeviceID,j.gatewayForm.deviceSecret=e.param.DeviceSecret):e.protocol.includes("MQTT")?(j.gatewayForm.userName=e.param.userName,j.gatewayForm.password=e.param.password,j.gatewayForm.clientID=e.param.clientID,j.gatewayForm.keepAlive=e.param.keepAlive,j.gatewayForm.cleanSession=e.param.cleanSession):"RT.STLV1"===e.protocol?j.gatewayForm.deviceName=e.param.deviceName:"RT.STLV2"===e.protocol?(j.gatewayForm.projectCode=e.param.projectCode,j.gatewayForm.deviceName=e.param.deviceName,j.gatewayForm.keepAlive=e.param.keepAlive,j.gatewayForm.token=e.param.token):"ModbusTCP"===e.protocol&&(j.gatewayForm.ip="",j.gatewayForm.reportTime=0,j.gatewayForm.slaveID=e.param.slaveID,j.gatewayForm.coilStatusRegStart=e.param.coilStatusRegStart,j.gatewayForm.coilStatusRegCnt=e.param.coilStatusRegCnt,j.gatewayForm.inputStatusRegStart=e.param.inputStatusRegStart,j.gatewayForm.inputStatusRegCnt=e.param.inputStatusRegCnt,j.gatewayForm.holdingRegStart=e.param.holdingRegStart,j.gatewayForm.holdingRegCnt=e.param.holdingRegCnt,j.gatewayForm.inputRegStart=e.param.inputRegStart,j.gatewayForm.inputRegCnt=e.param.inputRegCnt)},le=e=>{j.dnFlag=2,j.curGateway=e},te=()=>{j.dnFlag=1,J()},oe=F(null),re=()=>{j.dFlag=!1,oe.value.resetFields(),j.gatewayForm={serviceName:"",ip:"",port:"",reportTime:0,protocol:"",userName:"",password:"",clientID:"",keepAlive:"",cleanSession:!1,deviceName:"",projectCode:"",token:"",appKey:"",productKey:"",deviceID:"",deviceSecret:""}},de=e=>{re()},ie=e=>{a({type:"error",message:e.message})},ne=(e,l)=>{a({type:"0"===e.code?"success":"error",message:e.message}),"0"===e.code&&l&&l()};return(e,u)=>{const m=t,v=i,w=r,F=N("Icon"),_=o,C=d,z=n,K=c,O=s,E=f,H=y,ce=b,se=h,pe=g;return k(),V("div",ga,[1===D(j).dnFlag?(k(),V("div",fa,[T("div",ya,[S(C,{inline:!0,ref:"searchFormRef","status-icon":"","label-width":"120px"},{default:x((()=>[S(w,{label:"上报服务名称"},{default:x((()=>[S(v,{style:{width:"200px"},placeholder:"请输入上报服务名称",clearable:"",modelValue:D(j).dataServiceName,"onUpdate:modelValue":u[0]||(u[0]=e=>D(j).dataServiceName=e)},{prefix:x((()=>[S(m,{class:"el-input__icon"},{default:x((()=>[S(D(W))])),_:1})])),_:1},8,["modelValue"])])),_:1}),S(w,null,{default:x((()=>[S(_,{style:{color:"#fff","margin-left":"20px"},color:"#2EA554",class:"right-btn",onClick:u[1]||(u[1]=e=>{J(1)})},{default:x((()=>[S(m,{class:"btn-icon"},{default:x((()=>[S(F,{name:"local-refresh",size:"14px",color:"#ffffff"})])),_:1}),va])),_:1})])),_:1})])),_:1},512)]),T("div",ba,[S(_,{type:"primary",bg:"",class:"right-btn",onClick:u[2]||(u[2]=e=>(j.dFlag=!0,void(j.dTitle="添加上报服务")))},{default:x((()=>[S(m,{class:"btn-icon"},{default:x((()=>[S(F,{name:"local-add",size:"14px",color:"#ffffff"})])),_:1}),ha])),_:1})]),T("div",{class:"content",ref_key:"contentRef",ref:A},[S(K,{data:D(Y),"cell-style":D(j).cellStyle,"header-cell-style":D(j).headerCellStyle,style:{width:"100%"},"max-height":D(j).tableMaxHeight,stripe:"",onRowDblclick:ee},{empty:x((()=>[Ra])),default:x((()=>[S(z,{type:"expand"},{default:x((e=>[T("div",wa,[T("div",Fa,[T("div",_a,[T("b",null,R(e.row.serviceName),1),Ca])]),T("div",Na,[(k(!0),V(I,null,L(e.row.param,((e,a,l)=>(k(),V("div",{class:"param-item",key:l},[T("div",ka,R(D(j).paramName[a])+"：",1),T("div",Va,R(e||"-"),1)])))),128))])])])),_:1}),S(z,{prop:"serviceName",label:"服务名称",width:"auto","min-width":"150",align:"center"}),S(z,{prop:"protocol",label:"协议名称",width:"auto","min-width":"150",align:"center"}),S(z,{prop:"ip",label:"上报地址",width:"auto","min-width":"150",align:"center"}),S(z,{prop:"port",label:"上报端口",width:"auto","min-width":"100",align:"center"}),S(z,{prop:"reportTime",label:"上报周期（秒）",width:"auto","min-width":"150",align:"center"}),S(z,{label:"在线状态",width:"auto","min-width":"100",align:"center"},{default:x((e=>[M(R("onLine"===e.row.reportStatus?"在线":"离线"),1)])),_:1}),S(z,{label:"操作",width:"auto","min-width":"200",align:"center",fixed:"right"},{default:x((e=>["ModbusTCP"!==e.row.protocol?(k(),U(_,{key:0,onClick:a=>le(e.row),text:"",type:"success"},{default:x((()=>[Ta])),_:2},1032,["onClick"])):P("",!0),"ModbusTCP"==e.row.protocol?(k(),U(_,{key:1,onClick:a=>{return l=e.row,j.dnFlag=3,void(j.curGateway=l);var l},text:"",type:"success"},{default:x((()=>[Sa])),_:2},1032,["onClick"])):P("",!0),S(_,{onClick:a=>ee(e.row),text:"",type:"primary"},{default:x((()=>[xa])),_:2},1032,["onClick"]),S(_,{onClick:t=>{return o=e.row,void l.confirm("确定要删除这个上报服务吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e={token:p.token,data:{serviceName:o.serviceName}};Q.deleteGateway(e).then((e=>{ne(e,J)}))})).catch((()=>{a({type:"info",message:"取消删除"})}));var o},text:"",type:"danger"},{default:x((()=>[Da])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","cell-style","header-cell-style","max-height"]),T("div",Ma,[S(O,{"current-page":D(j).currentPage,"page-size":D(j).pagesize,"page-sizes":[20,50,200,500],total:D($).length,onCurrentChange:X,onSizeChange:Z,background:"",layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"46px"}},null,8,["current-page","page-size","total"])])],512)])):P("",!0),2===D(j).dnFlag?(k(),U(je,{key:1,ref_key:"nodeService",ref:B,curGateway:D(j).curGateway,onChangeDnFlag:u[3]||(u[3]=e=>te()),style:{width:"100%",height:"100%",overflow:"hidden"}},null,8,["curGateway"])):P("",!0),3===D(j).dnFlag?(k(),U(ua,{key:2,curGateway:D(j).curGateway,onChangeDnFlag:u[4]||(u[4]=e=>te()),style:{width:"100%",height:"100%",overflow:"hidden"}},null,8,["curGateway"])):P("",!0),S(pe,{modelValue:D(j).dFlag,"onUpdate:modelValue":u[35]||(u[35]=e=>D(j).dFlag=e),title:D(j).dTitle,width:"600px","before-close":de,"close-on-click-modal":!1},{footer:x((()=>[T("span",qa,[S(_,{onClick:u[33]||(u[33]=e=>re())},{default:x((()=>[Ga])),_:1}),S(_,{type:"primary",onClick:u[34]||(u[34]=e=>{oe.value.validate((e=>{if(!e)return!1;{const e={serviceName:j.gatewayForm.serviceName,ip:j.gatewayForm.ip,port:j.gatewayForm.port,reportTime:j.gatewayForm.reportTime,protocol:j.gatewayForm.protocol,param:{}};let a={};j.gatewayForm.protocol.includes("FSJY.MQTT")?(a.userName=j.gatewayForm.userName,a.password=j.gatewayForm.password,a.clientID=j.gatewayForm.clientID,a.keepAlive=j.gatewayForm.keepAlive,a.cleanSession=j.gatewayForm.cleanSession,a.appKey=j.gatewayForm.appKey,a.productKey=j.gatewayForm.productKey,a.deviceID=j.gatewayForm.deviceID,a.deviceSecret=j.gatewayForm.deviceSecret):j.gatewayForm.protocol.includes("MQTT")?(a.userName=j.gatewayForm.userName,a.password=j.gatewayForm.password,a.clientID=j.gatewayForm.clientID,a.keepAlive=j.gatewayForm.keepAlive,a.cleanSession=j.gatewayForm.cleanSession):"RT.STLV1"===j.gatewayForm.protocol?a.deviceName=j.gatewayForm.deviceName:"RT.STLV2"===j.gatewayForm.protocol?(a.projectCode=j.gatewayForm.projectCode,a.deviceName=j.gatewayForm.deviceName,a.keepAlive=j.gatewayForm.keepAlive,a.token=j.gatewayForm.token):"ModbusTCP"===j.gatewayForm.protocol&&(a.slaveID=j.gatewayForm.slaveID,a.coilStatusRegStart=j.gatewayForm.coilStatusRegStart,a.coilStatusRegCnt=j.gatewayForm.coilStatusRegCnt,a.inputStatusRegStart=j.gatewayForm.inputStatusRegStart,a.inputStatusRegCnt=j.gatewayForm.inputStatusRegCnt,a.holdingRegStart=j.gatewayForm.holdingRegStart,a.holdingRegCnt=j.gatewayForm.holdingRegCnt,a.inputRegStart=j.gatewayForm.inputRegStart,a.inputRegCnt=j.gatewayForm.inputRegCnt),e.param=a;const l={token:p.token,data:e};j.dTitle.includes("添加")?Q.addGateway(l).then((e=>{ne(e,J),re()})):Q.editGateway(l).then((e=>{ne(e,J),re()}))}}))})},{default:x((()=>[Ka])),_:1})])])),default:x((()=>[T("div",Ia,[S(C,{model:D(j).gatewayForm,rules:D(j).gatewayRules,ref_key:"gatewayFormRef",ref:oe,"status-icon":"","label-position":"right","label-width":"120px",style:{height:"450px"}},{default:x((()=>[S(w,{label:"服务名称",prop:"serviceName"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.serviceName,"onUpdate:modelValue":u[5]||(u[5]=e=>D(j).gatewayForm.serviceName=e),autocomplete:"off",placeholder:"请输入服务名称"},null,8,["modelValue"])])),_:1}),S(w,{label:"协议类型",prop:"protocol"},{default:x((()=>[S(H,{modelValue:D(j).gatewayForm.protocol,"onUpdate:modelValue":u[6]||(u[6]=e=>D(j).gatewayForm.protocol=e),onChange:u[7]||(u[7]=e=>{"RT.MQTT"===D(j).gatewayForm.protocol&&(j.gatewayForm.ip="mqtt.reatgreen.com",j.gatewayForm.port="1883",j.gatewayForm.userName="reatgreen",j.gatewayForm.password="Reat@2022",j.gatewayForm.reportTime=900,j.gatewayForm.keepAlive="30",j.gatewayForm.cleanSession=!0)}),style:{width:"100%"},placeholder:"请选择协议类型"},{default:x((()=>[(k(!0),V(I,null,L(D(j).protocolOptions,(e=>(k(),U(E,{key:"protocol"+e.name,label:e.label,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),q(S(w,{label:"上报地址",prop:"ModbusTCP"!==D(j).gatewayForm.protocol?"ip":""},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.ip,"onUpdate:modelValue":u[8]||(u[8]=e=>D(j).gatewayForm.ip=e),autocomplete:"off",placeholder:"请输入上报地址"},null,8,["modelValue"])])),_:1},8,["prop"]),[[G,"ModbusTCP"!==D(j).gatewayForm.protocol]]),S(w,{label:"上报端口",prop:"port"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.port,"onUpdate:modelValue":u[9]||(u[9]=e=>D(j).gatewayForm.port=e),autocomplete:"off",placeholder:"请输入上报端口"},null,8,["modelValue"])])),_:1}),q(S(w,{label:"上报周期",prop:"ModbusTCP"!==D(j).gatewayForm.protocol?"reportTime":""},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.reportTime,"onUpdate:modelValue":u[10]||(u[10]=e=>D(j).gatewayForm.reportTime=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入上报周期"},{append:x((()=>[La])),_:1},8,["modelValue"])])),_:1},8,["prop"]),[[G,"ModbusTCP"!==D(j).gatewayForm.protocol]]),D(j).gatewayForm.protocol.includes("MQTT")?(k(),U(w,{key:0,label:"用户名",prop:"userName"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.userName,"onUpdate:modelValue":u[11]||(u[11]=e=>D(j).gatewayForm.userName=e),autocomplete:"off",placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1})):P("",!0),D(j).gatewayForm.protocol.includes("MQTT")?(k(),U(w,{key:1,label:"密码",prop:"password"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.password,"onUpdate:modelValue":u[12]||(u[12]=e=>D(j).gatewayForm.password=e),autocomplete:"off",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1})):P("",!0),D(j).gatewayForm.protocol.includes("MQTT")?(k(),U(w,{key:2,label:"客户端名称",prop:"clientID"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.clientID,"onUpdate:modelValue":u[14]||(u[14]=e=>D(j).gatewayForm.clientID=e),autocomplete:"off",placeholder:"请输入客户端名称"},{append:x((()=>[S(_,{onClick:u[13]||(u[13]=e=>(()=>{const e={token:p.token,data:{}};ae.getGatewaySN(e).then((e=>{"0"===e.code?j.gatewayForm.clientID=e.data.sn:ie(e)}))})())},{default:x((()=>[Aa])),_:1})])),_:1},8,["modelValue"])])),_:1})):P("",!0),D(j).gatewayForm.protocol.includes("FSJY")?(k(),U(w,{key:3,label:"APP-KEY",prop:"appKey"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.appKey,"onUpdate:modelValue":u[15]||(u[15]=e=>D(j).gatewayForm.appKey=e),autocomplete:"off",placeholder:"请输入appKey"},null,8,["modelValue"])])),_:1})):P("",!0),D(j).gatewayForm.protocol.includes("FSJY")?(k(),U(w,{key:4,label:"产品密钥",prop:"productKey"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.productKey,"onUpdate:modelValue":u[16]||(u[16]=e=>D(j).gatewayForm.productKey=e),autocomplete:"off",placeholder:"请输入网关产品密钥"},null,8,["modelValue"])])),_:1})):P("",!0),D(j).gatewayForm.protocol.includes("FSJY")?(k(),U(w,{key:5,label:"通讯地址",prop:"deviceID"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.deviceID,"onUpdate:modelValue":u[17]||(u[17]=e=>D(j).gatewayForm.deviceID=e),autocomplete:"off",placeholder:"请输入网关通讯地址"},null,8,["modelValue"])])),_:1})):P("",!0),D(j).gatewayForm.protocol.includes("FSJY")?(k(),U(w,{key:6,label:"设备密钥",prop:"deviceSecret"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.deviceSecret,"onUpdate:modelValue":u[18]||(u[18]=e=>D(j).gatewayForm.deviceSecret=e),autocomplete:"off",placeholder:"请输入网关设备密钥"},null,8,["modelValue"])])),_:1})):P("",!0),"RT.STLV2"===D(j).gatewayForm.protocol?(k(),U(w,{key:7,label:"项目编码",prop:"projectCode"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.projectCode,"onUpdate:modelValue":u[19]||(u[19]=e=>D(j).gatewayForm.projectCode=e),autocomplete:"off",placeholder:"请输入项目编码"},null,8,["modelValue"])])),_:1})):P("",!0),D(j).dnList.includes(D(j).gatewayForm.protocol)?(k(),U(w,{key:8,label:"通信编码",prop:"deviceName"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.deviceName,"onUpdate:modelValue":u[20]||(u[20]=e=>D(j).gatewayForm.deviceName=e),autocomplete:"off",placeholder:"请输入通信编码"},null,8,["modelValue"])])),_:1})):P("",!0),D(j).kaList.includes(D(j).gatewayForm.protocol)?(k(),U(w,{key:9,label:"保活时间",prop:"keepAlive"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.keepAlive,"onUpdate:modelValue":u[21]||(u[21]=e=>D(j).gatewayForm.keepAlive=e),autocomplete:"off",placeholder:"请输入保活时间"},{append:x((()=>[Ua])),_:1},8,["modelValue"])])),_:1})):P("",!0),D(j).gatewayForm.protocol.includes("MQTT")?(k(),U(w,{key:10,label:"是否清除会话",prop:"cleanSession"},{default:x((()=>[S(ce,{modelValue:D(j).gatewayForm.cleanSession,"onUpdate:modelValue":u[22]||(u[22]=e=>D(j).gatewayForm.cleanSession=e),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])])),_:1})):P("",!0),"RT.STLV2"===D(j).gatewayForm.protocol?(k(),U(w,{key:11,label:"秘钥",prop:"token"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.token,"onUpdate:modelValue":u[23]||(u[23]=e=>D(j).gatewayForm.token=e),autocomplete:"off",placeholder:"请输入秘钥"},null,8,["modelValue"])])),_:1})):P("",!0),"ModbusTCP"===D(j).gatewayForm.protocol?(k(),U(w,{key:12,label:"从机ID",prop:"slaveID"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.slaveID,"onUpdate:modelValue":u[24]||(u[24]=e=>D(j).gatewayForm.slaveID=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入从机ID"},null,8,["modelValue"])])),_:1})):P("",!0),"ModbusTCP"===D(j).gatewayForm.protocol?(k(),U(se,{key:13,"content-position":"center"},{default:x((()=>[Pa])),_:1})):P("",!0),"ModbusTCP"===D(j).gatewayForm.protocol?(k(),U(w,{key:14,label:"起始地址",prop:"coilStatusRegStart"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.coilStatusRegStart,"onUpdate:modelValue":u[25]||(u[25]=e=>D(j).gatewayForm.coilStatusRegStart=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入线圈状态寄存器起始地址"},null,8,["modelValue"])])),_:1})):P("",!0),"ModbusTCP"===D(j).gatewayForm.protocol?(k(),U(w,{key:15,label:"数量",prop:"coilStatusRegCnt"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.coilStatusRegCnt,"onUpdate:modelValue":u[26]||(u[26]=e=>D(j).gatewayForm.coilStatusRegCnt=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入线圈状态寄存器数量"},null,8,["modelValue"])])),_:1})):P("",!0),"ModbusTCP"===D(j).gatewayForm.protocol?(k(),U(se,{key:16,"content-position":"center"},{default:x((()=>[Ba])),_:1})):P("",!0),"ModbusTCP"===D(j).gatewayForm.protocol?(k(),U(w,{key:17,label:"起始地址",prop:"inputStatusRegStart"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.inputStatusRegStart,"onUpdate:modelValue":u[27]||(u[27]=e=>D(j).gatewayForm.inputStatusRegStart=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入离散输入状态寄存器起始地址"},null,8,["modelValue"])])),_:1})):P("",!0),"ModbusTCP"===D(j).gatewayForm.protocol?(k(),U(w,{key:18,label:"数量",prop:"inputStatusRegCnt"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.inputStatusRegCnt,"onUpdate:modelValue":u[28]||(u[28]=e=>D(j).gatewayForm.inputStatusRegCnt=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入离散输入状态寄存器数量"},null,8,["modelValue"])])),_:1})):P("",!0),"ModbusTCP"===D(j).gatewayForm.protocol?(k(),U(se,{key:19,"content-position":"center"},{default:x((()=>[ja])),_:1})):P("",!0),"ModbusTCP"===D(j).gatewayForm.protocol?(k(),U(w,{key:20,label:"起始地址",prop:"holdingRegStart"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.holdingRegStart,"onUpdate:modelValue":u[29]||(u[29]=e=>D(j).gatewayForm.holdingRegStart=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入保持寄存器起始地址"},null,8,["modelValue"])])),_:1})):P("",!0),"ModbusTCP"===D(j).gatewayForm.protocol?(k(),U(w,{key:21,label:"数量",prop:"holdingRegCnt"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.holdingRegCnt,"onUpdate:modelValue":u[30]||(u[30]=e=>D(j).gatewayForm.holdingRegCnt=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入保持寄存器数量"},null,8,["modelValue"])])),_:1})):P("",!0),"ModbusTCP"===D(j).gatewayForm.protocol?(k(),U(se,{key:22,"content-position":"center"},{default:x((()=>[za])),_:1})):P("",!0),"ModbusTCP"===D(j).gatewayForm.protocol?(k(),U(w,{key:23,label:"起始地址",prop:"inputRegStart"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.inputRegStart,"onUpdate:modelValue":u[31]||(u[31]=e=>D(j).gatewayForm.inputRegStart=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入输入寄存器起始地址"},null,8,["modelValue"])])),_:1})):P("",!0),"ModbusTCP"===D(j).gatewayForm.protocol?(k(),U(w,{key:24,label:"数量",prop:"inputRegCnt"},{default:x((()=>[S(v,{type:"text",modelValue:D(j).gatewayForm.inputRegCnt,"onUpdate:modelValue":u[32]||(u[32]=e=>D(j).gatewayForm.inputRegCnt=e),modelModifiers:{number:!0},autocomplete:"off",placeholder:"请输入输入寄存器数量"},null,8,["modelValue"])])),_:1})):P("",!0)])),_:1},8,["model","rules"])])])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-983cca34"]]);export{Oa as default};
