import{m as e,v as a,w as t,S as s,p as l,F as r,G as o,u as d,g as c}from"./element-plus.3300f756.js";import{_ as i,u as n}from"./index.559546be.js";import{S as m}from"./sysTool.90ffbf30.js";import{I as u}from"./interface.5c9ce411.js";import{K as p,o as f,c as v,a as h,P as b,S as g,u as j,Y as y,Q as k,ak as _,W as x,X as C,M as D,T as V,aw as I,ax as w}from"./@vue.73d14ebc.js";import"./lodash-es.98e49362.js";import"./async-validator.fb49d0f5.js";import"./@vueuse.3d90a471.js";import"./dayjs.2790329b.js";import"./axios.765908e4.js";import"./@ctrl.b082b0c1.js";import"./@popperjs.36402333.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./vue-router.43b9a342.js";import"./pinia.3f4aff4f.js";import"./vue-demi.b3a9cad9.js";import"./@element-plus.0bef5fa5.js";import"./screenfull.7cf96174.js";import"./vue-echarts.7828944a.js";import"./resize-detector.4e96b72b.js";import"./echarts.2b8dcc79.js";import"./zrender.54f191d6.js";import"./tslib.60310f1a.js";import"./nprogress.aae2b787.js";const T={class:"main-container"},L={class:"main",style:{"background-color":"inherit"}},S=(e=>(I("data-v-5933ce7d"),e=e(),w(),e))((()=>h("div",{class:"card-header"},[h("span",null,"通讯调试助手")],-1))),U={class:"item"},A={class:"st-receive"},N={class:"str-content"},z={key:0,class:"str-noData"},F={key:0},M={class:"st-send"},R={class:"st-operate"},O={style:{"margin-bottom":"10px"}},P={class:"st-remark"};var E=i({__name:"CommDebug",setup(i){const I=n(),w=p({receiveData:[],sendData:"",curCollect:"",interfaceList:[{name:"collect01",label:"采集接口01"},{name:"modbusTCP",label:"采集接口02"}],receiveTime:!0,curCheck:0,checkOptions:[{name:0,label:"不校验"},{name:1,label:"CRC16"},{name:2,label:"SUM"}]});(()=>{const e={token:I.token,data:{}};u.getInterfaceList(e).then((e=>{console.log("getInterfaceList -> res",e),e&&("0"===e.code?w.interfaceList=e.data:E(e))}))})();const E=e=>{c({type:"error",message:e.message})};return(c,i)=>{const n=e,u=a,p=t,G=s,K=l,Q=r,W=o,X=d;return f(),v("div",T,[h("div",L,[b(W,{gutter:20,style:{height:"100%"}},{default:g((()=>[b(Q,{span:12},{default:g((()=>[b(X,{class:"box-card",shadow:"hover"},{header:g((()=>[S])),default:g((()=>[h("div",U,[h("div",A,[h("div",N,[0==j(w).receiveData.length?(f(),v("div",z,"显示区")):y("",!0),(f(!0),v(k,null,_(j(w).receiveData,((e,a)=>(f(),v("div",{key:a},[j(w).receiveTime?(f(),v("div",F,"【"+C(e.date)+"】",1)):y("",!0),h("div",{class:D(1==e.type?"TxInfo":"RxInfo")},C(1==e.type?"Tx："+e.data:"Rx："+e.data),3)])))),128))])]),h("div",M,[b(n,{modelValue:j(w).sendData,"onUpdate:modelValue":i[0]||(i[0]=e=>j(w).sendData=e),class:"sts-sendArea",rows:"5",type:"textarea",placeholder:""==j(w).sendData?"发送区":""},null,8,["modelValue","placeholder"])]),h("div",R,[h("div",null,[b(p,{modelValue:j(w).curCollect,"onUpdate:modelValue":i[1]||(i[1]=e=>j(w).curCollect=e),style:{"margin-bottom":"10px"},placeholder:"请选择采集接口"},{default:g((()=>[(f(!0),v(k,null,_(j(w).interfaceList,(e=>(f(),V(u,{key:e.collInterfaceName,label:e.collInterfaceName,value:e.collInterfaceName},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),h("div",O,[b(G,{modelValue:j(w).receiveTime,"onUpdate:modelValue":i[2]||(i[2]=e=>j(w).receiveTime=e),label:"接收时间",border:"",style:{width:"100%",height:"34px"}},null,8,["modelValue"])]),b(K,{type:"danger",style:{height:"34px",width:"100%"},plain:"",onClick:i[3]||(i[3]=e=>{w.receiveData=[]})},{default:g((()=>[x("清空显示区")])),_:1})]),h("div",null,[b(K,{type:"primary",style:{height:"34px",width:"100%","margin-bottom":"10px"},plain:"",onClick:i[4]||(i[4]=e=>(()=>{if(""===w.curCollect)return void E({message:"请选择采集接口！"});if(""===w.curCheck)return void E({message:"请选择校验方式！"});let e="";if(""===w.sendData)return void E({message:"发送数据不能为空！"});let a=w.sendData.replaceAll(" ","");if(!/^[0-9a-fA-F]+$/.test(a))return E({message:"报文格式错误，只能输入字符【0-9,a-f,A-F或者空格】！"}),w.sendData="",void(a="");const t=a.length;for(var s=0;s<t;s+=2)s<t&&(e+=a.substr(s,2)+(s+2>=t?"":" "));const l={token:I.token,data:{collInterfaceName:w.curCollect,directData:e,checkSum:w.curCheck}};m.sendMessage(l).then((e=>{"0"===e.code?e.data.forEach((e=>{w.receiveData.push(e)})):E(e)}))})())},{default:g((()=>[x(" 发送 ")])),_:1}),b(p,{modelValue:j(w).curCheck,"onUpdate:modelValue":i[5]||(i[5]=e=>j(w).curCheck=e),style:{"margin-bottom":"10px"},placeholder:"请选择数据校验"},{default:g((()=>[(f(!0),v(k,null,_(j(w).checkOptions,(e=>(f(),V(u,{key:e.name,label:e.label,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),b(K,{type:"danger",style:{height:"34px",width:"100%"},plain:"",onClick:i[6]||(i[6]=e=>{w.sendData=""})},{default:g((()=>[x("清空发送区")])),_:1})])]),h("div",P,[b(W,{gutter:16},{default:g((()=>[b(Q,{span:3},{default:g((()=>[x("操作步骤:")])),_:1}),b(Q,{span:21},{default:g((()=>[x("1、选择采集接口")])),_:1})])),_:1}),b(W,{gutter:16},{default:g((()=>[b(Q,{offset:3,span:21},{default:g((()=>[x("2、选择校验方式")])),_:1})])),_:1}),b(W,{gutter:16},{default:g((()=>[b(Q,{offset:3,span:21},{default:g((()=>[x("3、发送区编写发送的报文")])),_:1})])),_:1}),b(W,{gutter:16},{default:g((()=>[b(Q,{offset:3,span:21},{default:g((()=>[x("4、显示区显示发送的报文和返回的报文")])),_:1})])),_:1})])])])),_:1})])),_:1})])),_:1})])])}}},[["__scopeId","data-v-5933ce7d"]]);export{E as default};
